"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[608],{7558:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>h,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>c,toc:()=>l});var a=n(5893),t=n(1151);const r={},i="Hashcat",c={id:"cryptography/attacks/password-cracking/hashcat/README",title:"Hashcat",description:"- Hashcat",source:"@site/docs/cryptography/attacks/password-cracking/hashcat/README.md",sourceDirName:"cryptography/attacks/password-cracking/hashcat",slug:"/cryptography/attacks/password-cracking/hashcat/",permalink:"/cybersecurity-handbook/cryptography/attacks/password-cracking/hashcat/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Padding oracle",permalink:"/cybersecurity-handbook/cryptography/attacks/padding-oracle/"},next:{title:"Stream cipher reuse / Reused key",permalink:"/cybersecurity-handbook/cryptography/attacks/stream-cipher-reuse/"}},h={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Overview",id:"overview",level:3},{value:"Hashing",id:"hashing",level:3},{value:"Algorithms for password protection",id:"algorithms-for-password-protection",level:4},{value:"Salting",id:"salting",level:4},{value:"Encryption",id:"encryption",level:3},{value:"Symmetric encryption",id:"symmetric-encryption",level:4},{value:"Aymmetric encryption",id:"aymmetric-encryption",level:4},{value:"Identifing hashes",id:"identifing-hashes",level:3},{value:"Hashid",id:"hashid",level:4},{value:"Context is important",id:"context-is-important",level:4},{value:"Hashcat specifics",id:"hashcat-specifics",level:2},{value:"Hashcat overview",id:"hashcat-overview",level:3},{value:"Dictionary attack",id:"dictionary-attack",level:3},{value:"Combination attack",id:"combination-attack",level:3},{value:"Mask attack",id:"mask-attack",level:3},{value:"Hybrid attack",id:"hybrid-attack",level:3},{value:"Creating custom wordlists",id:"creating-custom-wordlists",level:2},{value:"Working with rules",id:"working-with-rules",level:2},{value:"Example rule creation",id:"example-rule-creation",level:3},{value:"Example rule-based attack",id:"example-rule-based-attack",level:3},{value:"Built-in defaults",id:"built-in-defaults",level:3},{value:"Cracking",id:"cracking",level:2},{value:"Cracking common hashes",id:"cracking-common-hashes",level:3},{value:"Common hash types",id:"common-hash-types",level:4},{value:"Example 1: Database dumps",id:"example-1-database-dumps",level:4},{value:"Example 2: Linux shadow file",id:"example-2-linux-shadow-file",level:4},{value:"Example 3: Common active directory hash types",id:"example-3-common-active-directory-hash-types",level:4},{value:"NTLM",id:"ntlm",level:4},{value:"NetNTLMv2",id:"netntlmv2",level:4},{value:"Cracking miscellaneous files &amp; hashes",id:"cracking-miscellaneous-files--hashes",level:3},{value:"Example 1: Microsoft Office documents",id:"example-1-microsoft-office-documents",level:4},{value:"Example 2: ZIP files",id:"example-2-zip-files",level:4},{value:"Example 3: KeePass files",id:"example-3-keepass-files",level:4},{value:"Example 4: PDF files",id:"example-4-pdf-files",level:4},{value:"Cracking WPA/WPA2 handshakes",id:"cracking-wpawpa2-handshakes",level:3},{value:"Cracking MIC",id:"cracking-mic",level:4},{value:"Cracking PMKID",id:"cracking-pmkid",level:4}];function o(e){const s={a:"a",admonition:"admonition",annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h1,{id:"hashcat",children:"Hashcat"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#hashcat",children:"Hashcat"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#introduction",children:"Introduction"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#overview",children:"Overview"})}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#hashing",children:"Hashing"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#algorithms-for-password-protection",children:"Algorithms for password protection"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#salting",children:"Salting"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#encryption",children:"Encryption"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#symmetric-encryption",children:"Symmetric encryption"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#aymmetric-encryption",children:"Aymmetric encryption"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#identifing-hashes",children:"Identifing hashes"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#hashid",children:"Hashid"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#context-is-important",children:"Context is important"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#hashcat-specifics",children:"Hashcat specifics"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#hashcat-overview",children:"Hashcat overview"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#dictionary-attack",children:"Dictionary attack"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#combination-attack",children:"Combination attack"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#mask-attack",children:"Mask attack"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#hybrid-attack",children:"Hybrid attack"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#creating-custom-wordlists",children:"Creating custom wordlists"})}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#working-with-rules",children:"Working with rules"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#example-rule-creation",children:"Example rule creation"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#example-rule-based-attack",children:"Example rule-based attack"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#built-in-defaults",children:"Built-in defaults"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#cracking",children:"Cracking"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#cracking-common-hashes",children:"Cracking common hashes"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#common-hash-types",children:"Common hash types"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#example-1-database-dumps",children:"Example 1: Database dumps"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#example-2-linux-shadow-file",children:"Example 2: Linux shadow file"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#example-3-common-active-directory-hash-types",children:"Example 3: Common active directory hash types"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#ntlm",children:"NTLM"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#netntlmv2",children:"NetNTLMv2"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#cracking-miscellaneous-files--hashes",children:"Cracking miscellaneous files & hashes"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#example-1-microsoft-office-documents",children:"Example 1: Microsoft Office documents"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#example-2-zip-files",children:"Example 2: ZIP files"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#example-3-keepass-files",children:"Example 3: KeePass files"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#example-4-pdf-files",children:"Example 4: PDF files"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.a,{href:"#cracking-wpawpa2-handshakes",children:"Cracking WPA/WPA2 handshakes"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#cracking-mic",children:"Cracking MIC"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"#cracking-pmkid",children:"Cracking PMKID"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"introduction",children:"Introduction"}),"\n",(0,a.jsx)(s.h3,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(s.p,{children:"Password cracking attempts to recover the original data, from either hashed or encrypted data, by performing brute force attacks against various algorithms and divulge the cleartext password."}),"\n",(0,a.jsx)(s.p,{children:"Weak and reused passwords are two major factors that can determine the success of this attack. Additionally, attackers can create fine-tuned wordlists and use rules to mutate the passwords based on the target application or environment."}),"\n",(0,a.jsx)(s.admonition,{type:"warning",children:(0,a.jsxs)(s.p,{children:["We'll start with a popular tool ",(0,a.jsx)(s.code,{children:"Hashcat"})," but a variety of open-source tools exist."]})}),"\n",(0,a.jsx)(s.h3,{id:"hashing",children:"Hashing"}),"\n",(0,a.jsxs)(s.p,{children:["Hashing is the process of ",(0,a.jsx)(s.strong,{children:"converting some text to a string, which is unique to that particular text"}),". Usually, a hash function returns hashes with the same length irrespective of the type, length, or size of the data."]}),"\n",(0,a.jsx)(s.admonition,{type:"info",children:(0,a.jsxs)(s.p,{children:["Hashing can be used for various purposes; for example, the ",(0,a.jsx)(s.em,{children:"MD5"})," and ",(0,a.jsx)(s.em,{children:"SHA256"})," algorithms are usually used to verify file integrity, while algorithms such as ",(0,a.jsx)(s.em,{children:"PBKDF2"})," are used to hash passwords before storage."]})}),"\n",(0,a.jsxs)(s.p,{children:["It's a ",(0,a.jsx)(s.strong,{children:"one-way process"}),", meaning there is no way of reconstructing the original plaintext from a hash. Some hash functions can be ",(0,a.jsx)(s.em,{children:"keyed"})," (i.e., an additional secret is used to create the hash) like HMAC, which acts as a ",(0,a.jsx)(s.em,{children:"checksum"})," to mverify if a particular message was tampered with."]}),"\n",(0,a.jsx)(s.p,{children:"Because of this, the only way to attack it is to use a list containing possible passwords. Each password from the the list is hashed and compared to the original hash."}),"\n",(0,a.jsx)(s.admonition,{type:"warning",children:(0,a.jsxs)(s.p,{children:["Some hash functions, such as MD5, have been vulnerable to ",(0,a.jsx)(s.em,{children:"collisions"}),", where two sets of plaintext can produce the same hash."]})}),"\n",(0,a.jsx)(s.h4,{id:"algorithms-for-password-protection",children:"Algorithms for password protection"}),"\n",(0,a.jsx)(s.p,{children:"Mainly four algorithms are used to protect passwords on Unix systems:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.em,{children:"SHA-512"}),": Converts a long string of characters into a hash value fast and efficiently, but there are many ",(0,a.jsx)(s.em,{children:"rainbow table attacks"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.em,{children:"Blowfish"})," is a symmetric block cipher algorithm that encrypts a password with a key. It's more secure than SHA-512 but slower."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.em,{children:"Bcrypt"})," uses a slow hash function to make it hard for potential attackers to perform rainbow table attacks."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.em,{children:"Argon2"})," is a modern and secure algorithm explicitly designed for password hashing systems. It uses multiple rounds of hash functions and a large amount of memory to make it harder for attackers to guess passwords. It's considered ",(0,a.jsx)(s.strong,{children:"one of the most secure"})," algorithms because of this."]}),"\n"]}),"\n",(0,a.jsx)(s.h4,{id:"salting",children:"Salting"}),"\n",(0,a.jsxs)(s.p,{children:["Salting is a protection employed against the brute-forcing of hashes. A ",(0,a.jsx)(s.em,{children:"salt"})," is a random piece of data added to the plaintext before hashing it. An attacker trying to crack this hash will have to sacrifice extra time to append the salt before calculating the hash."]}),"\n",(0,a.jsx)(s.h3,{id:"encryption",children:"Encryption"}),"\n",(0,a.jsxs)(s.p,{children:["Encryption is the process of converting data into a format in which the original content is not accessible. Unlike hashing, ",(0,a.jsx)(s.strong,{children:"encryption is reversible"}),", it's possible to decrypt the ciphertext (encrypted data) and obtain the original content."]}),"\n",(0,a.jsx)(s.admonition,{type:"info",children:(0,a.jsx)(s.p,{children:"Some classic examples of encryption ciphers are the Caesar cipher, Bacon's cipher and Substitution cipher."})}),"\n",(0,a.jsxs)(s.p,{children:["There are two types of encryption algorithms: ",(0,a.jsx)(s.em,{children:"Symmetric"})," and ",(0,a.jsx)(s.em,{children:"Asymmetric"}),"."]}),"\n",(0,a.jsx)(s.h4,{id:"symmetric-encryption",children:"Symmetric encryption"}),"\n",(0,a.jsx)(s.p,{children:"Symmetric algorithms use a key or secret to encrypt the data and use the same key to decrypt it (e.g., XOR algorithm)."}),"\n",(0,a.jsx)(s.h4,{id:"aymmetric-encryption",children:"Aymmetric encryption"}),"\n",(0,a.jsx)(s.p,{children:"Asymmetric algortihms divide the key into two parts (i.e., public and private). The public key can be given to anyone who wishes tn encrypt information and pass it securely to the owner. The owner then uses their private key to decrypt the content."}),"\n",(0,a.jsx)(s.p,{children:"Some examples are RSA, ECDSA, and Diffie-Hellman."}),"\n",(0,a.jsxs)(s.p,{children:["One of the prominent uses of asymmetric encryption is ",(0,a.jsx)(s.em,{children:"HTTPS (Hypertext Transfer Protocol Secure)"})," protocol in the form of ",(0,a.jsx)(s.em,{children:"SSL (Secure Socketys Layer)"}),"."]}),"\n",(0,a.jsx)(s.admonition,{type:"info",children:(0,a.jsxs)(s.p,{children:["When a client connects to a server using ",(0,a.jsx)(s.em,{children:"HTTPS"}),", a public key exchange occurs. The client's browser uses this public key to encrypt any kind of data sent to the server. The server decrypts the incoming traffic before passing it on to the processing service."]})}),"\n",(0,a.jsx)(s.h3,{id:"identifing-hashes",children:"Identifing hashes"}),"\n",(0,a.jsx)(s.p,{children:"Most hashing algorithms produce hashes of a constant length. Te length can be used to map it to the algorithm it was hashed with. For example, a hash of 32 characters in length can be an MD5 or NTLM hash."}),"\n",(0,a.jsxs)(s.p,{children:["Sometimes, hashes are stored in certain formats. For example, ",(0,a.jsx)(s.code,{children:"hash:salt"})," or ",(0,a.jsx)(s.code,{children:"$id$salt$hash"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["The hash ",(0,a.jsx)(s.code,{children:"$6$vb1tLY1qiY$M.1ZCqKtJBxBtZm1gRi8Bbkn39KU0YJW1cuMFzTRANcNKFKR4RmAQVk4rqQQCkaJT6wXqjUkFcA/qNxLyqW.U/"})," contains three fields delimited by ",(0,a.jsx)(s.code,{children:"$"}),", where the first field is the ",(0,a.jsx)(s.code,{children:"id"})," (i.e., 6). This is used to identify the type of algorithm used for hashing."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-text",children:"$1$  : MD5\n$2a$ : Blowfish\n$2y$ : Blowfish, with correct handling of 8 bit characters\n$5$  : SHA256\n$6$  : SHA512\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Open and closed source software use many different kinds of hash formats. For exapmle, Apache web server stores its hashes in the format ",(0,a.jsx)(s.code,{children:"$apr1$71850310$gh9m4xcAn3MGxogwX/ztb."})," while Wordpress stores them in the form ",(0,a.jsx)(s.code,{children:"$P$984478476IagS59wHZvyQMArzfx58u."}),"."]}),"\n",(0,a.jsx)(s.h4,{id:"hashid",children:"Hashid"}),"\n",(0,a.jsxs)(s.p,{children:["Hashid is a Python tool used to detect various kinds of hashes. At the time of writing, ",(0,a.jsx)(s.code,{children:"hashid"})," can be used to identify over 200 unique hash types, and for others, it will make a best-effort guess."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"$ pip install hashid\n$ hashid '$apr1$71850310$gh9m4xcAn3MGxogwX/ztb.'\n\nAnalyzing '$apr1$71850310$gh9m4xcAn3MGxogwX/ztb.'\n[+] MD5(APR) \n[+] Apache MD5\n"})}),"\n",(0,a.jsxs)(s.p,{children:["If known, ",(0,a.jsx)(s.code,{children:"hashid"})," can also provide the corresponding ",(0,a.jsx)(s.em,{children:"Hashcat"})," mode with the ",(0,a.jsx)(s.code,{children:"-m"})," flag if it is able to determine the hash type."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"$ hashid '$DCC2$10240#tom#e4e938d12fe5974dc42a90120bd9c90f' -m\nAnalyzing '$DCC2$10240#tom#e4e938d12fe5974dc42a90120bd9c90f'\n[+] Domain Cached Credentials 2 [Hashcat Mode: 2100\n"})}),"\n",(0,a.jsx)(s.h4,{id:"context-is-important",children:"Context is important"}),"\n",(0,a.jsx)(s.p,{children:"It is not always possible to identify the algorithm based on the obtained hash. Depending on the software, the plaintext might undergo multiple encryption rounds and salting transformations."}),"\n",(0,a.jsx)(s.admonition,{type:"tip",children:(0,a.jsx)(s.p,{children:"Knowing where the hash came from will greatly help us narrow down the hash type and therefore, the Hashcat hash mode necessary to attmept to crack it."})}),"\n",(0,a.jsx)(s.p,{children:"We usually have some context around tye type of hash we are looking to identify. Was it obtained via an Active Directory attack or from a Windows host? Was it obtained through the successful exploitation of a SQLi vunlerability?"}),"\n",(0,a.jsx)(s.h2,{id:"hashcat-specifics",children:"Hashcat specifics"}),"\n",(0,a.jsx)(s.h3,{id:"hashcat-overview",children:"Hashcat overview"}),"\n",(0,a.jsxs)(s.p,{children:["Hashcat can be downloaded from its ",(0,a.jsx)(s.a,{href:"https://hashcat.net/hashcat/",children:"website"})," or the official ",(0,a.jsx)(s.a,{href:"https://github.com/hashcat/hashcat",children:"repo"}),". Any other repos (i.e., installing from ",(0,a.jsx)(s.code,{children:"apt"}),"), are left up to the 3rd party to keep up-to-date."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"sudo apt install hashcat\nhashcat -h\n"})}),"\n",(0,a.jsxs)(s.p,{children:["The ",(0,a.jsx)(s.code,{children:"-a"})," and ",(0,a.jsx)(s.code,{children:"-m"})," arguments are used to specify the type of attack mode and hash type."]}),"\n",(0,a.jsx)(s.p,{children:"Hashcat supports the following attack modes:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"0: Straight"}),"\n",(0,a.jsx)(s.li,{children:"1: Combination"}),"\n",(0,a.jsx)(s.li,{children:"3: Brute-force"}),"\n",(0,a.jsx)(s.li,{children:"6: Hybrid Wordlist + Mask"}),"\n",(0,a.jsx)(s.li,{children:"7: Hybrid Mask + Wordlist"}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["You can see the list of hash types and examples with ",(0,a.jsx)(s.code,{children:"hashcat --example-hashes | less"})," or ",(0,a.jsx)(s.a,{href:"https://github.com/BrashEndeavours/brashendeavours.gitbook.io/blob/master/pentesting-cheatsheets/hashcat-hash-modes.md",children:"here"}),"."]}),"\n",(0,a.jsx)(s.h3,{id:"dictionary-attack",children:"Dictionary attack"}),"\n",(0,a.jsx)(s.p,{children:"Hashcat's most straightforward but extremley effective attack. The attack reads from a wordlist and tries to crack the supplied hashes."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 0 -m <hash type> <hash file> <wordlist>\n"})}),"\n",(0,a.jsx)(s.admonition,{type:"info",children:(0,a.jsxs)(s.p,{children:["You can get password lists from different sources like ",(0,a.jsx)(s.a,{href:"https://github.com/danielmiessler/SecLists/tree/master/Passwords",children:"SecLists (rockyou.txt)"})," or ",(0,a.jsx)(s.a,{href:"https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm",children:"CrackStation's Password Cracking Dictionary"}),"."]})}),"\n",(0,a.jsx)(s.p,{children:"For example, the following commands will crack a SHA256 hash:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"$ echo -n '!academy' | sha256sum | cut -f1 -d' ' > sha256_hash_example\n$ hashcat -a 0 -m 1400 sha256_hash_example /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n\nhashcat (v6.1.1) starting...\n\n<SNIP>\n\nDictionary cache built:\n* Filename..: /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n* Passwords.: 14344392\n* Bytes.....: 139921507\n* Keyspace..: 14344385\n* Runtime...: 2 secs\n\nApproaching final keyspace - workload adjusted.  \n\n006fc3a9613f3edd9f97f8e8a8eff3b899a2d89e1aabf33d7cc04fe0728b0fe6:!academy\n                                                 \nSession..........: hashcat\nStatus...........: Cracked\nHash.Name........: SHA2-256\nHash.Target......: 006fc3a9613f3edd9f97f8e8a8eff3b899a2d89e1aabf33d7cc...8b0fe6\nTime.Started.....: Fri Aug 28 21:58:44 2020 (4 secs)\nTime.Estimated...: Fri Aug 28 21:58:48 2020 (0 secs)\nGuess.Base.......: File (/opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt)\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........:  3383.5 kH/s (0.46ms) @ Accel:1024 Loops:1 Thr:1 Vec:8\nRecovered........: 1/1 (100.00%) Digests\nProgress.........: 14344385/14344385 (100.00%)\nRejected.........: 0/14344385 (0.00%)\nRestore.Point....: 14340096/14344385 (99.97%)\nRestore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1\nCandidates.#1....: $HEX[216361726f6c796e] -> $HEX[042a0337c2a156616d6f732103]\n\nStarted: Fri Aug 28 21:58:05 2020\nStopped: Fri Aug 28 21:58:49 2020\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Consider a more complex hash such as ",(0,a.jsx)(s.em,{children:"Bcrypt"})," (based on the ",(0,a.jsx)(s.em,{children:"Blowfish cipher"}),"). It utilizes a salt to protect it from rainbow table attacks and can have many rounds of the algorithm applied."]}),"\n",(0,a.jsx)(s.p,{children:'At any time during the cracking process, you can hit the "s" key to get a status on the cracking job, which shows that to attempt every password in the rockyou.txt wordlist will take over 1.5 hours. Applying more rounds of the algorithm will increase cracking time exponentially.'}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-text",children:"[s]tatus [p]ause [b]ypass [c]heckpoint [q]uit => s\n\nSession..........: hashcat\nStatus...........: Running\nHash.Name........: bcrypt $2*$, Blowfish (Unix)\nHash.Target......: $2a$05$ZdEkj8cup/JycBRn2CX.B.nIceCYR8GbPbCCg6RlD7uv...exEbVy\nTime.Started.....: Mon Jun 22 19:43:40 2020 (3 mins, 10 secs)\nTime.Estimated...: Mon Jun 22 21:20:28 2020 (1 hour, 33 mins)\nGuess.Base.......: File (/usr/share/wordlists/rockyou.txt)\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........:     2470 H/s (8.98ms) @ Accel:8 Loops:16 Thr:1 Vec:8\nRecovered........: 0/1 (0.00%) Digests\nProgress.........: 468576/14344385 (3.27%)\nRejected.........: 0/468576 (0.00%)\nRestore.Point....: 468576/14344385 (3.27%)\nRestore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:16-32\nCandidates.#1....: septiembre29 -> sep1101\n"})}),"\n",(0,a.jsx)(s.admonition,{type:"tip",children:(0,a.jsx)(s.p,{children:"In the case of hashes such as bcrypt, it is often better to use smaller, more targeted, wordlists."})}),"\n",(0,a.jsx)(s.h3,{id:"combination-attack",children:"Combination attack"}),"\n",(0,a.jsx)(s.p,{children:"The combination attack modes take in two wordlists as input and create combinations from them. This attack is useful because it is not uncommon for users to join two or more words together."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 1 -m <hash type> <hash file> <wordlist1> <wordlist2>\n"})}),"\n",(0,a.jsx)(s.h3,{id:"mask-attack",children:"Mask attack"}),"\n",(0,a.jsx)(s.p,{children:"Mask attacks are used to generate words matching a specific pattern. It's particularly useful when the password length or format is known. A mask can be created using static characters, range of characters (e.g., [a-z] or [A-Z0-9]), or placeholders."}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Placeholder"}),(0,a.jsx)(s.th,{children:"Meaning"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"?l"}),(0,a.jsx)(s.td,{children:"lower-case ASCII letters (a-z)"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"?u"}),(0,a.jsx)(s.td,{children:"upper-case ASCII letters (A-Z)"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"?d"}),(0,a.jsx)(s.td,{children:"digits (0-9)"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"?h"}),(0,a.jsx)(s.td,{children:"0123456789abcdef"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"?H"}),(0,a.jsx)(s.td,{children:"0123456789ABCDEF"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"?s"}),(0,a.jsxs)(s.td,{children:["special characters ",(0,a.jsx)(s.code,{children:"\xabspace\xbb!\"#$%&'()*+,-./:;<=>?@[]^_{"})]})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"?a"}),(0,a.jsx)(s.td,{children:"?l?u?d?s"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"?b"}),(0,a.jsx)(s.td,{children:"0x00 - 0xff"})]})]})]}),"\n",(0,a.jsxs)(s.p,{children:["Consider the company Inlane Freight, with password with the scheme ",(0,a.jsx)(s.code,{children:"ILFREIGHT<userid><year>"}),", where userid is 5 characters long. The mask ",(0,a.jsx)(s.code,{children:"ILFREIGHT?l?l?l?l?l20[0-1]?d"})," can be used to crack password with the specified pattern, where ",(0,a.jsx)(s.code,{children:"?l"})," is a letter and ",(0,a.jsx)(s.code,{children:"20[0-1]?d"})," will include all years from 2000 to 2019."]}),"\n",(0,a.jsx)(s.admonition,{type:"tip",children:(0,a.jsxs)(s.p,{children:["Placeholders can be combined with options ",(0,a.jsx)(s.code,{children:"-1"})," to ",(0,a.jsx)(s.code,{children:"-4"})," which can be used for custom placeholders. For example providing the option ",(0,a.jsx)(s.code,{children:"-1 01"})," enables you to use ",(0,a.jsx)(s.code,{children:"?1"})," as a placeholder to specify just 0 and 1."]})}),"\n",(0,a.jsx)(s.p,{children:"For example, create a hash:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"echo -n 'ILFREIGHTabcxy2015' | md5sum | tr -d \" -\" > md5_mask_example_hash\n"})}),"\n",(0,a.jsx)(s.p,{children:"And then, try to crack it:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 3 -m 0 md5_mask_example_hash -1 01 'ILFREIGHT?l?l?l?l?l20?1?d'\n"})}),"\n",(0,a.jsx)(s.admonition,{type:"tip",children:(0,a.jsxs)(s.p,{children:["The ",(0,a.jsx)(s.code,{children:"--increment"})," flag can be used to increment the mask length automatically, with a length limit that can be supplied using the ",(0,a.jsx)(s.code,{children:"--increment-max"}),"."]})}),"\n",(0,a.jsx)(s.h3,{id:"hybrid-attack",children:"Hybrid attack"}),"\n",(0,a.jsx)(s.p,{children:"Hybrid mode is a variation of the combinator attack, wherein multiple modes can be used together for a fine-tuned wordlist creation. It's particularly useful when you know or have a general idea of the organization's password policy."}),"\n",(0,a.jsxs)(s.p,{children:["For example, consider a password such as ",(0,a.jsx)(s.code,{children:"football1$"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"echo -n 'football1$' | md5sum | tr -d \" -\" > hybrid_hash\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Attack mode ",(0,a.jsx)(s.code,{children:"6"})," reads words from the wordlist and appends a unique string based on the mask supplied. In this case, the mask ",(0,a.jsx)(s.code,{children:"?d?s"})," tells hashcat to append a digit and a special character at the end of each word in the ",(0,a.jsx)(s.code,{children:"rockyou.txt"})," wordlist."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 6 -m 0 hybrid_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt '?d?s'\n"})}),"\n",(0,a.jsxs)(s.p,{children:["As another example, consider the password ",(0,a.jsx)(s.code,{children:"2015football"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"echo -n '2015football' | md5sum | tr -d \" -\" > hybrid_hash_prefix \n"})}),"\n",(0,a.jsxs)(s.p,{children:["Attack mode ",(0,a.jsx)(s.code,{children:"7"})," can be used to prepend characters to words using a given mask. In this case, the mask ",(0,a.jsx)(s.code,{children:"20?1?d"})," with custom character set ",(0,a.jsx)(s.code,{children:"-1 01"})," will prepend various years to each word in the wordlist (i.e., 2010, 2011, 2012...)."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:" hashcat -a 7 -m 0 hybrid_hash_prefix -1 01 '20?1?d' /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.h2,{id:"creating-custom-wordlists",children:"Creating custom wordlists"}),"\n",(0,a.jsxs)(s.p,{children:["There are many open-source tools that help creating wordlists (",(0,a.jsx)(s.a,{href:"../../wordlists",children:"see wordlists section"}),")."]}),"\n",(0,a.jsxs)(s.p,{children:["By default, hashcate stores stores all cracked passwords in the ",(0,a.jsx)(s.code,{children:"hashcat.potfile"})," file, in the format ",(0,a.jsx)(s.code,{children:"hash:password"}),". You can display cracked passwords with the ",(0,a.jsx)(s.code,{children:"--show"})," command. This can be used to create new wordlists of previously cracked passwords."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"cut -d: -f 2- ~/hashcat.potfile\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Also, the ",(0,a.jsx)(s.a,{href:"https://github.com/hashcat/hashcat-utils",children:"hashcat-utils repo"})," contains many utilities that can be useful for more advanced password cracking. The tool ",(0,a.jsx)(s.a,{href:"https://github.com/hashcat/maskprocessor",children:"maskprocessor"}),", for example, can be used to create wordlists using a given mask (e.g., append special characters to the end of a word):"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"$ /mp64.bin Welcome?s\nWelcome \nWelcome!\nWelcome\"\nWelcome#\nWelcome$\nWelcome%\nWelcome&\nWelcome'\nWelcome(\nWelcome)\nWelcome*\nWelcome+\n\n<SNIP>\n"})}),"\n",(0,a.jsx)(s.h2,{id:"working-with-rules",children:"Working with rules"}),"\n",(0,a.jsxs)(s.p,{children:["The ",(0,a.jsx)(s.em,{children:"rule-based attack"})," is the most advanced and complex password cracking mode. Rules help perform various operations on the input wordlist, such as prefixing, suffixing, toggling case, cutting, reversing, and much more. Rules take ",(0,a.jsx)(s.em,{children:"mask-based attacks"})," to another level and provide increased cracking rates. Additionally, the usage of rules saves disk space and processing time incurred as a result of larger wordlists."]}),"\n",(0,a.jsxs)(s.p,{children:["A rule can be created using functions, which takes a word as an input and output its modified version. The following table describes some functions which are compatible with JtR as well as Hashcat (",(0,a.jsx)(s.a,{href:"https://hashcat.net/wiki/doku.php?id=rule_based_attack#implemented_compatible_functions",children:"here's the complete list"}),")"]}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Function"}),(0,a.jsx)(s.th,{children:"Description"}),(0,a.jsx)(s.th,{children:"Input"}),(0,a.jsx)(s.th,{children:"Output"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"l"}),(0,a.jsx)(s.td,{children:"Convert all letters to lowercase"}),(0,a.jsx)(s.td,{children:"InlaneFreight2020"}),(0,a.jsx)(s.td,{children:"inlanefreight2020"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"u"}),(0,a.jsx)(s.td,{children:"Convert all letters to uppercase"}),(0,a.jsx)(s.td,{children:"InlaneFreight2020"}),(0,a.jsx)(s.td,{children:"INLANEFREIGHT2020"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"c / C"}),(0,a.jsx)(s.td,{children:"capitalize / lowercase first letter and invert the rest"}),(0,a.jsx)(s.td,{children:"inlaneFreight2020 / Inlanefreight2020"}),(0,a.jsx)(s.td,{children:"Inlanefreight2020 / iNLANEFREIGHT2020"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"t / TN"}),(0,a.jsx)(s.td,{children:"Toggle case : whole word / at position N"}),(0,a.jsx)(s.td,{children:"InlaneFreight2020"}),(0,a.jsx)(s.td,{children:"iNLANEfREIGHT2020"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"d / q / zN / ZN"}),(0,a.jsx)(s.td,{children:"Duplicate word / all characters / first character / last character"}),(0,a.jsx)(s.td,{children:"InlaneFreight2020"}),(0,a.jsx)(s.td,{children:"InlaneFreight2020InlaneFreight2020 / IInnllaanneeFFrreeiigghhtt22002200 / IInlaneFreight2020 / InlaneFreight20200"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"{ / }"})}),(0,a.jsx)(s.td,{children:"Rotate word left / right"}),(0,a.jsx)(s.td,{children:"InlaneFreight2020"}),(0,a.jsx)(s.td,{children:"nlaneFreight2020I / 0InlaneFreight202"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"^X / $X"}),(0,a.jsx)(s.td,{children:"Prepend / Append character X"}),(0,a.jsx)(s.td,{children:"InlaneFreight2020 (^! / $! )"}),(0,a.jsx)(s.td,{children:"!InlaneFreight2020 / InlaneFreight2020!"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"r"}),(0,a.jsx)(s.td,{children:"Reverse"}),(0,a.jsx)(s.td,{children:"InlaneFreight2020"}),(0,a.jsx)(s.td,{children:"0202thgierFenalnI"})]})]})]}),"\n",(0,a.jsxs)(s.p,{children:["Also, words with length less than N can be rejected with ",(0,a.jsx)(s.code,{children:">N"}),", while words greater than N can be rejected with ",(0,a.jsx)(s.code,{children:"<N"})," ",(0,a.jsx)(s.a,{href:"https://hashcat.net/wiki/doku.php?id=rule_based_attack#rules_used_to_reject_plains",children:"here's the list of rejection rules"}),"."]}),"\n",(0,a.jsx)(s.admonition,{type:"tip",children:(0,a.jsxs)(s.p,{children:["There are a variety of publicly available rules such as the ",(0,a.jsx)(s.a,{href:"https://github.com/NSAKEY/nsa-rules",children:"nsa-rules"}),", ",(0,a.jsx)(s.a,{href:"https://github.com/praetorian-code/Hob0Rules",children:"Hob0Rules"})," and ",(0,a.jsx)(s.a,{href:"https://github.com/sparcflow/HackLikeALegend/blob/master/old/chap3/corporate.rule",children:"corporate.rule"})]})}),"\n",(0,a.jsx)(s.h3,{id:"example-rule-creation",children:"Example rule creation"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"L33tspeak"})," is a common but efficient technique of replacing letters with similar numbers, like ",(0,a.jsx)(s.code,{children:"o"})," can be replaced with ",(0,a.jsx)(s.code,{children:"0"})," or ",(0,a.jsx)(s.code,{children:"i"})," can be replaced with ",(0,a.jsx)(s.code,{children:"1"}),"."]}),"\n",(0,a.jsx)(s.p,{children:"Consider the following rules:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"c so0 si1 se3 ss5 sa@ $2 $0 $1 $9\n"})}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["The first letter word is capitalized with the ",(0,a.jsx)(s.code,{children:"c"})," function."]}),"\n",(0,a.jsxs)(s.li,{children:["The substitute function ",(0,a.jsx)(s.code,{children:"s"})," is sued to replace ",(0,a.jsx)(s.code,{children:"o"})," with ",(0,a.jsx)(s.code,{children:"0"}),", ",(0,a.jsx)(s.code,{children:"i"})," with ",(0,a.jsx)(s.code,{children:"1"}),", ",(0,a.jsx)(s.code,{children:"e"})," with ",(0,a.jsx)(s.code,{children:"3"}),", and ",(0,a.jsx)(s.code,{children:"a"})," with ",(0,a.jsx)(s.code,{children:"@"}),". At the end."]}),"\n",(0,a.jsxs)(s.li,{children:["At the end, the year ",(0,a.jsx)(s.code,{children:"2019"})," is appended to it."]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"You can test this with a single word:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"$ hashcat -r rule.txt 'password_ilfreight' --stdout\n\nP@55w0rd_1lfr31ght2019\n"})}),"\n",(0,a.jsx)(s.h3,{id:"example-rule-based-attack",children:"Example rule-based attack"}),"\n",(0,a.jsxs)(s.p,{children:["Consider the password ",(0,a.jsx)(s.code,{children:"St@r5h1p2019"})," hashed with ",(0,a.jsx)(s.code,{children:"SHA1"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"echo -n 'St@r5h1p2019' | sha1sum | awk '{print $1}' | tee hash\n"})}),"\n",(0,a.jsxs)(s.p,{children:["We can the use the rule ",(0,a.jsx)(s.code,{children:"c so0 si1 se3 ss5 sa@ $2 $0 $1 $9"})," and the ",(0,a.jsx)(s.code,{children:"rockyou.txt"})," dictionary file to crack the hash using Hashcat."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"echo 'c so0 si1 se3 ss5 sa@ $2 $0 $1 $9' > rule.txt\n\nhashcat -a 0 -m 100 hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt -r rule.txt\n"})}),"\n",(0,a.jsx)(s.admonition,{type:"tip"}),"\n",(0,a.jsx)(s.h3,{id:"built-in-defaults",children:"Built-in defaults"}),"\n",(0,a.jsx)(s.p,{children:"Hashcat installs with a variety of rules by default:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"]$ ls -l /usr/share/hashcat/rules/\n\ntotal 2576\n-rw-r--r-- 1 root root    933 Jun 19 06:20 best64.rule\n-rw-r--r-- 1 root root    633 Jun 19 06:20 combinator.rule\n-rw-r--r-- 1 root root 200188 Jun 19 06:20 d3ad0ne.rule\n-rw-r--r-- 1 root root 788063 Jun 19 06:20 dive.rule\n-rw-r--r-- 1 root root 483425 Jun 19 06:20 generated2.rule\n-rw-r--r-- 1 root root  78068 Jun 19 06:20 generated.rule\ndrwxr-xr-x 1 root root   2804 Jul  9 21:01 hybrid\n-rw-r--r-- 1 root root 309439 Jun 19 06:20 Incisive-leetspeak.rule\n-rw-r--r-- 1 root root  35280 Jun 19 06:20 InsidePro-HashManager.rule\n-rw-r--r-- 1 root root  19478 Jun 19 06:20 InsidePro-PasswordsPro.rule\n-rw-r--r-- 1 root root    298 Jun 19 06:20 leetspeak.rule\n-rw-r--r-- 1 root root   1280 Jun 19 06:20 oscommerce.rule\n-rw-r--r-- 1 root root 301161 Jun 19 06:20 rockyou-30000.rule\n-rw-r--r-- 1 root root   1563 Jun 19 06:20 specific.rule\n-rw-r--r-- 1 root root  64068 Jun 19 06:20 T0XlC-insert_00-99_1950-2050_toprules_0_F.rule\n-rw-r--r-- 1 root root   2027 Jun 19 06:20 T0XlC-insert_space_and_special_0_F.rule\n-rw-r--r-- 1 root root  34437 Jun 19 06:20 T0XlC-insert_top_100_passwords_1_G.rule\n-rw-r--r-- 1 root root  34813 Jun 19 06:20 T0XlC.rule\n-rw-r--r-- 1 root root 104203 Jun 19 06:20 T0XlCv1.rule\n-rw-r--r-- 1 root root     45 Jun 19 06:20 toggles1.rule\n-rw-r--r-- 1 root root    570 Jun 19 06:20 toggles2.rule\n-rw-r--r-- 1 root root   3755 Jun 19 06:20 toggles3.rule\n-rw-r--r-- 1 root root  16040 Jun 19 06:20 toggles4.rule\n-rw-r--r-- 1 root root  49073 Jun 19 06:20 toggles5.rule\n-rw-r--r-- 1 root root  55346 Jun 19 06:20 unix-ninja-leetspeak.rule\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Also, Hashcat provides an option to generate random rules on the fly and apply them to the input wordlists. The following command will generate 1000 random rules and apply them to each word from ",(0,a.jsx)(s.code,{children:"rockyou.txt"})," by specifying the ",(0,a.jsx)(s.code,{children:"-g"})," flag. There's no certainty to the success rate of this attack:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 0 -m 100 -g 1000 hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.h2,{id:"cracking",children:"Cracking"}),"\n",(0,a.jsx)(s.h3,{id:"cracking-common-hashes",children:"Cracking common hashes"}),"\n",(0,a.jsx)(s.h4,{id:"common-hash-types",children:"Common hash types"}),"\n",(0,a.jsxs)(s.p,{children:["Some hash types are extremely common to find. Hashcat team maintains a list of ",(0,a.jsx)(s.a,{href:"https://hashcat.net/wiki/doku.php?id=example_hashes",children:"example hashes"}),". Here are the most commonly seen hash types:"]}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Hashmode"}),(0,a.jsx)(s.th,{children:"Hash Name"}),(0,a.jsx)(s.th,{children:"Example Hash"}),(0,a.jsx)(s.th,{children:"Output"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"0"}),(0,a.jsx)(s.td,{children:"MD5"}),(0,a.jsx)(s.td,{children:"8743b52063cd84097a65d1633f5c74f5"}),(0,a.jsx)(s.td,{children:"inlanefreight2020"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"100"}),(0,a.jsx)(s.td,{children:"SHA1"}),(0,a.jsx)(s.td,{children:"b89eaac7e61417341b710b727768294d0e6a277b"}),(0,a.jsx)(s.td,{children:"INLANEFREIGHT2020"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"1000"}),(0,a.jsx)(s.td,{children:"NTLM"}),(0,a.jsx)(s.td,{children:"b4b9b02e6f09a9bd760f388b67351e2b"}),(0,a.jsx)(s.td,{children:"Inlanefreight2020 / iNLANEFREIGHT2020"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"1800"}),(0,a.jsxs)(s.td,{children:["sha512crypt ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsx)(s.mn,{children:"6"})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"6"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(s.span,{className:"mord",children:"6"})]})})]}),", SHA512 (Unix)"]}),(0,a.jsxs)(s.td,{children:[(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsx)(s.mn,{children:"6"})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"6"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(s.span,{className:"mord",children:"6"})]})})]}),"52450745$k5ka2p8bFuSmoVT1tzOyyuaREkkKBcCNqoDKzYiJL9RaE8yMnPgh2XzzF0NDrUhgrcLwg78xs1w5pJiypEdFX/"]}),(0,a.jsx)(s.td,{children:"iNLANEfREIGHT2020"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"3200"}),(0,a.jsxs)(s.td,{children:["bcrypt ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mn,{children:"2"}),(0,a.jsx)(s.mo,{children:"\u2217"})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"2*"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(s.span,{className:"mord",children:"2"}),(0,a.jsx)(s.span,{className:"mord",children:"\u2217"})]})})]}),", Blowfish (Unix)"]}),(0,a.jsxs)(s.td,{children:[(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mn,{children:"2"}),(0,a.jsx)(s.mi,{children:"a"})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"2a"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(s.span,{className:"mord",children:"2"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"a"})]})})]}),"05$LhayLxezLhK1LhWvKxCyLOj0j1u.Kj0jZ0pEmm134uzrQlFvQJLF6"]}),(0,a.jsx)(s.td,{children:"InlaneFreight2020InlaneFreight2020 / IInnllaanneeFFrreeiigghhtt22002200 / IInlaneFreight2020 / InlaneFreight20200"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"5500"}),(0,a.jsx)(s.td,{children:"NetNTLMv1 / NetNTLMv1+ESS"}),(0,a.jsxs)(s.td,{children:["u4-netntlm::kNS:338d08f8e26de93300000000000000000000000000000000:9526fb8c23a90751cdd619b6cea564742e1e4bf33006ba41",":cb8086049ec4736c"]}),(0,a.jsx)(s.td,{children:"nlaneFreight2020I / 0InlaneFreight202"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"5600"}),(0,a.jsx)(s.td,{children:"NetNTLMv2"}),(0,a.jsx)(s.td,{children:"admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030"}),(0,a.jsx)(s.td,{children:"!InlaneFreight2020 / InlaneFreight2020!"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"13100"}),(0,a.jsx)(s.td,{children:"Kerberos 5 TGS-REP etype 23"}),(0,a.jsxs)(s.td,{children:[(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"k"}),(0,a.jsx)(s.mi,{children:"r"}),(0,a.jsx)(s.mi,{children:"b"}),(0,a.jsx)(s.mn,{children:"5"}),(0,a.jsx)(s.mi,{children:"t"}),(0,a.jsx)(s.mi,{children:"g"}),(0,a.jsx)(s.mi,{children:"s"})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"krb5tgs"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"b"}),(0,a.jsx)(s.span,{className:"mord",children:"5"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"s"})]})})]}),"23",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"u"}),(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mi,{children:"e"}),(0,a.jsx)(s.mi,{children:"r"})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"user"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"u"}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"ser"})]})})]}),"realm",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"t"}),(0,a.jsx)(s.mi,{children:"e"}),(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mi,{children:"t"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"/"}),(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mi,{children:"p"}),(0,a.jsx)(s.mi,{children:"n"})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"test/spn"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"es"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,a.jsx)(s.span,{className:"mord",children:"/"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"n"})]})})]}),"63386d22d359fe42230300d56852c9eb$ < SNIP >"]}),(0,a.jsx)(s.td,{children:"0202thgierFenalnI"})]})]})]}),"\n",(0,a.jsx)(s.h4,{id:"example-1-database-dumps",children:"Example 1: Database dumps"}),"\n",(0,a.jsx)(s.p,{children:"MD5, SHA1, and bcrypt hashes are often seen in database dumps. These hashes may be retrieved following a successful SQLi attack or found in publicly available password data from breach database dumps."}),"\n",(0,a.jsx)(s.p,{children:"Consider the following SHA1 hahes list:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-text",children:"winter!\nbaseball1\nwaterslide\nsummertime\nbaconandeggs\nbeach1234\nsunshine1\nwelcome1\npassword123\n"})}),"\n",(0,a.jsx)(s.p,{children:"Create the SHA1 hash of each word:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"$ for i in $(cat words); do echo -n $i | sha1sum | tr -d ' -';done\n\nfa3c9ecfc251824df74026b4f40e4b373fd4fc46\ne6852777c0260493de41fb43918ab07bbb3a659c\n0c3feaa16f73493f998970e22b2a02cb9b546768\nb863c49eada14e3a8816220a7ab7054c28693664\nb0feedd70a346f7f75086026169825996d7196f9\nf47f832cba913ec305b07958b41babe2e0ad0437\n08b314f0e1e2c41ec92c3735910658e5a82c6ba7\ne35bece6c5e6e0e86ca51d0440e92282a9d6ac8a\ncbfdac6008f9cab4083784cbd1874f76618d2a97\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Then run a Hashcat dictionary attack using the ",(0,a.jsx)(s.code,{children:"rockyou.txt"})," wordlist:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -m 100 SHA1_hashes /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.admonition,{type:"warning",children:(0,a.jsxs)(s.p,{children:["Variations on the abovel ist, such as ",(0,a.jsx)(s.code,{children:"Bas3b@ll1"})," or ",(0,a.jsx)(s.code,{children:"Wat3rSl1de"})," would likely take longer to crack and may require additional techniques such as mask and hybrid attacks."]})}),"\n",(0,a.jsx)(s.h4,{id:"example-2-linux-shadow-file",children:"Example 2: Linux shadow file"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.em,{children:"Sha512crypt"})," hashes are commonly found in the ",(0,a.jsx)(s.code,{children:"/etc/shadow"})," file on Linux systems, which contains the password hashes for all accounts with a login shell assigned to them."]}),"\n",(0,a.jsxs)(s.p,{children:["Let's look at a hash from a standard Ubuntu installation corresponding to ",(0,a.jsx)(s.code,{children:"password123"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-text",children:"root:$6$tOA0cyybhb/Hr7DN$htr2vffCWiPGnyFOicJiXJVMbk1muPORR.eRGYfBYUnNPUjWABGPFiphjIjJC5xPfFUASIbVKDAHS3vTW1qU.1:18285:0:99999:7:::\n"})}),"\n",(0,a.jsxs)(s.p,{children:["The hash contains ",(0,a.jsx)(s.strong,{children:"nine fields separated by colons"}),". The first two fields contain the username and its encrypted hash. The rest fields contain various attributes such as password creation time, last change time, and expiry."]}),"\n",(0,a.jsxs)(s.p,{children:["Coming to the hash, we know it contains three fields delimited by ",(0,a.jsx)(s.code,{children:"$"}),". The value ",(0,a.jsx)(s.code,{children:"6"})," stands for the ",(0,a.jsx)(s.code,{children:"SHA-512"})," hashing algorithm, the next 16 characters represent the salt, while the rest of it is the actual hash."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -m 1800 nix_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.h4,{id:"example-3-common-active-directory-hash-types",children:"Example 3: Common active directory hash types"}),"\n",(0,a.jsxs)(s.p,{children:["In organizations using Active Directory, it's often possible to obtain credentials in cleartext or re-use password hashes to further access via ",(0,a.jsx)(s.em,{children:"Pass-the-Hash"})," or ",(0,a.jsx)(s.em,{children:"SMB Relay attacks"}),". Still, some techniques will reslt in a password hash that must be creacked offline to further our access."]}),"\n",(0,a.jsxs)(s.p,{children:["Some examples include a NetNTLMv1 or NetNTLMv2 ovtained through a MITM attack, a Kerberos 5 TGS-REP hash obtained through a Kerberoasting attack, or an NTLM hash obtained either by dumping credentials from memory using ",(0,a.jsx)(s.em,{children:"Mimikatz"})," tool or obtained from a Windows machine's local SAM database."]}),"\n",(0,a.jsx)(s.h4,{id:"ntlm",children:"NTLM"}),"\n",(0,a.jsxs)(s.p,{children:["Retrieve an NTLM password hash from a user that has ",(0,a.jsx)(s.em,{children:"Remote Desktop"})," (",(0,a.jsx)(s.em,{children:"RDP"}),") access to a server but is not a local administrator, so the NTLM hash cannot be used for a pass-the-hash attack. In this case, the cleartext password is necessary to further our access by connecting to the server via RDP and performing further enumeration within the network or looking for local privilege escalation vectors."]}),"\n",(0,a.jsxs)(s.p,{children:["For example, quickly generate an NTLM hash of ",(0,a.jsx)(s.code,{children:"Password01"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:'$ python3\n\nPython 3.8.3 (default, May 14 2020, 11:03:12) \n[GCC 9.3.0] on linux\nType "help", "copyright", "credits" or "license" for more information.\n\n>>> import hashlib,binascii\n>>> hash = hashlib.new(\'md4\', "Password01".encode(\'utf-16le\')).digest()\n>>> print (binascii.hexlify(hash))\n\nb\'7100a909c7ff05b266af3c42ec058c33\'\n'})}),"\n",(0,a.jsxs)(s.p,{children:["Then run the resultant NTLM password through Hashcat using the standard ",(0,a.jsx)(s.code,{children:"rockyou.txt"})," wordlist:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 0 -m 1000 ntlm_example /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.h4,{id:"netntlmv2",children:"NetNTLMv2"}),"\n",(0,a.jsxs)(s.p,{children:["In busy corporate networks it is common to retrieve many NetNTLMv2 password hashes using MITM attacks with tools like ",(0,a.jsx)(s.em,{children:"Responder"}),". These can often be cracked and leveraged to establish a foothold in the AD environment. Consider the following password hash: ",(0,a.jsx)(s.code,{children:"sqladmin::INLANEFREIGHT:f54d6f198a7a47d4:7FECABAE13101DAAA20F1B09F7F7A4EA:0101000000000000C0653150DE09D20126F3F71DF13C1FD8000000000200080053004D004200330001001E00570049004E002D00500052004800340039003200520051004100460056000400140053004D00420033002E006C006F00630061006C0003003400570049004E002D00500052004800340039003200520051004100460056002E0053004D00420033002E006C006F00630061006C000500140053004D00420033002E006C006F00630061006C0007000800C0653150DE09D201060004000200000008003000300000000000000000000000003000001A67637962F2B7BF297745E6074934196D5F4371B6BA3E796F2997306FD4C1C00A001000000000000000000000000000000000000900280063006900660073002F003100390032002E003100360038002E003100390035002E00310037003000000000000000000000000000"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["Some tools, such as ",(0,a.jsx)(s.em,{children:"Responder"}),", will inform you what type of hash was received. A NetNTLMv2 hash relates to the mode ",(0,a.jsx)(s.code,{children:"5600"})," in Hashcat."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 0 -m 5600 inlanefreight_ntlmv2 /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.h3,{id:"cracking-miscellaneous-files--hashes",children:"Cracking miscellaneous files & hashes"}),"\n",(0,a.jsx)(s.p,{children:"It's common to encounter password-protected documents such as Microsoft Word and Excel documents, OneNote notebooks, KeePass database files, SSH private key passphrases, PDF files, zip files, and more."}),"\n",(0,a.jsx)(s.admonition,{type:"tip",children:(0,a.jsxs)(s.p,{children:["Various tools exist to help us extract the password hashes from these files in a format that Hashcat can understand. For example, ",(0,a.jsx)(s.code,{children:"JohnTheRipper"})," comes with ",(0,a.jsx)(s.a,{href:"https://github.com/openwall/john/tree/bleeding-jumbo/src",children:"many of these tools"}),". One additional tool ported to Python is ",(0,a.jsx)(s.a,{href:"https://gist.github.com/HarmJ0y/116fa1b559372804877e604d7d367bbc#file-keepass2john-py",children:"keeypass2jhon.py"})," for extracting a crackable hash from KeePass 1.x/2.x databases."]})}),"\n",(0,a.jsx)(s.h4,{id:"example-1-microsoft-office-documents",children:"Example 1: Microsoft Office documents"}),"\n",(0,a.jsxs)(s.p,{children:["Using the ",(0,a.jsx)(s.a,{href:"https://raw.githubusercontent.com/magnumripper/JohnTheRipper/bleeding-jumbo/run/office2john.py",children:"office2john.py"})," tool, you can extract password hashes from some Microsoft Office documents."]}),"\n",(0,a.jsx)(s.p,{children:"Hashcat supports the following hash modes for Microsoft Office documents:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"9400: MS Office 2007"}),"\n",(0,a.jsx)(s.li,{children:"9500: MS Office 2010"}),"\n",(0,a.jsx)(s.li,{children:"9600: MS Office 2013"}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["There are also several ",(0,a.jsx)(s.code,{children:"$oldoffice$"})," hash modes for MS Office documents older than 2003."]}),"\n",(0,a.jsxs)(s.p,{children:["Let's take a Word document protected with the password ",(0,a.jsx)(s.code,{children:"pa55word"}),". We can first extrack the hash:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"$ python office2john.py hashcat_Word_example.docx \n\nhashcat_Word_example.docx:$office$*2013*100000*256*16*6e059661c3ed733f5730eaabb41da13a*aa38e007ee01c07e4fe95495934cf68f*2f1e2e9bf1f0b320172cd667e02ad6be1718585b6594691907b58191a6\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Then, run the hash through Hashcat using mode ",(0,a.jsx)(s.code,{children:"9600"})," and make short work of it with the ",(0,a.jsx)(s.code,{children:"rockyou.txt"})," wordlist."]}),"\n",(0,a.jsx)(s.admonition,{type:"warning",children:(0,a.jsx)(s.p,{children:"This is a rather slow hash to crack and will take over 12 hours on a single CPU."})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -m 9600 office_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.h4,{id:"example-2-zip-files",children:"Example 2: ZIP files"}),"\n",(0,a.jsxs)(s.p,{children:["We can extract the password hashes using ",(0,a.jsx)(s.a,{href:"https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/src/zip2john.c",children:"zip2john"}),"."]}),"\n",(0,a.jsx)(s.p,{children:"Hashcat supports a variety of compressed file formats such as:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"11600: 7-Zip"}),"\n",(0,a.jsx)(s.li,{children:"13600: WinZip"}),"\n",(0,a.jsx)(s.li,{children:"17200: PKZIP (Compressed)"}),"\n",(0,a.jsx)(s.li,{children:"17210: PKZIP (Uncompressed)"}),"\n",(0,a.jsx)(s.li,{children:"17220: PKZIP (Compressed Multi-File)"}),"\n",(0,a.jsx)(s.li,{children:"17225: PKZIP (Mixed Multi-File)"}),"\n",(0,a.jsx)(s.li,{children:"17230: PKZIP (Compressed Multi-File Checksum-Only)"}),"\n",(0,a.jsx)(s.li,{children:"23001: SecureZIP AES-128"}),"\n",(0,a.jsx)(s.li,{children:"23002: SecureZIP AES-192"}),"\n",(0,a.jsx)(s.li,{children:"23003: SecureZIP AES-256"}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"For our example, take any documment and add it to a password protected file:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"$ zip --password zippyzippy blueprints.zip dummy.pdf \n\nadding: dummy.pdf (deflated 7%)\n"})}),"\n",(0,a.jsx)(s.p,{children:"Then extract the hash:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"zip2john ~/Desktop/HTB/Academy/Cracking\\ with\\ Hashcat/blueprints.zip\n"})}),"\n",(0,a.jsxs)(s.p,{children:["To run this through Hashcat, we need the entire hash starting from ",(0,a.jsx)(s.code,{children:"$pkzip2$1"})," and ending with ",(0,a.jsx)(s.code,{children:"/pkzip2$"}),". Then, crack it:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 0 -m 17200 pdf_hash_to_crack /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.h4,{id:"example-3-keepass-files",children:"Example 3: KeePass files"}),"\n",(0,a.jsxs)(s.p,{children:["We can extract the password hashes using ",(0,a.jsx)(s.a,{href:"https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/src/keepass2john.c",children:"keepass2john"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"python keepass2john.py Master.kdbx \n"})}),"\n",(0,a.jsx)(s.p,{children:"Hashcat supportsthe following hash types for KeePass databases, all designated by the same hash mode:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"13400: KeePass 1 AES / without keyfile"}),"\n",(0,a.jsx)(s.li,{children:"13400: KeePass 2 AES / without keyfile"}),"\n",(0,a.jsx)(s.li,{children:"13400: KeePass 1 Twofish / with keyfile"}),"\n",(0,a.jsx)(s.li,{children:"13400: Keepass 2 AES / with keyfile"}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 0 -m 13400 keepass_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.h4,{id:"example-4-pdf-files",children:"Example 4: PDF files"}),"\n",(0,a.jsxs)(s.p,{children:["We can extract the password hashes using ",(0,a.jsx)(s.a,{href:"https://raw.githubusercontent.com/truongkma/ctf-tools/master/John/run/pdf2john.py",children:"pdf2john"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"python pdf2john.py inventory.pdf | awk -F\":\" '{ print $2}'\n"})}),"\n",(0,a.jsx)(s.p,{children:"Hashcat supports a variety of PDF file formats:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"10400: PDF 1.1 - 1.3 (Acrobat 2 - 4)"}),"\n",(0,a.jsx)(s.li,{children:"10410: PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #1"}),"\n",(0,a.jsx)(s.li,{children:"10420: PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #2"}),"\n",(0,a.jsx)(s.li,{children:"10500: PDF 1.4 - 1.6 (Acrobat 5 - 8)"}),"\n",(0,a.jsx)(s.li,{children:"10600: PDF 1.7 Level 3 (Acrobat 9)"}),"\n",(0,a.jsx)(s.li,{children:"10700: PDF 1.7 Level 8 (Acrobat 10 - 11)"}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 0 -m 10500 pdf_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.h3,{id:"cracking-wpawpa2-handshakes",children:"Cracking WPA/WPA2 handshakes"}),"\n",(0,a.jsx)(s.p,{children:"Wireless networks are often not properly segmented from a company's corporate network, and successful authentication to it may grant full access to the internal corporate network."}),"\n",(0,a.jsxs)(s.p,{children:["Hashcat can be used to successfully crack both the ",(0,a.jsx)(s.code,{children:"MIC"})," (4-way handshake) and ",(0,a.jsx)(s.code,{children:"PMKID"})," (1st packet/handshake)."]}),"\n",(0,a.jsx)(s.h4,{id:"cracking-mic",children:"Cracking MIC"}),"\n",(0,a.jsx)(s.p,{children:"When a client connecting to the wireless network and the wireless access point (AP) communicate, the must ensure that they both have/know the wireless network key but are not transmitting the key across the network (it's encrypted and verified by the AP)."}),"\n",(0,a.jsx)(s.admonition,{type:"info",children:(0,a.jsxs)(s.p,{children:["The handshake is a collection of keys exchanged during the authenticaton process between the client and the associated AP. These keys are used to generate a common key called the ",(0,a.jsx)(s.em,{children:"Message Integrity Check (MIC)"})," used by an AP to verify that each packet has not been compromised and received in its original state."]})}),"\n",(0,a.jsx)(s.p,{children:"To perform this type of offline cracking attack, we need to capture a valid 4-way handshake by sending de-authentication frames to force a client (user) to disconnect from an AP. When the client reauthenticates (usually automatically), the attacker can attempt to sniff out the WPA 4-way handshake without their knowledge."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"4-way handshake",src:n(6013).Z+"",width:"2576",height:"2076"})}),"\n",(0,a.jsxs)(s.p,{children:["Once we captured a 4-way handshake (with a tool such as ",(0,a.jsx)(s.code,{children:"airodump-ng"}),"), convert it to a format that can be supplied to Hashcat for cracking (i.e., ",(0,a.jsx)(s.code,{children:".cap"})," to ",(0,a.jsx)(s.code,{children:".hccapx"}),"). Hashcat hosts an online service: ",(0,a.jsx)(s.a,{href:"https://hashcat.net/cap2hashcat",children:"cap2hashcat online"})," or you can use ",(0,a.jsx)(s.code,{children:"hashcat-utils"})," repo offline."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"./cap2hccapx.bin corp_capture1-01.cap mic_to_crack.hccapx\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Now, we can perform a straight dictionary attack to crack the WPA handshake with mode ",(0,a.jsx)(s.code,{children:"22000"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 0 -m 22000 mic_to_crack.hccapx /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})}),"\n",(0,a.jsx)(s.p,{children:"Armed with the cracked hey, we can now attempt to authenticate to the wireless network."}),"\n",(0,a.jsx)(s.h4,{id:"cracking-pmkid",children:"Cracking PMKID"}),"\n",(0,a.jsx)(s.p,{children:"This attack can be performed against wireless networks that use WPA/WPA2-PSK (pre-shared key) and allows us to obtain the PSK being used by the targeted wireless network by attacking the AP directly (i.e., it doesn't require deauthentication of any users)."}),"\n",(0,a.jsx)(s.p,{children:"The PMK is the same as in the MIC (4-way handshake) attack but can generally be obtained faster and without interrupting any users."}),"\n",(0,a.jsx)(s.admonition,{type:"info",children:(0,a.jsxs)(s.p,{children:["The ",(0,a.jsx)(s.em,{children:"Pairwise Master Key Identifier (PMKID)"})," is the AP's unique identifier to keep track of the ",(0,a.jsx)(s.em,{children:"Pairwise Master Key (PMK)"})," used by the client. The PMKID is located in the 1st pakcet of the 4-way handshake and can be easier to obtain since it does not require capturing the entire 4-way handshake. PMKID is calculated with ",(0,a.jsx)(s.strong,{children:"HMAC-SHA1"}),' with the PMK (Wirless network password) used as a key, the string "PMK Name", MAC address of the AP, and the MAC address of the station.']})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"PMKID calculation",src:n(4591).Z+"",width:"2576",height:"1886"})}),"\n",(0,a.jsxs)(s.p,{children:["To perform PMKID dracking, we need to obtain the PMKID hash. The first step is extracting it from the capture file (",(0,a.jsx)(s.code,{children:".cap"}),") using a tool such as ",(0,a.jsx)(s.code,{children:"hcxpcaptool"})," from ",(0,a.jsx)(s.code,{children:"hcxtools"}),". You can install it using apt ",(0,a.jsx)(s.code,{children:"sudo apt install hcxtools"}),"."]}),"\n",(0,a.jsx)(s.admonition,{type:"note",children:(0,a.jsxs)(s.p,{children:["This tool has since been replaced by ",(0,a.jsx)(s.code,{children:"hcxpcapngtool"})," which we can compile and install from ",(0,a.jsx)(s.a,{href:"https://github.com/ZerBea/hcxtools",children:"hcxtools repo"}),"."]})}),"\n",(0,a.jsx)(s.p,{children:"For example, extract PMKID using hcxpcaptool:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"$ hcxpcaptool -z pmkidhash_corp cracking_pmkid.cap \n\n<SNIP...>\n1 PMKID(s) written to pmkidhash_corp\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Alternatively, use ",(0,a.jsx)(s.code,{children:"hcxpcapngtool"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"$ hcxpcapngtool cracking_pmkid.cap -o pmkidhash_corp2\n\n<SNIP...>\nPMKID written to combi hash file.........: 1\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Now, we can try a straight dictionary attack with mode ",(0,a.jsx)(s.code,{children:"22000"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-console",children:"hashcat -a 0 -m 22000 pmkidhash_corp /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt\n"})})]})}function d(e={}){const{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},4591:(e,s,n)=>{n.d(s,{Z:()=>a});const a=n.p+"assets/images/image-1-148879b9417f3c6c7bf667a69b70edfa.png"},6013:(e,s,n)=>{n.d(s,{Z:()=>a});const a=n.p+"assets/images/image-37ea889043a78c6f676ce5d50aee8953.png"},1151:(e,s,n)=>{n.d(s,{Z:()=>c,a:()=>i});var a=n(7294);const t={},r=a.createContext(t);function i(e){const s=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(r.Provider,{value:s},e.children)}}}]);