"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9342],{2353:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var t=n(5893),r=n(1151);const s={},l="Path Traversal",a={id:"vulnerabilities/web/path-traversal/README",title:"Path Traversal",description:"A Path traversal attack, also known as directory traversal aims to access files and directories that are outside the web root folder.",source:"@site/docs/vulnerabilities/web/path-traversal/README.md",sourceDirName:"vulnerabilities/web/path-traversal",slug:"/vulnerabilities/web/path-traversal/",permalink:"/cybersecurity-handbook/vulnerabilities/web/path-traversal/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Parameter Tampering",permalink:"/cybersecurity-handbook/vulnerabilities/web/parameter-tampering/"},next:{title:"SQL Injection",permalink:"/cybersecurity-handbook/vulnerabilities/web/sql-injection/"}},o={},c=[{value:"Other Names",id:"other-names",level:2},{value:"Impact",id:"impact",level:2},{value:"Identifying",id:"identifying",level:2},{value:"Mitigation",id:"mitigation",level:2},{value:"Testing",id:"testing",level:2},{value:"Black-Box testing",id:"black-box-testing",level:4},{value:"Gray-Box testing",id:"gray-box-testing",level:4},{value:"Tools",id:"tools",level:2}];function d(e){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h1,{id:"path-traversal",children:"Path Traversal"}),"\n",(0,t.jsxs)(i.p,{children:["A Path traversal attack, also known as ",(0,t.jsx)(i.em,{children:"directory traversal"})," aims to ",(0,t.jsx)(i.strong,{children:"access files and directories that are outside the web root folder"}),"."]}),"\n",(0,t.jsxs)(i.p,{children:["By manipulating variables that reference file wit ",(0,t.jsx)(i.code,{children:"../"})," sequences and its variations, or by using absolute file pahs, it may be possible to access arbitrary files and directories stored on file system including applicatino source code, or configuration and critical system files."]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"https://owasp.org/www-community/attacks/Path_Traversal",children:"OWASP: Path Traversal"})}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"other-names",children:"Other Names"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Directory traversal"}),"\n",(0,t.jsx)(i.li,{children:"Directory climbing"}),"\n",(0,t.jsx)(i.li,{children:"Backtracking"}),"\n",(0,t.jsx)(i.li,{children:"dot-dot-slash"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"impact",children:"Impact"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Source Code Disclosure"}),"\n",(0,t.jsx)(i.li,{children:"Critical file found"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"identifying",children:"Identifying"}),"\n",(0,t.jsx)(i.p,{children:"You need to understand how the underlying operating system will process filenames handed off to it."}),"\n",(0,t.jsx)(i.p,{children:"Sensitive configuraton files should not be stored inside the web root."}),"\n",(0,t.jsx)(i.p,{children:"For Windows IIS servers, web root should ont be on the system disk, to prevent recursive raversal back to system directories."}),"\n",(0,t.jsx)(i.h2,{id:"mitigation",children:"Mitigation"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Prefer working without uer input when using file system calls."}),"\n",(0,t.jsx)(i.li,{children:"Uses indexes rather than actual portions of file names when templating or using language files."}),"\n",(0,t.jsx)(i.li,{children:"Ensure user cannot supply all parts of the path."}),"\n",(0,t.jsx)(i.li,{children:"Validate user's input by noly accepting known good."}),"\n",(0,t.jsx)(i.li,{children:"Use chrooted jails and code access policies to restrit where the files can be obtainer or saved to."}),"\n",(0,t.jsx)(i.li,{children:"If forced to use user input for file operations, normalize the input before using in file io API's."}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"testing",children:"Testing"}),"\n",(0,t.jsxs)(i.p,{children:["Please refer to ",(0,t.jsx)(i.a,{href:"https://github.com/OWASP/wstg/tree/master/document",children:"OWASP Testing Guide"})]}),"\n",(0,t.jsx)(i.h4,{id:"black-box-testing",children:"Black-Box testing"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"Enumarte all parts of the application that accept content from the user. This also includes HTTP GET and POST queries and common options like file uploads and HTML forms."}),"\n",(0,t.jsx)(i.li,{children:"Are there any parameter which could be user for file-related operations."}),"\n",(0,t.jsx)(i.li,{children:"Analyze input validation functions."}),"\n"]}),"\n",(0,t.jsx)(i.h4,{id:"gray-box-testing",children:"Gray-Box testing"}),"\n",(0,t.jsxs)(i.p,{children:["In this scenario, you can review the source code. It is possible to search the ",(0,t.jsx)(i.em,{children:"input vectors"})," more easily and accurately."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"PHP: include(), include_once(), require(), require_once(), fopen(), readfile(), ...\nJSP/Servlet: java.io.File(), java.io.FileReader(), ...\nASP: include file, include virtual, ...\n"})}),"\n",(0,t.jsx)(i.p,{children:"Additionaly, by reviewing the source code it is possible to analyze the functions that are supposed to handle invalid input: some developers try to change invalid input ot make it valid, avoiding warnings and errors. These functions are usually prone to security flaws."}),"\n",(0,t.jsx)(i.p,{children:"Consider the following instructions:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"filename = Request.QueryString(\u201cfile\u201d);\nReplace(filename, \u201c/\u201d,\u201d\\\u201d);\nReplace(filename, \u201c..\\\u201d,\u201d\u201d);\n"})}),"\n",(0,t.jsx)(i.p,{children:"Testing for flaw is achieved by:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"file=....//....//boot.ini\nfile=....\\\\....\\\\boot.ini\nfile= ..\\..\\boot.ini\n"})}),"\n",(0,t.jsx)(i.h2,{id:"tools",children:"Tools"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"https://github.com/wireghoul/dotdotpwn",children:"DotDotPwn"})}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.a)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},1151:(e,i,n)=>{n.d(i,{Z:()=>a,a:()=>l});var t=n(7294);const r={},s=t.createContext(r);function l(e){const i=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);