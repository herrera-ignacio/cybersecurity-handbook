"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[624],{838:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var r=s(5893),i=s(1151);const t={},o="Wordpress enumeration",l={id:"offensive-security/wordpress/enumeration/README",title:"Wordpress enumeration",description:"- Wordpress enumeration",source:"@site/docs/offensive-security/wordpress/enumeration/README.md",sourceDirName:"offensive-security/wordpress/enumeration",slug:"/offensive-security/wordpress/enumeration/",permalink:"/cybersecurity-handbook/offensive-security/wordpress/enumeration/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Wordpress basics",permalink:"/cybersecurity-handbook/offensive-security/wordpress/basics/"},next:{title:"Exploitation",permalink:"/cybersecurity-handbook/offensive-security/wordpress/exploitation/"}},a={},c=[{value:"Core version",id:"core-version",level:2},{value:"Plugins and themes",id:"plugins-and-themes",level:2},{value:"Directory indexing",id:"directory-indexing",level:2},{value:"Users",id:"users",level:2},{value:"Login",id:"login",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"wordpress-enumeration",children:"Wordpress enumeration"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#wordpress-enumeration",children:"Wordpress enumeration"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#core-version",children:"Core version"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#plugins-and-themes",children:"Plugins and themes"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#directory-indexing",children:"Directory indexing"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#users",children:"Users"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#login",children:"Login"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"core-version",children:"Core version"}),"\n",(0,r.jsxs)(n.p,{children:["The first and easiest step is reviewing the page source code. Search for ",(0,r.jsx)(n.code,{children:"meta generator"})," tag."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'...SNIP...\n<link rel=\'https://api.w.org/\' href=\'http://blog.inlanefreight.com/index.php/wp-json/\' />\n<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://blog.inlanefreight.com/xmlrpc.php?rsd" />\n<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://blog.inlanefreight.com/wp-includes/wlwmanifest.xml" /> \n<meta name="generator" content="WordPress 5.3.3" />\n...SNIP...\n'})}),"\n",(0,r.jsxs)(n.p,{children:["You can also use ",(0,r.jsx)(n.code,{children:"curl"})," and ",(0,r.jsx)(n.code,{children:"grep"})," for this task:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:'$ curl -s -X GET http://blog.inlanefreight.com | grep \'<meta name="generator"\'\n\n<meta name="generator" content="WordPress 5.3.3" />\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["In older WordPress versions, another source of uncovering version information is the ",(0,r.jsx)(n.code,{children:"readme.html"})," file in WordPress' root directory."]})}),"\n",(0,r.jsx)(n.h2,{id:"plugins-and-themes",children:"Plugins and themes"}),"\n",(0,r.jsxs)(n.p,{children:["You can manually inspect the page source or filter the information using ",(0,r.jsx)(n.code,{children:"curl"})," and other tools."]}),"\n",(0,r.jsxs)(n.p,{children:["For example, for ",(0,r.jsx)(n.em,{children:"plugins"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"$ curl -s -X GET http://blog.inlanefreight.com | sed 's/href=/\\n/g' | sed 's/src=/\\n/g' | grep 'wp-content/plugins/*' | cut -d\"'\" -f2\n\nhttp://blog.inlanefreight.com/wp-content/plugins/wp-google-places-review-slider/public/css/wprev-public_combine.css?ver=6.1\nhttp://blog.inlanefreight.com/wp-content/plugins/mail-masta/lib/subscriber.js?ver=5.3.3\nhttp://blog.inlanefreight.com/wp-content/plugins/mail-masta/lib/jquery.validationEngine-en.js?ver=5.3.3\nhttp://blog.inlanefreight.com/wp-content/plugins/mail-masta/lib/jquery.validationEngine.js?ver=5.3.3\nhttp://blog.inlanefreight.com/wp-content/plugins/wp-google-places-review-slider/public/js/wprev-public-com-min.js?ver=6.1\nhttp://blog.inlanefreight.com/wp-content/plugins/mail-masta/lib/css/mm_frontend.css?ver=5.3.3\n"})}),"\n",(0,r.jsxs)(n.p,{children:["And for ",(0,r.jsx)(n.em,{children:"themes"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"$ curl -s -X GET http://blog.inlanefreight.com | sed 's/href=/\\n/g' | sed 's/src=/\\n/g' | grep 'themes' | cut -d\"'\" -f2\n\nhttp://blog.inlanefreight.com/wp-content/themes/ben_theme/css/bootstrap.css?ver=5.3.3\nhttp://blog.inlanefreight.com/wp-content/themes/ben_theme/style.css?ver=5.3.3\nhttp://blog.inlanefreight.com/wp-content/themes/ben_theme/css/colors/default.css?ver=5.3.3\n"})}),"\n",(0,r.jsx)(n.p,{children:"Nevertheless, not all installed plugins and themes can be discovered passively. We might have to send requests to the server actively to enumerate them."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"$ curl -I -X GET http://blog.inlanefreight.com/wp-content/plugins/mail-masta\n\nHTTP/1.1 301 Moved Permanently\nDate: Wed, 13 May 2020 20:08:23 GMT\nServer: Apache/2.4.29 (Ubuntu)\nLocation: http://blog.inlanefreight.com/wp-content/plugins/mail-masta/\nContent-Length: 356\nContent-Type: text/html; charset=iso-8859-1\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["You can use tools like ",(0,r.jsx)(n.code,{children:"wfuzz"})," or ",(0,r.jsx)(n.code,{children:"WPScan"}),", which automate the process."]})}),"\n",(0,r.jsx)(n.h2,{id:"directory-indexing",children:"Directory indexing"}),"\n",(0,r.jsx)(n.p,{children:"Even if a plugin is deactivated, it may still be accessible, and therefore we can gain access to its associated scripts and functions."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"$ curl -s -X GET http://blog.inlanefreight.com/wp-content/plugins/mail-masta/ | html2text\n\n****** Index of /wp-content/plugins/mail-masta ******\n[[ICO]]       Name                 Last_modified    Size Description\n===========================================================================\n[[PARENTDIR]] Parent_Directory                         -  \n[[DIR]]       amazon_api/          2020-05-13 18:01    -  \n[[DIR]]       inc/                 2020-05-13 18:01    -  \n[[DIR]]       lib/                 2020-05-13 18:01    -  \n[[   ]]       plugin-interface.php 2020-05-13 18:01  88K  \n[[TXT]]       readme.txt           2020-05-13 18:01 2.2K  \n===========================================================================\n     Apache/2.4.29 (Ubuntu) Server at blog.inlanefreight.com Port 80\n"})}),"\n",(0,r.jsx)(n.h2,{id:"users",children:"Users"}),"\n",(0,r.jsx)(n.p,{children:"Before version 4.7.1, all users who had published a post could be listed:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:"curl http://<TARGET>/wp-json/wp/v2/users | j\n"})}),"\n",(0,r.jsx)(n.h3,{id:"login",children:"Login"}),"\n",(0,r.jsxs)(n.p,{children:["Once we are armed with a list of valid users, we can mount a password brute-forcing attack to attempt to gain access to the WordPress backend. This can be performed via the login page or the ",(0,r.jsx)(n.code,{children:"xmlrpc.php"})," page."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-console",children:'curl -X POST -d "<methodCall><methodName>wp.getUsersBlogs</methodName><params><param><value>admin</value></param><param><value>CORRECT-PASSWORD</value></param></params></methodCall>" http://blog.inlanefreight.com/xmlrpc.php\n'})}),"\n",(0,r.jsxs)(n.p,{children:["If credentials are not valid, we'll get a ",(0,r.jsx)(n.code,{children:"403 faultCode"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>l,a:()=>o});var r=s(7294);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);