"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3468],{9394:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>a});var n=i(5893),r=i(1151);const s={},o="CSP - Content Security Policy",c={id:"networking/specs/csp/README",title:"CSP - Content Security Policy",description:"CSP is an added layer of security that helps to detect and mitigte certain types of attacks, including XSS and Data Injection attacks.",source:"@site/docs/networking/specs/csp/README.md",sourceDirName:"networking/specs/csp",slug:"/networking/specs/csp/",permalink:"/cybersecurity-handbook/networking/specs/csp/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"CORS - Cross-Origin Resource Sharing",permalink:"/cybersecurity-handbook/networking/specs/cors/"},next:{title:"DOM - Document Object Model",permalink:"/cybersecurity-handbook/networking/specs/dom/"}},l={},a=[{value:"Using CSP",id:"using-csp",level:2},{value:"Specifying your Policy",id:"specifying-your-policy",level:4},{value:"Writing a Policy",id:"writing-a-policy",level:4},{value:"Reporting",id:"reporting",level:2},{value:"Examples, and directives",id:"examples-and-directives",level:2},{value:"Threats Mitigation",id:"threats-mitigation",level:2},{value:"XSS",id:"xss",level:4},{value:"Packet Sniffing Attacks",id:"packet-sniffing-attacks",level:4}];function d(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"csp---content-security-policy",children:"CSP - Content Security Policy"}),"\n",(0,n.jsx)(t.p,{children:"CSP is an added layer of security that helps to detect and mitigte certain types of attacks, including XSS and Data Injection attacks."}),"\n",(0,n.jsx)(t.p,{children:"Browsers than don't support it, function as usual, defualting to the standard SOP for web content."}),"\n",(0,n.jsxs)(t.p,{children:["To enable CSP, you need to configure your web server to retrn the ",(0,n.jsx)(t.code,{children:"Content-Security-Policy"})," HTTP header (often mentioned as the older version ",(0,n.jsx)(t.code,{children:"X-Content-Security-Policy"}),")."]}),"\n",(0,n.jsxs)(t.p,{children:["Alternatively the ",(0,n.jsx)(t.code,{children:"<meta>"})," element can be used to configure a policy:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-html",children:"<meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; img-src https://*; child-src 'none';\">\n"})}),"\n",(0,n.jsx)(t.h2,{id:"using-csp",children:"Using CSP"}),"\n",(0,n.jsxs)(t.p,{children:["Involves adding ",(0,n.jsx)(t.code,{children:"Content-Security-Policy"})," HTTP header to a web page and giving it values to control resources the User Agent is allowed to load for that page."]}),"\n",(0,n.jsx)(t.p,{children:"For example, a page that uploads and displays images could allow images from anywhere, but restrict a form action to a specific endpoint."}),"\n",(0,n.jsx)(t.h4,{id:"specifying-your-policy",children:"Specifying your Policy"}),"\n",(0,n.jsx)(t.p,{children:"A Policy is a string containing the policy directives describing your CSP."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"Content-Security-Policy: policy\n"})}),"\n",(0,n.jsx)(t.h4,{id:"writing-a-policy",children:"Writing a Policy"}),"\n",(0,n.jsxs)(t.p,{children:["A Policy is described using a series of ",(0,n.jsx)(t.em,{children:"policy directives"}),", each of which describes the policy for a certain resource type or policy area."]}),"\n",(0,n.jsxs)(t.p,{children:["It should include a ",(0,n.jsx)(t.code,{children:"default-src"})," policy directive, which is a fallback for other resource types when they don't have policies of their own."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"default-src"})," or ",(0,n.jsx)(t.code,{children:"script-src"})," directive are needed to:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"prevent inline scripts from running"}),"\n",(0,n.jsxs)(t.li,{children:["block use of ",(0,n.jsx)(t.code,{children:"eval()"})]}),"\n",(0,n.jsxs)(t.li,{children:["restrict inline styles from being applied from a ",(0,n.jsx)(t.code,{children:"<style>"})," element or a ",(0,n.jsx)(t.code,{children:"style"})," attribute"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"reporting",children:"Reporting"}),"\n",(0,n.jsxs)(t.p,{children:["By default, violation reports aren't sent. You can enable violation reporting, by specifying the ",(0,n.jsx)(t.code,{children:"report-uri"})," policy directive, providing at least one URI to which to deliver the reports and set up your server to receive the reports (store/process)"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"Content-Security-Policy: default-src 'self'; report-uri http://reportcollector.example.com/collector.cgi\n"})}),"\n",(0,n.jsx)(t.h2,{id:"examples-and-directives",children:"Examples, and directives"}),"\n",(0,n.jsxs)(t.p,{children:["Please check the ",(0,n.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP",children:"MDN Documentation on CSP"})," to see all possible ",(0,n.jsx)(t.em,{children:"policy directives"})," and usage examples."]}),"\n",(0,n.jsx)(t.h2,{id:"threats-mitigation",children:"Threats Mitigation"}),"\n",(0,n.jsx)(t.h4,{id:"xss",children:"XSS"}),"\n",(0,n.jsx)(t.p,{children:"Primary goal of CSP is to mitigate and report XSS attacks, which exploit the browser's trust of the content received from the server."}),"\n",(0,n.jsx)(t.p,{children:"CSP allows to specify the domains that the browser should consider to be valid sources of executable scripts. A CSP compatible browser will then only execute scripts loaded in source files received from those whitelisted domains, ignoring all other scripts (including inline and event-handling html attributes)."}),"\n",(0,n.jsx)(t.p,{children:"As an ultimate form of protection, sites that want to never allow sripts to be executed can opt to globally disallow script execution."}),"\n",(0,n.jsx)(t.h4,{id:"packet-sniffing-attacks",children:"Packet Sniffing Attacks"}),"\n",(0,n.jsx)(t.p,{children:"Server can specify which protocols are allowed to be user, for example, a sever can specify that all content must be loaded using HTTPS."}),"\n",(0,n.jsx)(t.p,{children:"A complete data transmission security strategy includes not only enforcing HTTPS for data transfer, but also marking all cookies with the secure flag, and providing automatic redirects from HTTP pages to their HTTPS counterparts."}),"\n",(0,n.jsxs)(t.p,{children:["Sites may also use the ",(0,n.jsx)(t.code,{children:"Strict-Transport-Security"})," HTTP header to ensure that browsers connect to them only over an encrypted channel."]})]})}function h(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},1151:(e,t,i)=>{i.d(t,{Z:()=>c,a:()=>o});var n=i(7294);const r={},s=n.createContext(r);function o(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);