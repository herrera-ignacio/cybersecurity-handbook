"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7794],{2501:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var n=i(5893),r=i(1151);const a={},s="URL Redirection",o={id:"vulnerabilities/web/url-redirection/README",title:"URL Redirection",description:"Unvalidated redirects and forwards are possible when a web application accepts untrusted input that could cause the web application to redirect the request to a URL contained within untrusted input.",source:"@site/docs/vulnerabilities/web/url-redirection/README.md",sourceDirName:"vulnerabilities/web/url-redirection",slug:"/vulnerabilities/web/url-redirection/",permalink:"/cybersecurity-handbook/vulnerabilities/web/url-redirection/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Unchecked Redirects",permalink:"/cybersecurity-handbook/vulnerabilities/web/unchecked-redirects/"},next:{title:"1. XSS: Cross-Site Scripting",permalink:"/cybersecurity-handbook/vulnerabilities/web/xss/"}},c={},l=[{value:"Dangerous Forwards",id:"dangerous-forwards",level:2},{value:"Mitigation",id:"mitigation",level:2}];function d(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"url-redirection",children:"URL Redirection"}),"\n",(0,n.jsx)(t.p,{children:"Unvalidated redirects and forwards are possible when a web application accepts untrusted input that could cause the web application to redirect the request to a URL contained within untrusted input."}),"\n",(0,n.jsxs)(t.p,{children:["By modifying untrusted URL input to a malicious site, an attacker may succesfully launch a ",(0,n.jsx)(t.em,{children:"Phishing"})," scam and steal user credentials."]}),"\n",(0,n.jsx)(t.p,{children:"Because the server name in the modified link is identical to the original site, phishing attempts may have a more trustworthy appearence."}),"\n",(0,n.jsx)(t.p,{children:"Unvalidated redirect and forward attacks can also be used to maliciously craft a URL that would pass the application's access control check and then forward the attacker to privileged functions that they would normally not be able to access."}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html",children:"OWASP: Unvalidated Redirects and Forwards"})}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"dangerous-forwards",children:"Dangerous Forwards"}),"\n",(0,n.jsx)(t.p,{children:"When applications allow user input to forward requests between different parts of the site, the application must check that the user is authorized to access the URL, perform the functions it provides, and it is an appropriate URL request."}),"\n",(0,n.jsx)(t.p,{children:"If applications fails to perform these checks, an attacker crafted URL may pass the application's access control check and then forward the attacker to an administrative function that is not normally permitted."}),"\n",(0,n.jsx)(t.p,{children:"Example:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"http://www.example.com/function.jsp?fwd=admin.jsp\n"})}),"\n",(0,n.jsx)(t.h2,{id:"mitigation",children:"Mitigation"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Simply avoid using redirects and forwards."}),"\n",(0,n.jsx)(t.li,{children:"If used, do not allow the URL as user input for the destination."}),"\n",(0,n.jsxs)(t.li,{children:["Where possible, have the user provide short name, ID or token which is mapped server-side to a full target URL.","\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"This provides the highest degree of protection against the attack tampering with the URL."}),"\n",(0,n.jsx)(t.li,{children:"Be careful that this doesn't introduce an enumeration vulnerability where a user could cycle through IDs to find all possible redirect targets"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.li,{children:"If user input can\u2019t be avoided, ensure that the supplied value is valid, appropriate for the application, and is authorized for the user."}),"\n",(0,n.jsxs)(t.li,{children:["Sanitize input by creating a list of trusted URLs (lists of hosts or a regex).","\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"This should be based on a white-list approach, rather than a blacklist."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.li,{children:"Force all redirects to first go through a page notifying users that they are going off of your site, with the destination clearly displayed, and have them click a link to confirm."}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},1151:(e,t,i)=>{i.d(t,{Z:()=>o,a:()=>s});var n=i(7294);const r={},a=n.createContext(r);function s(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);