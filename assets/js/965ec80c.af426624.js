"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2653],{5784:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var s=t(5893),i=t(1151);const o={},r="Networking",a={id:"os/linux/networking/README",title:"Networking",description:"Configuring network interfaces",source:"@site/docs/os/linux/networking/README.md",sourceDirName:"os/linux/networking",slug:"/os/linux/networking/",permalink:"/cybersecurity-handbook/os/linux/networking/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Linux hardening",permalink:"/cybersecurity-handbook/os/linux/hardening/"},next:{title:"Permission management",permalink:"/cybersecurity-handbook/os/linux/permission_management/"}},c={},d=[{value:"Configuring network interfaces",id:"configuring-network-interfaces",level:2},{value:"Activate network interfaces",id:"activate-network-interfaces",level:3},{value:"Assign IP address",id:"assign-ip-address",level:3},{value:"Assign a netmask",id:"assign-a-netmask",level:3},{value:"Assign a route to an interface",id:"assign-a-route-to-an-interface",level:3},{value:"Edit interfaces",id:"edit-interfaces",level:3},{value:"Edit DNS settings",id:"edit-dns-settings",level:2},{value:"Restart networking service",id:"restart-networking-service",level:2},{value:"Network Access Control (NAC)",id:"network-access-control-nac",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Ping",id:"ping",level:3},{value:"Traceroute",id:"traceroute",level:3},{value:"Netstat",id:"netstat",level:3},{value:"Remote desktop protocols",id:"remote-desktop-protocols",level:2},{value:"XServer",id:"xserver",level:3},{value:"X11Forwarding",id:"x11forwarding",level:4},{value:"X11 Security",id:"x11-security",level:4},{value:"XDMCP",id:"xdmcp",level:3},{value:"VNC",id:"vnc",level:3}];function l(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"networking",children:"Networking"}),"\n",(0,s.jsx)(n.h2,{id:"configuring-network-interfaces",children:"Configuring network interfaces"}),"\n",(0,s.jsxs)(n.p,{children:["You can configure local network interfaces using the ",(0,s.jsx)(n.code,{children:"ifconfig"})," or the ",(0,s.jsx)(n.code,{children:"ip"})," command. Also, you can obtain information regarding network interfaces, such as IP addresses, netmasks, and status, by using ",(0,s.jsx)(n.code,{children:"ifconfig"}),"."]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["In newer versions of Linux, ",(0,s.jsx)(n.code,{children:"ifconfig"})," has been deprecated and replaced by the ",(0,s.jsx)(n.code,{children:"ip"})," command, which offers more advanced features."]})}),"\n",(0,s.jsx)(n.h3,{id:"activate-network-interfaces",children:"Activate network interfaces"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"sudo ifconfig eth0 up     # OR\nsudo ip link set eth0 up\n"})}),"\n",(0,s.jsx)(n.h3,{id:"assign-ip-address",children:"Assign IP address"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"sudo ifconfig eth0 192.168.1.2\n"})}),"\n",(0,s.jsx)(n.h3,{id:"assign-a-netmask",children:"Assign a netmask"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"sudo ifconfig eth0 netmask 255.255.255.0\n"})}),"\n",(0,s.jsx)(n.h3,{id:"assign-a-route-to-an-interface",children:"Assign a route to an interface"}),"\n",(0,s.jsxs)(n.p,{children:["When we want to set the default gateway for a network interface, you can use ",(0,s.jsx)(n.code,{children:"route"})," with the ",(0,s.jsx)(n.code,{children:"add"})," option."]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"By setting the default gateway, we are designating the IP address of the router that will be used to send traffic to destinations outside the local network."})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"sudo route add default gw 192.168.1.1 eth0\n"})}),"\n",(0,s.jsx)(n.h3,{id:"edit-interfaces",children:"Edit interfaces"}),"\n",(0,s.jsxs)(n.p,{children:["You can add network configuration settings in the ",(0,s.jsx)(n.code,{children:"/etc/network/interfaces"})," file."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-txt",children:"auto eth0\niface eth0 inet static\n  address 192.168.1.2\n  netmask 255.255.255.0\n  gateway 192.168.1.1\n  dns-nameservers 8.8.8.8 8.8.4.4\n"})}),"\n",(0,s.jsx)(n.h2,{id:"edit-dns-settings",children:"Edit DNS settings"}),"\n",(0,s.jsxs)(n.p,{children:["The file ",(0,s.jsx)(n.code,{children:"/etc/resolv.conf"})," is a plain text file containing the system's DNS information:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"nameserver 8.8.8.8\nnameserver 8.8.4.4\n"})}),"\n",(0,s.jsx)(n.h2,{id:"restart-networking-service",children:"Restart networking service"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"sudo systemctl restart networking\n"})}),"\n",(0,s.jsx)(n.h2,{id:"network-access-control-nac",children:"Network Access Control (NAC)"}),"\n",(0,s.jsx)(n.p,{children:"NAC is a security system that ensures that only authorized and compliant devices are granted access to the network. The following are different NAC technologies:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Discretionary access control (DAC)"}),"\n",(0,s.jsx)(n.li,{children:"Mandatory access control (MAC)"}),"\n",(0,s.jsx)(n.li,{children:"Role-based access control (RBAC)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"ping",children:"Ping"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"$ ping 8.8.8.8\n\nPING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.\n64 bytes from 8.8.8.8: icmp_seq=1 ttl=119 time=1.61 ms\n64 bytes from 8.8.8.8: icmp_seq=2 ttl=119 time=1.06 ms\n64 bytes from 8.8.8.8: icmp_seq=3 ttl=119 time=0.636 ms\n64 bytes from 8.8.8.8: icmp_seq=4 ttl=119 time=0.685 ms\n^C\n--- 8.8.8.8 ping statistics ---\n4 packets transmitted, 4 received, 0% packet loss, time 3017ms\nrtt min/avg/max/mdev = 0.636/0.996/1.607/0.388 ms\n"})}),"\n",(0,s.jsx)(n.h3,{id:"traceroute",children:"Traceroute"}),"\n",(0,s.jsx)(n.p,{children:"It traces the route packets take to reach a remote host."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"$ traceroute www.inlanefreight.com\n\ntraceroute to www.inlanefreight.com (134.209.24.248), 30 hops max, 60 byte packets\n 1  * * *\n 2  10.80.71.5 (10.80.71.5)  2.716 ms  2.700 ms  2.730 ms\n 3  * * *\n 4  10.80.68.175 (10.80.68.175)  7.147 ms  7.132 ms 10.80.68.161 (10.80.68.161)  7.393 ms\n"})}),"\n",(0,s.jsx)(n.h3,{id:"netstat",children:"Netstat"}),"\n",(0,s.jsx)(n.p,{children:"It's used to display active network connections and their associated ports."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"$ netstat -a\n\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address           Foreign Address         State      \ntcp        0      0 localhost:5901          0.0.0.0:*               LISTEN     \ntcp        0      0 0.0.0.0:sunrpc          0.0.0.0:*               LISTEN     \ntcp        0      0 0.0.0.0:http            0.0.0.0:*               LISTEN     \ntcp        0      0 0.0.0.0:ssh             0.0.0.0:*               LISTEN\n...SNIP...\n"})}),"\n",(0,s.jsx)(n.h2,{id:"remote-desktop-protocols",children:"Remote desktop protocols"}),"\n",(0,s.jsx)(n.h3,{id:"xserver",children:"XServer"}),"\n",(0,s.jsxs)(n.p,{children:["The XServer is the user-side part of the ",(0,s.jsx)(n.code,{children:"X Window System network protocol"})," (",(0,s.jsx)(n.code,{children:"X11"}),"/",(0,s.jsx)(n.code,{children:"X"}),"). The ",(0,s.jsx)(n.code,{children:"X11"})," is a fixed system that consists of a collection of protocols and applications that allow us to call application windows on displays in a GUI."]}),"\n",(0,s.jsx)(n.p,{children:"When a desktop is started on a Linux computer, the communication of the GUI with the OS happens via an X server. The computer's internal network is used, even if the computer should not be in a network."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["X protocol has ",(0,s.jsx)(n.em,{children:"network transparency"}),". This protocol mainly uses TCP/IP as a transport base but can also be used on pure Unix sockets. The ports utilized are typically located in the range of ",(0,s.jsx)(n.code,{children:"TCP/6001-6009"}),", allowing communication between the client and server. Starting a new desktop session via X server, the TCP port 6000 would be opened for the first X display ",(0,s.jsx)(n.code,{children:":0"}),"."]})}),"\n",(0,s.jsx)(n.p,{children:"An X server is not dependent on the local computer, it can be used to access other computers, and other computers can use the local X server. VNC and RDP protocols generate the graphical output on the remote computer and transport it over the network. Whereas with X11, it is rendered on the local computer. This saves traffic and a load on the reomte computer."}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsxs)(n.p,{children:["X11's significant disadvantage is the unencrypted data transmission. However, it can be overcome by tunneling the SSH protocol. For this, we have to allow X11 forwarding in the SSH configuration file (",(0,s.jsx)(n.code,{children:"/etc/ssh/sshd_config"}),") on the server that provides the application by changing the ",(0,s.jsx)(n.code,{children:"X11Forwarding"})," option to ",(0,s.jsx)(n.code,{children:"yes"}),"."]})}),"\n",(0,s.jsx)(n.h4,{id:"x11forwarding",children:"X11Forwarding"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"$ cat /etc/ssh/sshd_config | grep X11Forwarding\n\nX11Forwarding yes\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then, we can start an application from our client with the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"$ ssh -X htb-student@10.129.23.11 /usr/bin/firefox\n\nhtb-student@10.129.14.130's password: *******\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"x11forwarding",src:t(4112).Z+"",width:"918",height:"450"})}),"\n",(0,s.jsx)(n.h4,{id:"x11-security",children:"X11 Security"}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsxs)(n.p,{children:["X11 is not a secure protocol since its communication is entirely unencrypted. A completely open X server lets anyone on the network read the contents of its windows and it's not even necessary to sniff the network. This is realized with simple X11 tools like ",(0,s.jsx)(n.code,{children:"xwd"})," and ",(0,s.jsx)(n.code,{children:"xgrabsc"}),". We could read user's keystrokes, obtain screenshots, move the mouse cursor, and send keystrokes from the server over the network. For example, the following vulnerabilities: CVE-2017-2624, CVE-2017-2625, and CVE-2017-2626."]})}),"\n",(0,s.jsx)(n.h3,{id:"xdmcp",children:"XDMCP"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"X Display Manager Control Protocol"})," (",(0,s.jsx)(n.code,{children:"XDMPC"}),") is used by the ",(0,s.jsx)(n.code,{children:"X Display Manager"})," for communication through ",(0,s.jsx)(n.code,{children:"UDP port 177"})," between X terminals and computers operating under Unix/Linux."]}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"XDMCP is an insecure protocol. One potential way to exploit XDMCP could be MITM attacks."})}),"\n",(0,s.jsx)(n.h3,{id:"vnc",children:"VNC"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Virtual Network Computing"})," (",(0,s.jsx)(n.code,{children:"VNC"}),") is a remote desktop sharing system based on the RFB protocol thaat allows users to control a computer remotly. It allows a user to view and interact with a desktop environment remotely over a netwrok."]}),"\n",(0,s.jsxs)(n.p,{children:["VNC is considered to be ",(0,s.jsx)(n.em,{children:"secure"}),". It uses encryption in transit and requires authentication before a user can gain access."]}),"\n",(0,s.jsx)(n.p,{children:"The usual server offers the actual screen of the host computer for user support . The second group of server programs allows users to login to virtual sessions."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["Traditionally, the VNC server listens on ",(0,s.jsx)(n.code,{children:"TCP port 5900"})," and offers its ",(0,s.jsx)(n.code,{children:"display 0"})," there. Other displays can be offered via additional ports, mostly ",(0,s.jsx)(n.code,{children:"590[x]"}),", where ",(0,s.jsx)(n.code,{children:"x"})," is the display number."]})}),"\n",(0,s.jsx)(n.p,{children:"To encrypt the connection and make it more secure, we can create an SSH tunnel over which the whole connection is tunneled:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-console",children:"# setup an ssh tunel\nssh -L 5901:127.0.0.1:5901 -N -f -l htb-student 10.129.14.130\n\n# connect to the vnc server with TigerVNC\nxtightvncviewer localhost:5901\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},4112:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/image-47f09001a98e3b4959fa7bb29074a1ba.png"},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>r});var s=t(7294);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);