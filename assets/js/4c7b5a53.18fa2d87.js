"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6833],{3261:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var i=t(5893),r=t(1151);const s={},a="SSRF: Server Side Request Forgery",o={id:"vulnerabilities/web/ssrf/README",title:"SSRF: Server Side Request Forgery",description:"Many web applications will take a URL from a user and so something with it.",source:"@site/docs/vulnerabilities/web/ssrf/README.md",sourceDirName:"vulnerabilities/web/ssrf",slug:"/vulnerabilities/web/ssrf/",permalink:"/cybersecurity-handbook/vulnerabilities/web/ssrf/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"SQL Map Cheatsheet",permalink:"/cybersecurity-handbook/vulnerabilities/web/sql-injection/sql-map"},next:{title:"Subdomain Takeover",permalink:"/cybersecurity-handbook/vulnerabilities/web/subdomain-takeover/"}},l={},c=[{value:"Example",id:"example",level:2},{value:"Port Scanning",id:"port-scanning",level:2},{value:"Hunting &amp; Difficulty",id:"hunting--difficulty",level:2},{value:"Impact",id:"impact",level:2},{value:"Mitigation",id:"mitigation",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"ssrf-server-side-request-forgery",children:"SSRF: Server Side Request Forgery"}),"\n",(0,i.jsx)(n.p,{children:"Many web applications will take a URL from a user and so something with it."}),"\n",(0,i.jsx)(n.p,{children:"SSRF refers to an attack where an attacker is able to send a crafter request from a vulnerable web application."}),"\n",(0,i.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.p,{children:"Imagine a reporting dasboard with the ability to poll a URI and pull in the CSV data that it returns. Every n minutes, it makes a web request and then updates your dashboard to show a fresh table."}),"\n",(0,i.jsxs)(n.p,{children:["What if you entered ",(0,i.jsx)(n.code,{children:"file:///etc/passwd"}),"?"]}),"\n",(0,i.jsxs)(n.p,{children:["What if you send ",(0,i.jsx)(n.code,{children:"http://localhost/admin/add_user?username=nacho&password=admin"}),"?"]}),"\n",(0,i.jsx)(n.p,{children:"Server could make requests to internal services for yu, things that you would never be able to ordinarily access due to firewall rules."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://hackerone.com/reports/223203",children:"Example report on hackerone"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"port-scanning",children:"Port Scanning"}),"\n",(0,i.jsx)(n.p,{children:"If you can control the port on which requests are made, you can pretty trivially do port scans of the internal network."}),"\n",(0,i.jsx)(n.h2,{id:"hunting--difficulty",children:"Hunting & Difficulty"}),"\n",(0,i.jsx)(n.p,{children:"SSRF bugs are simple in concept, but can be surprisingly difficult to find in practice. This is because they often require traversing many levels of indirection."}),"\n",(0,i.jsx)(n.p,{children:"You have to find any parameter that may have some kind of external interaction, such as external domains."}),"\n",(0,i.jsx)(n.h2,{id:"impact",children:"Impact"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Abuse trust e.g. RFI attack"}),"\n",(0,i.jsx)(n.li,{children:"Bypass ip whitelisting"}),"\n",(0,i.jsx)(n.li,{children:"Bypass host based authentication"}),"\n",(0,i.jsx)(n.li,{children:"Read resource"}),"\n",(0,i.jsx)(n.li,{children:"Scan internal network"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"mitigation",children:"Mitigation"}),"\n",(0,i.jsx)(n.p,{children:"There's no silver bullet for SSRF mitigation, but some combination of these can be effective:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Limit connections to only port 80/443 to prevent port scanning."}),"\n",(0,i.jsx)(n.li,{children:"Disable access to any protocol scheme that is not HTTP/S."}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>a});var i=t(7294);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);