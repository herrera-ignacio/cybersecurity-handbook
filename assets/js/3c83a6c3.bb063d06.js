"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9732],{1859:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>o});var t=n(5893),s=n(1151);const r={},l="1. XSS: Cross-Site Scripting",a={id:"vulnerabilities/web/xss/README",title:"1. XSS: Cross-Site Scripting",description:"XSS attacks enable attackers to inject client-side scripts into web pages viewed by other users.",source:"@site/docs/vulnerabilities/web/xss/README.md",sourceDirName:"vulnerabilities/web/xss",slug:"/vulnerabilities/web/xss/",permalink:"/cybersecurity-handbook/vulnerabilities/web/xss/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"URL Redirection",permalink:"/cybersecurity-handbook/vulnerabilities/web/url-redirection/"},next:{title:"XXE: XML External Entity Injection",permalink:"/cybersecurity-handbook/vulnerabilities/web/xxe/"}},c={},o=[{value:"1.1. Types",id:"11-types",level:2},{value:"1.1.0.1. Reflected (rXSS)",id:"1101-reflected-rxss",level:4},{value:"1.1.0.2. Stored/Persisted (sXSS)",id:"1102-storedpersisted-sxss",level:4},{value:"1.1.0.3. DOM",id:"1103-dom",level:4},{value:"1.2. Mitigation",id:"12-mitigation",level:2},{value:"1.3. Recognition checklist",id:"13-recognition-checklist",level:2},{value:"1.4. Exploitation",id:"14-exploitation",level:2},{value:"1.5. XSS Cheat Sheet",id:"15-xss-cheat-sheet",level:2},{value:"1.6. Examples",id:"16-examples",level:2},{value:"1.6.1. Attribute Tag example",id:"161-attribute-tag-example",level:3},{value:"1.6.2. Script Tag example",id:"162-script-tag-example",level:3},{value:"1.7. Interesting exploits",id:"17-interesting-exploits",level:2}];function d(e){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h1,{id:"1-xss-cross-site-scripting",children:"1. XSS: Cross-Site Scripting"}),"\n",(0,t.jsxs)(i.p,{children:["XSS attacks enable attackers to ",(0,t.jsx)(i.em,{children:"inject client-side scripts"})," into web pages viewed by other users."]}),"\n",(0,t.jsxs)(i.p,{children:["An XSS vunlerability may be used by attackers to ",(0,t.jsx)(i.strong,{children:"bypass access controls"})," such as SOP."]}),"\n",(0,t.jsx)(i.p,{children:"XSS effects vay from petty nuisance to significant security risk, dependending on the sensitivity of the data handled by the vulnerable site."}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"https://en.wikipedia.org/wiki/Cross-site_scripting",children:"XSS, Wikipedia article"})}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"11-types",children:"1.1. Types"}),"\n",(0,t.jsx)(i.h4,{id:"1101-reflected-rxss",children:"1.1.0.1. Reflected (rXSS)"}),"\n",(0,t.jsx)(i.p,{children:"Input from a user is directly returned to the browser, permitting injection of arbitrary content."}),"\n",(0,t.jsxs)(i.p,{children:["rXSS vulnerabilities are ",(0,t.jsx)(i.em,{children:"inherently dependent on CSRF"})," vulnerabilities to be exploitable, in the case of POSTs. If your rXSS exists just in a GET, it's probably secure."]}),"\n",(0,t.jsx)(i.h4,{id:"1102-storedpersisted-sxss",children:"1.1.0.2. Stored/Persisted (sXSS)"}),"\n",(0,t.jsx)(i.p,{children:"Input from a user is stored on the serer (often in a database) and returned later without proper escaping."}),"\n",(0,t.jsx)(i.h4,{id:"1103-dom",children:"1.1.0.3. DOM"}),"\n",(0,t.jsx)(i.p,{children:"Input from a user is inserted into the page's DOM without proper handling, enabling insertion of arbitrary nodes. Biggest different with rXSS and sXSS is that it doesn't depend on a server-side flaw, it only needs vulnerable JavaScript on the client-side."}),"\n",(0,t.jsx)(i.h2,{id:"12-mitigation",children:"1.2. Mitigation"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Unless there is ",(0,t.jsx)(i.em,{children:"absolutely"})," no other option, user-controlled input should not end up in a script tag or inside of an attribute for a DOM event."]}),"\n",(0,t.jsx)(i.li,{children:"Escape every dangerous character: angle brackets, quotes and backslashes."}),"\n",(0,t.jsxs)(i.li,{children:["DOM XSS has effectively an inifinite number of ways in which it can come about, each of which requiring different mitigations.","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.em,{children:"Avoid user-controlled data on the page"}),", maybe whitelist very specifig things through selectable options."]}),"\n",(0,t.jsx)(i.li,{children:"Embedding attacke data (eval, setTimeout, setInterval) requires string escaping/filtering"}),"\n",(0,t.jsx)(i.li,{children:"Embedding attacker data into tags and attributes requires HTLM encoding"}),"\n",(0,t.jsx)(i.li,{children:"Same goes for innerHTML"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"13-recognition-checklist",children:"1.3. Recognition checklist"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Figure out ",(0,t.jsx)(i.strong,{children:"where it goes"}),": Does it get embedded in a tag attribute or in a script tag?"]}),"\n",(0,t.jsxs)(i.li,{children:["Figure out ",(0,t.jsx)(i.strong,{children:"any special handling"}),": Do URLs get turned into links (",(0,t.jsx)(i.code,{children:"<a>"}),")?"]}),"\n",(0,t.jsxs)(i.li,{children:["Figure out how ",(0,t.jsx)(i.strong,{children:"special characters"})," are handled: A good way is too input something like ",(0,t.jsx)(i.code,{children:"<>:;"})]}),"\n"]}),"\n",(0,t.jsxs)(i.p,{children:["We usually want a simple payload to work, such as ",(0,t.jsx)(i.code,{children:"<script>alert(1);<\/script>"}),", then we can work further."]}),"\n",(0,t.jsx)(i.h2,{id:"14-exploitation",children:"1.4. Exploitation"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:["URL Redirection (",(0,t.jsx)(i.code,{children:"document.location.href"}),")"]}),"\n",(0,t.jsxs)(i.li,{children:["Phishing (insert ",(0,t.jsx)(i.code,{children:"iframe"}),")"]}),"\n",(0,t.jsxs)(i.li,{children:["Cookie stealing (",(0,t.jsx)(i.code,{children:"document.cookie"}),")"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"15-xss-cheat-sheet",children:"1.5. XSS Cheat Sheet"}),"\n",(0,t.jsx)(i.p,{children:"Couple quick things to try when testing for XSS:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:'"><h1>test</h1>'})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:"+alert(1)+"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:'"onmouseover="alert(1)'})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.code,{children:'http://"onmouseover="alert(1)'})}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"16-examples",children:"1.6. Examples"}),"\n",(0,t.jsx)(i.h3,{id:"161-attribute-tag-example",children:"1.6.1. Attribute Tag example"}),"\n",(0,t.jsxs)(i.p,{children:['Suppose a text link "Check out ',(0,t.jsx)(i.code,{children:"http://google.com"}),'" gets automatically parsed into ',(0,t.jsx)(i.code,{children:'Check out <a href="http://google.com">http://google.com</a>'}),", notice that wrapping ",(0,t.jsx)(i.code,{children:'"'})," did not get into the resulting output."]}),"\n",(0,t.jsxs)(i.p,{children:["We can trigger DOM events, for example: ",(0,t.jsx)(i.code,{children:'http://"onmouseover="alert(1);'}),", giving you: ",(0,t.jsx)(i.code,{children:'<a href="http://"onmouseover="alert(1);">'})]}),"\n",(0,t.jsx)(i.h3,{id:"162-script-tag-example",children:"1.6.2. Script Tag example"}),"\n",(0,t.jsx)(i.p,{children:"If for example, we are in the following scenario:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-html",children:"<script> var token = 'user input here';<\/script>\n"})}),"\n",(0,t.jsx)(i.p,{children:"Normally, HTML encoding does not mitigate this case, for two reasons:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"HTML entities won't be parsed in Javascript, meaning the input will simply be wrong."}),"\n",(0,t.jsx)(i.li,{children:"Single quotes are rarely encoded as HTML entities."}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Let's look what happens with certain payloads under HTML encoding and simple string escaping."}),"\n",(0,t.jsx)(i.p,{children:"This HTML encoded payload:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-html",children:"'; alert(1);'\n"})}),"\n",(0,t.jsx)(i.p,{children:"Results in a final script of:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-html",children:"<script> var token = ''; alert(1);'' <\/script>\n"})}),"\n",(0,t.jsx)(i.p,{children:"String escaped payload:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-html",children:"<\/script><script>alert(1);<\/script>\n"})}),"\n",(0,t.jsx)(i.p,{children:"Give us a final script of:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-html",children:"<script> var token = '<\/script><script>alert(1);<\/script>'; <\/script>\n"})}),"\n",(0,t.jsx)(i.h2,{id:"17-interesting-exploits",children:"1.7. Interesting exploits"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-js",children:"let script = document.createElement('script');\nscript.src = `http://another.com/weather.json?callback=gotWeather`;\ndocument.body.append(script);\n"})})]})}function h(e={}){const{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},1151:(e,i,n)=>{n.d(i,{Z:()=>a,a:()=>l});var t=n(7294);const s={},r=t.createContext(s);function l(e){const i=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:i},e.children)}}}]);