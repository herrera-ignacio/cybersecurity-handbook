"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1138],{1547:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>c});var s=i(5893),t=i(1151);const l={},r="Introduction of Vulnerability Management",a={id:"lectures/defensive/vuln-management-fundamentals/README",title:"Introduction of Vulnerability Management",description:"* Vulnerability Management Lifecycle",source:"@site/docs/lectures/defensive/vuln-management-fundamentals/README.md",sourceDirName:"lectures/defensive/vuln-management-fundamentals",slug:"/lectures/defensive/vuln-management-fundamentals/",permalink:"/cybersecurity-handbook/lectures/defensive/vuln-management-fundamentals/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Malware Threats",permalink:"/cybersecurity-handbook/lectures/defensive/malware-threats/"},next:{title:"Jason Haddix: How to Shot Web",permalink:"/cybersecurity-handbook/lectures/offensive/d23-how-to-shoot-web/"}},o={},c=[{value:"Vulnerability Management Lifecycle",id:"vulnerability-management-lifecycle",level:2},{value:"1. Baseline",id:"1-baseline",level:3},{value:"2. Vulnerability Assessment",id:"2-vulnerability-assessment",level:3},{value:"3. Risk Assessment",id:"3-risk-assessment",level:3},{value:"4. Remediation",id:"4-remediation",level:3},{value:"5. Verification",id:"5-verification",level:3},{value:"6. Monitoring",id:"6-monitoring",level:3},{value:"Vulnerability Assessment Tools",id:"vulnerability-assessment-tools",level:2},{value:"CVSS: Common Vulnerability Scoring System",id:"cvss-common-vulnerability-scoring-system",level:3},{value:"CVE: Common Vulnerabilities &amp; Exposures",id:"cve-common-vulnerabilities--exposures",level:3},{value:"NVD: National Vulnerability Database",id:"nvd-national-vulnerability-database",level:3},{value:"Assessment Tools",id:"assessment-tools",level:3},{value:"Vulnerability Identification",id:"vulnerability-identification",level:2},{value:"Kali Linux",id:"kali-linux",level:3},{value:"Manual Vulnerability Assessments",id:"manual-vulnerability-assessments",level:4},{value:"Windows",id:"windows",level:3},{value:"Host-specific report",id:"host-specific-report",level:4},{value:"In-Depth Scan",id:"in-depth-scan",level:4},{value:"Vulnerability Remediation",id:"vulnerability-remediation",level:2},{value:"Windows",id:"windows-1",level:3},{value:"Security Policy Editor",id:"security-policy-editor",level:4},{value:"Creating Recommendations Based on Vulnerability Assessments",id:"creating-recommendations-based-on-vulnerability-assessments",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"introduction-of-vulnerability-management",children:"Introduction of Vulnerability Management"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Vulnerability Management Lifecycle"}),"\n",(0,s.jsxs)(n.li,{children:["Vulenrability Assessment Tools","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CVSS"}),"\n",(0,s.jsx)(n.li,{children:"CVE"}),"\n",(0,s.jsx)(n.li,{children:"NVD"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Vulnerability Identification"}),"\n",(0,s.jsx)(n.li,{children:"Vulnerability Remediation"}),"\n",(0,s.jsx)(n.li,{children:"Creating Recommendations Based on Vulnerability Assessments"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"vulnerability-management-lifecycle",children:"Vulnerability Management Lifecycle"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Baseline"}),"\n",(0,s.jsx)(n.li,{children:"Vulnerability Assessment"}),"\n",(0,s.jsx)(n.li,{children:"Risk Assessment"}),"\n",(0,s.jsx)(n.li,{children:"Remediation"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1-baseline",children:"1. Baseline"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Understand the business processes, applications & services, which of them are criticial, and what technologies support those."}),"\n",(0,s.jsx)(n.li,{children:"Identify and prioritize assets."}),"\n",(0,s.jsx)(n.li,{children:"Identify controls and policies in place."}),"\n",(0,s.jsx)(n.li,{children:"Define the scope of the assessment so we are not touching/damaging things we shouldn't."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-vulnerability-assessment",children:"2. Vulnerability Assessment"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Physical security."}),"\n",(0,s.jsx)(n.li,{children:"Misconfigurations."}),"\n",(0,s.jsx)(n.li,{children:"Identify & prioritize vulnerabilities based on business."}),"\n",(0,s.jsx)(n.li,{children:"Intelligence to identify real world exploits of found vulnerabilities."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-risk-assessment",children:"3. Risk Assessment"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Given the found vulnerabilities, what is the potential impact? (shutdown, lose assets, data breach?)"}),"\n",(0,s.jsxs)(n.li,{children:["What kind of impact is more critical to the busines?","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"i.e, if we get attacked with a ransomware, but we periodically create backups, then the impact would be more bearable."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4-remediation",children:"4. Remediation"}),"\n",(0,s.jsx)(n.p,{children:"Recomendations to management/stakeholders to fix vulnerabilities."}),"\n",(0,s.jsx)(n.h3,{id:"5-verification",children:"5. Verification"}),"\n",(0,s.jsx)(n.p,{children:"Dynamical analysis and reviewing attack surfaces after remediation."}),"\n",(0,s.jsx)(n.h3,{id:"6-monitoring",children:"6. Monitoring"}),"\n",(0,s.jsx)(n.p,{children:"Implement some of the following:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Logs."}),"\n",(0,s.jsx)(n.li,{children:"Policies and procedures for controls."}),"\n",(0,s.jsx)(n.li,{children:"SOC"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"vulnerability-assessment-tools",children:"Vulnerability Assessment Tools"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Host-Based"}),": testing for known OS vulnerabilities."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Scope"}),": testing for known applications vulnerabilities."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Depth"}),": look for previously unknown vulnerabilities."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Application layer"}),"; focusing more on web servers, databases, specific technologies."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Active/Passive"}),": active scanners are actively checking for services consuming system resources, where as passive scanners don't have that much impact in system resources."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"cvss-common-vulnerability-scoring-system",children:"CVSS: Common Vulnerability Scoring System"}),"\n",(0,s.jsx)(n.p,{children:"Open framework to communicate characteristics and actual impact of different vulnerabilities, through a scoring system that goes from 0 to 10 based on criticial level."}),"\n",(0,s.jsx)(n.p,{children:"It explains what are some of the reasons of behind a particular score."}),"\n",(0,s.jsx)(n.h3,{id:"cve-common-vulnerabilities--exposures",children:"CVE: Common Vulnerabilities & Exposures"}),"\n",(0,s.jsx)(n.p,{children:"Dictionary of public identifiers around common vulnerabilities/exposures."}),"\n",(0,s.jsx)(n.h3,{id:"nvd-national-vulnerability-database",children:"NVD: National Vulnerability Database"}),"\n",(0,s.jsx)(n.p,{children:"Database of security checklists, software flaws, misconfigurations, etc, and what kind of impact does that vulnerability has."}),"\n",(0,s.jsx)(n.h3,{id:"assessment-tools",children:"Assessment Tools"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Nessus"}),"\n",(0,s.jsx)(n.li,{children:"Qualys"}),"\n",(0,s.jsx)(n.li,{children:"Nikto (web)"}),"\n",(0,s.jsx)(n.li,{children:"OpenVAS"}),"\n",(0,s.jsx)(n.li,{children:"RetinaCS"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"vulnerability-identification",children:"Vulnerability Identification"}),"\n",(0,s.jsx)(n.h3,{id:"kali-linux",children:"Kali Linux"}),"\n",(0,s.jsx)(n.p,{children:"First scan current subnet and look for open services."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'ifconfig // validate correct network\n\nnmap -sT -F 192.168.0.0/24 -oG Target_List\n    // -sT for TCP scan\n    // -F for "fast" scan\n    // -oG to save in specified file in present directory\n\n// another alternative\nnmap 192.168.0.0/24 | tee QuickScanResults.txt\n'})}),"\n",(0,s.jsx)(n.p,{children:"Then go to OpenVAS and upload targets (Configuration -> Targets -> New Target) and then perform scan (Scans -> Tasks -> New Task) on those targets."}),"\n",(0,s.jsx)(n.h4,{id:"manual-vulnerability-assessments",children:"Manual Vulnerability Assessments"}),"\n",(0,s.jsx)(n.p,{children:"If we want to target an specific host (i.e 192.168.0.20), first scan host's network:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"nmap -v 192.168.0.20 | tee 192.168.0.20_scanresults.txt\n\nleafpad 192.168.0.20_scanresults.txt &\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Then, conduct an ",(0,s.jsx)(n.em,{children:"OS Fingerprint scan"})," to determine associated OS."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"nmap -A 192.168.0.20 | tee 192.168.0.20_OSFINGERPRINT.txt\n"})}),"\n",(0,s.jsx)(n.p,{children:"You can find information of which services are running on OS, and on what ports."}),"\n",(0,s.jsx)(n.h3,{id:"windows",children:"Windows"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ipconfig // determine system IP and subnet mask\n"})}),"\n",(0,s.jsx)(n.p,{children:"Run CORE Impact and:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create workspace."}),"\n",(0,s.jsxs)(n.li,{children:["On the left panel, go to ",(0,s.jsx)(n.em,{children:"Network Vulnerability Test"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Target IPv4 network range (192.168.0.0/24 or 192.168.0.*)."}),"\n",(0,s.jsxs)(n.li,{children:["On the left panel, go to ",(0,s.jsx)(n.em,{children:"Network Report Generation"})," -> ",(0,s.jsx)(n.em,{children:"Network Vulnerability Report"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"host-specific-report",children:"Host-specific report"}),"\n",(0,s.jsxs)(n.p,{children:["We can use CORE Impact's ",(0,s.jsx)(n.em,{children:"Local Information Gathering"})," tool for this."]}),"\n",(0,s.jsxs)(n.p,{children:["After running scan on desired host, we can generate a report in ",(0,s.jsx)(n.em,{children:"Network Report Generation"})," -> ",(0,s.jsx)(n.em,{children:"Network Host Report"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"in-depth-scan",children:"In-Depth Scan"}),"\n",(0,s.jsxs)(n.p,{children:["We can use CORE Impact's ",(0,s.jsx)(n.em,{children:"Network Attack and Penetration"})," tool."]}),"\n",(0,s.jsxs)(n.p,{children:["First, perform a network scan with ",(0,s.jsx)(n.em,{children:"Network Information Gathering"})," as explained before."]}),"\n",(0,s.jsx)(n.p,{children:"Then perform vulnerability scanning with Attack and Penetration tool."}),"\n",(0,s.jsxs)(n.p,{children:["You will need to select an ",(0,s.jsx)(n.em,{children:"Attack Method"})," having identified the targets to scan. Use ",(0,s.jsx)(n.em,{children:"Launch exploit modules to identify core execution vulnerabilities"}),". Make sure you uncheck the ",(0,s.jsx)(n.em,{children:"Exploit selection"})," if your main goal is to identify vulnerabilities and not exploit a target."]}),"\n",(0,s.jsx)(n.h2,{id:"vulnerability-remediation",children:"Vulnerability Remediation"}),"\n",(0,s.jsxs)(n.p,{children:["One first step towards vulnerability remediation, is allow for ",(0,s.jsx)(n.strong,{children:"Audits"}),", by identifying what objects are being accessed and what operations are done through ",(0,s.jsx)(n.strong,{children:"logs"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"windows-1",children:"Windows"}),"\n",(0,s.jsxs)(n.p,{children:["All applications can log their operations. For example, ",(0,s.jsx)(n.em,{children:"Splunk server"})," can be configured to log actions."]}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.code,{children:"C:\\program_files\\Splunk\\bin\\splunk.exe"}),", you can right click on the ",(0,s.jsx)(n.code,{children:"splunk.exe"})," executable and select ",(0,s.jsx)(n.em,{children:"Properties"}),". Select the ",(0,s.jsx)(n.em,{children:"Security"})," tab, and ",(0,s.jsx)(n.em,{children:"Advanced"})," -> ",(0,s.jsx)(n.em,{children:"Auditing"})," -> ",(0,s.jsx)(n.em,{children:"Edit"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Then click the ",(0,s.jsx)(n.em,{children:"Add"})," button and type ",(0,s.jsx)(n.em,{children:"Everyone"})," in the search area. Once finished, click the ",(0,s.jsx)(n.em,{children:"Ok"})," button."]}),"\n",(0,s.jsx)(n.h4,{id:"security-policy-editor",children:"Security Policy Editor"}),"\n",(0,s.jsx)(n.p,{children:"Before anything, make sure we can audit objects."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Run ",(0,s.jsx)(n.code,{children:"secpol.msc"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Local Policies -> Audit Policy -> Audit Object Access, make sure everything is checked under ",(0,s.jsx)(n.em,{children:"Audit These Attemps"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"creating-recommendations-based-on-vulnerability-assessments",children:"Creating Recommendations Based on Vulnerability Assessments"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Confirm devices in provided IP range and create target list."}),"\n",(0,s.jsx)(n.li,{children:"Run vulnerability assessment."}),"\n",(0,s.jsx)(n.li,{children:"Perform risk assessment on findings and determine mitigation actions."}),"\n",(0,s.jsx)(n.li,{children:"Review previous vulnerability audit findings."}),"\n",(0,s.jsx)(n.li,{children:"Fill out a vulnerability audit report to document recent finds."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Reports like these are crucial for providing actionable details on what to do about known vulnerable systems and networks. They can serve as documentation to help free up funding (newer devices, operating systems or applications), provide data to back up stats concerning long-running issues, and can provide a historical detail that should be used to push for overdue changes."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"nmap -sT -F 192.168.0.0/24 -oG Target_List.txt\n\nleafpad Taget_List.txt // clean file to only have IPs\n\nopenvas-start\n"})}),"\n",(0,s.jsx)(n.p,{children:"At this point follow already explained process to create new targets and run scan..."}),"\n",(0,s.jsxs)(n.p,{children:["After scan has finished, we can view the results in the ",(0,s.jsx)(n.em,{children:"Scans"})," tab, and then ",(0,s.jsx)(n.em,{children:"Reports"})," link, by clicking on the Hyperlinked Date."]}),"\n",(0,s.jsx)(n.p,{children:"This report will show vulnerabilities found, their severity, what host they are on, and the location of the vulenrabilities."}),"\n",(0,s.jsx)(n.p,{children:"From here you can export data in multiple available formats."})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>a,a:()=>r});var s=i(7294);const t={},l=s.createContext(t);function r(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);