"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1068],{548:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var i=t(5893),r=t(1151);const s={},a="XXE: XML External Entity Injection",l={id:"vulnerabilities/web/xxe/README",title:"XXE: XML External Entity Injection",description:"XML lets you define new entities. Normally, these are simple text replacements but they can reference external files.",source:"@site/docs/vulnerabilities/web/xxe/README.md",sourceDirName:"vulnerabilities/web/xxe",slug:"/vulnerabilities/web/xxe/",permalink:"/cybersecurity-handbook/vulnerabilities/web/xxe/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"1. XSS: Cross-Site Scripting",permalink:"/cybersecurity-handbook/vulnerabilities/web/xss/"}},o={},c=[{value:"Read files",id:"read-files",level:2},{value:"Network Requests",id:"network-requests",level:2},{value:"Oracles",id:"oracles",level:2},{value:"Hunting",id:"hunting",level:2},{value:"Mitigation",id:"mitigation",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"xxe-xml-external-entity-injection",children:"XXE: XML External Entity Injection"}),"\n",(0,i.jsxs)(n.p,{children:["XML lets you define new entities. Normally, these are simple text replacements but ",(0,i.jsx)(n.em,{children:"they can reference external files"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"XXE attacks take advantage of the ability to read arbitrary files and URIs to enable a variety of attack scenarios. The injection of unintended XML content and/or structures into an XML message can alter the intended logic of the application."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://hackerone.com/reports/248668",children:"Twiter XXE Report"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"read-files",children:"Read files"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="ISO-8859-1">\n<!DOCTYPE foo [\n    <!ELEMENT foo ANY >\n    <!ENTITY xxe SYSTEM "file:///etc/passwd >\n]>\n<foo>&xxe;</foo>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"network-requests",children:"Network Requests"}),"\n",(0,i.jsx)(n.p,{children:'Perform network requests behind the firewall. Web server will make a connection to the URI you give, which could allow you to violate constraints like requesting backend data directly, in a "trusted" zone.'}),"\n",(0,i.jsx)(n.h2,{id:"oracles",children:"Oracles"}),"\n",(0,i.jsx)(n.p,{children:"Often, you will not see the data that you upload/fetch. In such a case, XXE can often be used as an oracle to determine if a file exists or a URI can be resolved."}),"\n",(0,i.jsx)(n.h2,{id:"hunting",children:"Hunting"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Attempt to inject XML or reserved characteres into input parameters and observed if XML parsing errors are generated."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"For web services, check each input parameter specified in the WSDL document for those of type XML."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"mitigation",children:"Mitigation"}),"\n",(0,i.jsx)(n.p,{children:"Passing additional flags to your XML parser, mostly for disallowing inline DTDs and removing entities entirely, mitigating the vulnerability in whole."})]})}function u(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>l,a:()=>a});var i=t(7294);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);