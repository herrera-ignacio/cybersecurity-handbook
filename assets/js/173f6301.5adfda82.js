"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7222],{4579:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>a,contentTitle:()=>r,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var t=n(5893),o=n(1151);const s={},r="File Inclusion",l={id:"vulnerabilities/web/file-inclusion/README",title:"File Inclusion",description:"Suppose you have the following website, http",source:"@site/docs/vulnerabilities/web/file-inclusion/README.md",sourceDirName:"vulnerabilities/web/file-inclusion",slug:"/vulnerabilities/web/file-inclusion/",permalink:"/cybersecurity-handbook/vulnerabilities/web/file-inclusion/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"CSRF: Cross Site Request Forgery",permalink:"/cybersecurity-handbook/vulnerabilities/web/csrf/"},next:{title:"File Upload",permalink:"/cybersecurity-handbook/vulnerabilities/web/file-upload/"}},a={},c=[{value:"How it works",id:"how-it-works",level:2},{value:"Authorization Bypass",id:"authorization-bypass",level:2},{value:"Mitigation",id:"mitigation",level:2}];function h(e){const i={code:"code",em:"em",h1:"h1",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,o.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h1,{id:"file-inclusion",children:"File Inclusion"}),"\n",(0,t.jsxs)(i.p,{children:["Suppose you have the following website, ",(0,t.jsx)(i.code,{children:"http://example.com/index.php?page=home"}),". Changing the query to ",(0,t.jsx)(i.code,{children:"?page=test"})," gives you the following error embedded in the page:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-txt",children:"Warning: include(test.php): failed to open stream: No such file or directory in - on line 26\n"})}),"\n",(0,t.jsxs)(i.p,{children:["This seems to be calling the ",(0,t.jsx)(i.code,{children:"include()"})," function on the page you reference + ",(0,t.jsx)(i.code,{children:".php"}),"."]}),"\n",(0,t.jsxs)(i.p,{children:["Suppose you change it to ",(0,t.jsx)(i.code,{children:"?page=http://demoseen.com/test"}),". Suddenly it's making a web request to it, and any code that's contained in that file is going to be executed by the site in question."]}),"\n",(0,t.jsx)(i.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,t.jsxs)(i.p,{children:["Any time you're including code on the fly based on user input without ",(0,t.jsx)(i.em,{children:"very"})," strict whitelisting, you're likely to run into ",(0,t.jsx)(i.em,{children:"File inclusion"})," bugs."]}),"\n",(0,t.jsxs)(i.p,{children:["In many cases, PHP (and other languages/frameworks) will be configured to not allow web requests from an ",(0,t.jsx)(i.code,{children:"include()"})," and the like. When they're possible, you have ",(0,t.jsx)(i.strong,{children:"Remote File Inclusion (RFI)"}),", when they're not, you're looking at ",(0,t.jsx)(i.strong,{children:"Local File Inclusion (LFI)"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"authorization-bypass",children:"Authorization Bypass"}),"\n",(0,t.jsx)(i.p,{children:"Often, applications are written such that authorization checks happen in a different file than the actual logic."}),"\n",(0,t.jsxs)(i.p,{children:["So in our scenario, going to ",(0,t.jsx)(i.code,{children:"?page=admin"})," might give you a login prompt for an admin area, but ",(0,t.jsx)(i.code,{children:"?page=admin_users"})," might give you direct access to the user management component for instance."]}),"\n",(0,t.jsx)(i.h2,{id:"mitigation",children:"Mitigation"}),"\n",(0,t.jsxs)(i.p,{children:["Safest way to handle this is not to have user input driven into ",(0,t.jsx)(i.code,{children:"include()"})," and the like whatsoever. Otherwise, ",(0,t.jsx)(i.em,{children:"whitelisting"})," as strict as possible is essential."]}),"\n",(0,t.jsxs)(i.p,{children:["In the case that neither of these is viable, then ",(0,t.jsx)(i.em,{children:"removing directory separators"})," may be the only route. This is not recommended, but will prevent URLs and directory traversal."]})]})}function d(e={}){const{wrapper:i}={...(0,o.a)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},1151:(e,i,n)=>{n.d(i,{Z:()=>l,a:()=>r});var t=n(7294);const o={},s=t.createContext(o);function r(e){const i=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);