"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7319],{6717:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var i=n(5893),s=n(1151);const o={},r="Host Header Attack",a={id:"vulnerabilities/web/host-header/README",title:"Host Header Attack",description:"A web server commonly hosts several web applications on the same IP address, referring to each application via the virtual host. In an incoming HTTP request, web servers often dispatch the request to the target virtual host based on the value supplied in the Host header. Without proper validation of the header value, the attacker can supply invalid input to cause the web server to:",source:"@site/docs/vulnerabilities/web/host-header/README.md",sourceDirName:"vulnerabilities/web/host-header",slug:"/vulnerabilities/web/host-header/",permalink:"/cybersecurity-handbook/vulnerabilities/web/host-header/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"File Upload",permalink:"/cybersecurity-handbook/vulnerabilities/web/file-upload/"},next:{title:"HTML Injection",permalink:"/cybersecurity-handbook/vulnerabilities/web/html-injection/"}},l={},c=[{value:"Open Redirection",id:"open-redirection",level:2},{value:"Web Cache Poisoning",id:"web-cache-poisoning",level:2},{value:"Password Reset Poisoning",id:"password-reset-poisoning",level:2},{value:"XSS Through Host Header",id:"xss-through-host-header",level:2},{value:"Mitigation",id:"mitigation",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"host-header-attack",children:"Host Header Attack"}),"\n",(0,i.jsx)(t.p,{children:"A web server commonly hosts several web applications on the same IP address, referring to each application via the virtual host. In an incoming HTTP request, web servers often dispatch the request to the target virtual host based on the value supplied in the Host header. Without proper validation of the header value, the attacker can supply invalid input to cause the web server to:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Dispatch requests to the first virtual host on the list."}),"\n",(0,i.jsx)(t.li,{children:"Cause a redirection to an attacker-controlled domain."}),"\n",(0,i.jsx)(t.li,{children:"Perform web cache poisoning."}),"\n",(0,i.jsx)(t.li,{children:"Manipulate password reset functionality."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"In many cases, HTTP Host Header ist rusted and used to generate links, import scripts, and even generate password resets links with its value."}),"\n",(0,i.jsx)(t.p,{children:"This is a very bad idea, because the HTTP Host Header can be controlled by an attacker, thus can be exploited using web-cache poisoning and by abusing alternative channels like password reset emails."}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/17-Testing_for_Host_Header_Injection",children:"OWASP: Testing for Host Header Injection"})}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"open-redirection",children:"Open Redirection"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Testing differet ",(0,i.jsx)(t.code,{children:"Host"})," headers"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"X-Forwarded-Host"})," Header By pass"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Even if, ",(0,i.jsx)(t.code,{children:"Host"})," header injection is mitigated by checking for invalid input injected, you can supply the value to the ",(0,i.jsx)(t.code,{children:"X-Forwarded-Host"})," header."]}),"\n",(0,i.jsx)(t.h2,{id:"web-cache-poisoning",children:"Web Cache Poisoning"}),"\n",(0,i.jsx)(t.p,{children:"An attacker can manipulate a web-cache to serve poisoned content to anyone who requests it. This relies on the ability to poison the caching proxy run by the application itself, CDNs, or other downstream providers."}),"\n",(0,i.jsx)(t.p,{children:"As a result, the victim will have no control over receiving malicious content when requesting the vulnerable application."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"GET / HTTP/1.1\nHost: www.attacker.com\n...\n"})}),"\n",(0,i.jsx)(t.p,{children:"The following will be served from web cache, when a victim visits the vulnerable application:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-html",children:'...\n<link src="http://www.attacker.com/link" />\n...\n'})}),"\n",(0,i.jsx)(t.h2,{id:"password-reset-poisoning",children:"Password Reset Poisoning"}),"\n",(0,i.jsxs)(t.p,{children:["It is common for password reset functionality to include the ",(0,i.jsx)(t.code,{children:"Host"})," header value when creating password reset links that use a generated secret token. If the application processes an attacker-controlled domain to create a password reset link, the victim may click on the link in the email and allow the attacker to obtain the reset token, thus resetting the victim's password."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"... Email snippet ...\n\nClick on the following link to reset your password:\n\nhttp://www.attacker.com/index.php?module=Login&action=resetPassword&token=<SECRET_TOKEN>\n\n... Email snippet ...\n"})}),"\n",(0,i.jsx)(t.h2,{id:"xss-through-host-header",children:"XSS Through Host Header"}),"\n",(0,i.jsx)(t.p,{children:"Some users muy reflect HTTP headers, and if unsanitized, it may be another way to inject XSS."}),"\n",(0,i.jsx)(t.h2,{id:"mitigation",children:"Mitigation"}),"\n",(0,i.jsxs)(t.p,{children:["Don't trust the ",(0,i.jsx)(t.code,{children:"Host"})," header, but if you must, it's highly advised to make use of a whitelist of allowed hostnames."]})]})}function d(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>r});var i=n(7294);const s={},o=i.createContext(s);function r(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);