"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7622],{7835:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>t});var o=r(5893),s=r(1151);const i={},c="DNS",a={id:"information_gathering/dns/README",title:"DNS",description:"What is DNS?",source:"@site/docs/information_gathering/dns/README.md",sourceDirName:"information_gathering/dns",slug:"/information_gathering/dns/",permalink:"/cybersecurity-handbook/information_gathering/dns/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Web Crawling",permalink:"/cybersecurity-handbook/information_gathering/crawling/"},next:{title:"Passive Infrastructure Identification",permalink:"/cybersecurity-handbook/information_gathering/passive_infrastructure_identification/"}},d={},t=[{value:"What is DNS?",id:"what-is-dns",level:2},{value:"Hierarchy of names",id:"hierarchy-of-names",level:2},{value:"Resource records",id:"resource-records",level:2},{value:"Nslookup &amp; dig",id:"nslookup--dig",level:2},{value:"Querying A records",id:"querying-a-records",level:3},{value:"Querying A records for a subdomain",id:"querying-a-records-for-a-subdomain",level:3},{value:"Querying PTR records for an IP address",id:"querying-ptr-records-for-an-ip-address",level:3},{value:"Querying ANY existing records",id:"querying-any-existing-records",level:3},{value:"Querying TXT records",id:"querying-txt-records",level:3},{value:"Querying MX records",id:"querying-mx-records",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"dns",children:"DNS"}),"\n",(0,o.jsx)(n.h2,{id:"what-is-dns",children:"What is DNS?"}),"\n",(0,o.jsxs)(n.p,{children:["Each internet-connected device has a unique IP address that other machines use to locae it. ",(0,o.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Domain_Name_System",children:"Domain Name System (DNS)"})," is the internet's phone book. DNS converts domain names to IP addresses, allowing browsers to access resources on the Internet."]}),"\n",(0,o.jsx)(n.h2,{id:"hierarchy-of-names",children:"Hierarchy of names"}),"\n",(0,o.jsx)(n.p,{children:"There's a hierarchy of names in the DNS structure."}),"\n",(0,o.jsx)(n.p,{children:"The system's root, or highest level, is unnamed."}),"\n",(0,o.jsxs)(n.p,{children:["TLDs nameservers, the ",(0,o.jsx)(n.em,{children:"Top-Level Domains"}),", might be compared to a single shelf of books in a library. The last portion of a hostname is hosted by the nameserver, which is the following stage in the search for a specific IP address (in ",(0,o.jsx)(n.code,{children:"www.facebook.com"}),", the TLD server is ",(0,o.jsx)(n.code,{children:"com"}),"). Most TLDs have been delegated to individual country managers, who are issued codes from the ",(0,o.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/List_of_ISO_3166_country_codes",children:"ISO-3166-1 table"})," (i.e., country code Top-Level Domains or ccTLDs)."]}),"\n",(0,o.jsx)(n.p,{children:'There are also a small number of "generic" Top-Level Domains (gTLDs) that are not associated with a specific country or region.'}),"\n",(0,o.jsxs)(n.p,{children:["TLD managers have been granted responsibility for procedures and policies for the assignment of ",(0,o.jsx)(n.em,{children:"Second Level Domain Names"})," (",(0,o.jsx)(n.em,{children:"SLDs"}),") and lower level hierarchies of names, according to the policy advice specified in ",(0,o.jsx)(n.em,{children:"ISO-3166-1"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"resource-records",children:"Resource records"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.em,{children:"Resource records"})," are the results of DNS queries and have the following structure:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Resource record"}),": Domain name, usually a FQDN."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"TTL"}),": Time-To-Live in seconds, defaults to the minimum value specified in the SOA record."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Record Class"}),": Internet, Hesiod, or Chaos."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Start Of Authority"})," (",(0,o.jsx)(n.code,{children:"SOA"}),"): Each zone can only have one ",(0,o.jsx)(n.code,{children:"SOA"})," record, and it contains the zone's values, such as a serial number and multiple expiration timeouts."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Name Servers"})," (",(0,o.jsx)(n.code,{children:"NS"}),"): The distributed database is bound together by ",(0,o.jsx)(n.code,{children:"NS"})," record which are in charge of a zone's authoritative name server and the authority for a child zone to a name server."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"IPv4 Addresses"})," (",(0,o.jsx)(n.code,{children:"A"}),"): It's only a mapping between an IP address and a hostname. 'Forward' zones are those with ",(0,o.jsx)(n.code,{children:"A"})," records."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Poitner"})," (",(0,o.jsx)(n.code,{children:"PTR"}),"): It's also only a mapping between an IP address and a hostname. 'Reverse' zones are those that have ",(0,o.jsx)(n.code,{children:"PTR"})," records."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Canonical Name"})," (",(0,o.jsx)(n.code,{children:"CNAME"}),"): An alias hostname is mapped to an ",(0,o.jsx)(n.code,{children:"A"})," record hostname using the ",(0,o.jsx)(n.code,{children:"CNAME"})," record."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Mail Exchange"})," (",(0,o.jsx)(n.code,{children:"MX"}),"): It identifies a host that will accept emails for a specific host. Multiple MX records can exist on the same host, and a prioritized list is made consisting of the records for a specific host."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"nslookup--dig",children:"Nslookup & dig"}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"nslookup"})," we can search for domain name servers on the Internet and ask them for information about hosts and domains."]}),"\n",(0,o.jsx)(n.h3,{id:"querying-a-records",children:"Querying A records"}),"\n",(0,o.jsxs)(n.p,{children:["We can query ",(0,o.jsx)(n.code,{children:"A"})," records by just submitting a domain name:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:'$ export TARGET="facebook.com"\n$ nslookup $TARGET\nServer:\t\t1.1.1.1\nAddress:\t1.1.1.1#53\n\nNon-authoritative answer:\nName:\tfacebook.com\nAddress: 31.13.92.36\nName:\tfacebook.com\nAddress: 2a03:2880:f11c:8083:face:b00c:0:25de\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Unlike nslookup, ",(0,o.jsx)(n.code,{children:"dig"})," shows us some more information that can be of importance:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"$ dig facebook.com @1.1.1.1\n\n; <<>> DiG 9.16.1-Ubuntu <<>> facebook.com @1.1.1.1\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 58899\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 1232\n;; QUESTION SECTION:\n;facebook.com.                  IN      A\n\n;; ANSWER SECTION:\nfacebook.com.           169     IN      A       31.13.92.36\n\n;; Query time: 20 msec\n;; SERVER: 1.1.1.1#53(1.1.1.1)\n;; WHEN: Mo Okt 18 16:03:17 CEST 2021\n;; MSG SIZE  rcvd: 57\n"})}),"\n",(0,o.jsx)(n.h3,{id:"querying-a-records-for-a-subdomain",children:"Querying A records for a subdomain"}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"nslookup"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"$ export TARGET=www.facebook.com\n$ nslookup -query=A $TARGET\n\nServer:\t\t1.1.1.1\nAddress:\t1.1.1.1#53\n\nNon-authoritative answer:\nwww.facebook.com\tcanonical name = star-mini.c10r.facebook.com.\nName:\tstar-mini.c10r.facebook.com\nAddress: 31.13.92.36\n"})}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"dig"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"$ dig a www.facebook.com @1.1.1.1\n\n; <<>> DiG 9.16.1-Ubuntu <<>> a www.facebook.com @1.1.1.1\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 15596\n;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 1232\n;; QUESTION SECTION:\n;www.facebook.com.              IN      A\n\n;; ANSWER SECTION:\nwww.facebook.com.       3585    IN      CNAME   star-mini.c10r.facebook.com.\nstar-mini.c10r.facebook.com. 45 IN      A       31.13.92.36\n\n;; Query time: 16 msec\n;; SERVER: 1.1.1.1#53(1.1.1.1)\n;; WHEN: Mo Okt 18 16:11:48 CEST 2021\n;; MSG SIZE  rcvd: 90\n"})}),"\n",(0,o.jsx)(n.h3,{id:"querying-ptr-records-for-an-ip-address",children:"Querying PTR records for an IP address"}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"nslookup"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"$ nslookup -query=PTR 31.13.92.36\n\nServer:\t\t1.1.1.1\nAddress:\t1.1.1.1#53\n\nNon-authoritative answer:\n36.92.13.31.in-addr.arpa\tname = edge-star-mini-shv-01-frt3.facebook.com.\n"})}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"dig"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"$ dig -x 31.13.92.36 @1.1.1.1\n\n; <<>> DiG 9.16.1-Ubuntu <<>> -x 31.13.92.36 @1.1.1.1\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 51730\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 1232\n;; QUESTION SECTION:\n;36.92.13.31.in-addr.arpa.      IN      PTR\n\n;; ANSWER SECTION:\n36.92.13.31.in-addr.arpa. 1028  IN      PTR     edge-star-mini-shv-01-frt3.facebook.com.\n\n;; Query time: 16 msec\n;; SERVER: 1.1.1.1#53(1.1.1.1)\n;; WHEN: Mo Okt 18 16:14:20 CEST 2021\n;; MSG SIZE  rcvd: 106\n"})}),"\n",(0,o.jsx)(n.h3,{id:"querying-any-existing-records",children:"Querying ANY existing records"}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"nslookup"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:'export TARGET="google.com"\nnslookup -query=ANY $TARGET\n'})}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"dig"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"dig any google.com @8.8.8.8\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsxs)(n.p,{children:["The more recent ",(0,o.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc8482",children:"RFC8482"})," specified that ",(0,o.jsx)(n.code,{children:"ANY"})," DNS requests to be abolished. Therefore, we may not receive a response to our ",(0,o.jsx)(n.code,{children:"ANY"})," request from the DNS server or get a reference to the said RFC8482."]})}),"\n",(0,o.jsx)(n.h3,{id:"querying-txt-records",children:"Querying TXT records"}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"nslookup"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:'$ export TARGET="facebook.com"\n$ nslookup -query=TXT $TARGET\n\nServer:\t\t1.1.1.1\nAddress:\t1.1.1.1#53\n\nNon-authoritative answer:\nfacebook.com\ttext = "v=spf1 redirect=_spf.facebook.com"\nfacebook.com\ttext = "google-site-verification=A2WZWCNQHrGV_TWwKh6KHY90tY0SHZo_RnyMJoDaG0s"\nfacebook.com\ttext = "google-site-verification=wdH5DTJTc9AYNwVunSVFeK0hYDGUIEOGb-RReU6pJlY"\n\nAuthoritative answers can be found from:\n'})}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"dig"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"dig txt facebook.com @1.1.1.1\n"})}),"\n",(0,o.jsx)(n.h3,{id:"querying-mx-records",children:"Querying MX records"}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"nslookup"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:'$ export TARGET="facebook.com"\n$ nslookup -query=MX $TARGET\n\nServer:\t\t1.1.1.1\nAddress:\t1.1.1.1#53\n\nNon-authoritative answer:\nfacebook.com\tmail exchanger = 10 smtpin.vvv.facebook.com.\n\nAuthoritative answers can be found from:\n'})}),"\n",(0,o.jsxs)(n.p,{children:["With ",(0,o.jsx)(n.code,{children:"dig"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"dig mx facebook.com @1.1.1.1\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>a,a:()=>c});var o=r(7294);const s={},i=o.createContext(s);function c(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);