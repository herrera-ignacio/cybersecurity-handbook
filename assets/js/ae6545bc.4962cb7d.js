"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9530],{3430:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var n=r(5893),s=r(1151);const i={},d="TCPDump",c={id:"networking/attacks/traffic-analysis/TCPDump/README",title:"TCPDump",description:"Fundamentals",source:"@site/docs/networking/attacks/traffic-analysis/TCPDump/README.md",sourceDirName:"networking/attacks/traffic-analysis/TCPDump",slug:"/networking/attacks/traffic-analysis/TCPDump/",permalink:"/cybersecurity-handbook/networking/attacks/traffic-analysis/TCPDump/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Network traffic analysis",permalink:"/cybersecurity-handbook/networking/attacks/traffic-analysis/"},next:{title:"Wireshark",permalink:"/cybersecurity-handbook/networking/attacks/traffic-analysis/Wireshark/"}},a={},l=[{value:"Fundamentals",id:"fundamentals",level:2},{value:"Traffic captures",id:"traffic-captures",level:3},{value:"Basic capture options",id:"basic-capture-options",level:4},{value:"Tcpdump output",id:"tcpdump-output",level:4},{value:"File I/O",id:"file-io",level:4},{value:"Packet filtering",id:"packet-filtering",level:2}];function o(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"tcpdump",children:"TCPDump"}),"\n",(0,n.jsx)(t.h2,{id:"fundamentals",children:"Fundamentals"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"tcpdump"})," is a CLI packet sniffer that can directly capture and interpret data frames from a file or network interface."]}),"\n",(0,n.jsxs)(t.p,{children:['To capture traffic from "off the wire", it uses the libraries ',(0,n.jsx)(t.code,{children:"pcac"})," and ",(0,n.jsx)(t.code,{children:"libpcap"}),", paired with an interface in promiscuous mode to listen for data. This allows the program to see and capture packets sourcing from or destined for any device in the LAN."]}),"\n",(0,n.jsx)(t.h3,{id:"traffic-captures",children:"Traffic captures"}),"\n",(0,n.jsx)(t.h4,{id:"basic-capture-options",children:"Basic capture options"}),"\n",(0,n.jsx)(t.p,{children:"Here are some basic Tcpdumps switches we can use to modify how our captures run and can be chained tohether:"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Switch Command"}),(0,n.jsx)(t.th,{children:"Result"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"D"}),(0,n.jsx)(t.td,{children:"Will display any interfaces available to capture from."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"i"}),(0,n.jsx)(t.td,{children:"Selects an interface to capture from. ex. -i eth0"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"n"}),(0,n.jsx)(t.td,{children:"Do not resolve hostnames."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"nn"}),(0,n.jsx)(t.td,{children:"Do not resolve hostnames or well-known ports."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"e"}),(0,n.jsx)(t.td,{children:"Will grab the ethernet header along with upper-layer data."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"X"}),(0,n.jsx)(t.td,{children:"Show Contents of packets in hex and ASCII."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"XX"}),(0,n.jsx)(t.td,{children:"Same as X, but will also specify ethernet headers. (like using Xe)"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"v, vv, vvv"}),(0,n.jsx)(t.td,{children:"Increase the verbosity of output shown and saved."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"c"}),(0,n.jsx)(t.td,{children:"Grab a specific number of packets, then quit the program."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"s"}),(0,n.jsx)(t.td,{children:"Defines how much of a packet to grab."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"S"}),(0,n.jsx)(t.td,{children:"change relative sequence numbers in the capture display to absolute sequence numbers. (13248765839 instead of 101)"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"q"}),(0,n.jsx)(t.td,{children:"Print less protocol information."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"r file.pcap"}),(0,n.jsx)(t.td,{children:"Read from a file."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"w file.pcap"}),(0,n.jsx)(t.td,{children:"Write into a file."})]})]})]}),"\n",(0,n.jsx)(t.h4,{id:"tcpdump-output",children:"Tcpdump output"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Output example",src:r(39).Z+"",width:"1261",height:"629"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Timestap: yellow."}),"\n",(0,n.jsx)(t.li,{children:"Protocol: orange."}),"\n",(0,n.jsx)(t.li,{children:"Source & destination IP: orange."}),"\n",(0,n.jsx)(t.li,{children:"Flags: green."}),"\n",(0,n.jsx)(t.li,{children:"Sequence & Acknowledgment numbers: red."}),"\n",(0,n.jsx)(t.li,{children:"Protocol options: blue."}),"\n",(0,n.jsx)(t.li,{children:"Notes / Next Header: white."}),"\n"]}),"\n",(0,n.jsx)(t.h4,{id:"file-io",children:"File I/O"}),"\n",(0,n.jsxs)(t.p,{children:["Using ",(0,n.jsx)(t.code,{children:"-w"})," will write our capture to a file: ",(0,n.jsx)(t.code,{children:"sudo tcpdump -i eth0 -w ~/output.pcap"}),". Afterwards, we can read the output with: ",(0,n.jsx)(t.code,{children:"sudo tcpdump -r ~/output.pcap"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"packet-filtering",children:"Packet filtering"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Filter"}),(0,n.jsx)(t.th,{children:"Result"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"host"}),(0,n.jsx)(t.td,{children:"host will filter visible traffic to show anything involving the designated host. Bi-directional"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"src / dest"}),(0,n.jsx)(t.td,{children:"src and dest are modifiers. We can use them to designate a source or destination host or port."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"net"}),(0,n.jsx)(t.td,{children:"net will show us any traffic sourcing from or destined to the network designated. It uses / notation."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"proto"}),(0,n.jsx)(t.td,{children:"will filter for a specific protocol type. (ether, TCP, UDP, and ICMP as examples)"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"port"}),(0,n.jsx)(t.td,{children:"port is bi-directional. It will show any traffic with the specified port as the source or destination."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"portrange"}),(0,n.jsx)(t.td,{children:"portrange allows us to specify a range of ports. (0-1024)"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:'less / greater "< >"'}),(0,n.jsx)(t.td,{children:"less and greater can be used to look for a packet or protocol option of a specific size."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"and / &&"}),(0,n.jsx)(t.td,{children:"and && can be used to concatenate two different filters together. for example, src host AND port."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"or"}),(0,n.jsx)(t.td,{children:"or allows for a match on either of two conditions. It does not have to meet both. It can be tricky."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"not"}),(0,n.jsx)(t.td,{children:"not is a modifier saying anything but x. For example, not UDP."})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},39:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/image-f639a1787bd993471ffc9d10b0e1d536.png"},1151:(e,t,r)=>{r.d(t,{Z:()=>c,a:()=>d});var n=r(7294);const s={},i=n.createContext(s);function d(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);