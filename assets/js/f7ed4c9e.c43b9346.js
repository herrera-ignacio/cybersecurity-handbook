"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1215],{9114:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});var t=n(5893),s=n(1151);const o={},a="Cookie Tampering",r={id:"vulnerabilities/web/cookie-tampering/README",title:"Cookie Tampering",description:"Manipulating the Browser",source:"@site/docs/vulnerabilities/web/cookie-tampering/README.md",sourceDirName:"vulnerabilities/web/cookie-tampering",slug:"/vulnerabilities/web/cookie-tampering/",permalink:"/cybersecurity-handbook/vulnerabilities/web/cookie-tampering/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Command Injection",permalink:"/cybersecurity-handbook/vulnerabilities/web/command-injection/"},next:{title:"CORS Insecure Configuration",permalink:"/cybersecurity-handbook/vulnerabilities/web/cors-insecure/"}},l={},d=[{value:"Manipulating the Browser",id:"manipulating-the-browser",level:2},{value:"Manipulating Responses",id:"manipulating-responses",level:2},{value:"Decoding Data",id:"decoding-data",level:2},{value:"Manipulations",id:"manipulations",level:2},{value:"Hashes",id:"hashes",level:2},{value:"Mitigation",id:"mitigation",level:2},{value:"Flags",id:"flags",level:3}];function c(e){const i={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h1,{id:"cookie-tampering",children:"Cookie Tampering"}),"\n",(0,t.jsx)(i.h2,{id:"manipulating-the-browser",children:"Manipulating the Browser"}),"\n",(0,t.jsxs)(i.p,{children:["You can easily manipulate cookies on the browser side via Firefox's development tools. The ",(0,t.jsx)(i.code,{children:"cookie"})," command is extensive and allows you to list, delete, edit, and add cookies arbitrarily."]}),"\n",(0,t.jsx)(i.h2,{id:"manipulating-responses",children:"Manipulating Responses"}),"\n",(0,t.jsxs)(i.p,{children:["You can manipulate response coming from the server, using Burp for eample, to set cookies as need be. In this, you either edit ",(0,t.jsx)(i.code,{children:"Set-Cookie"})," headers, or add new ones as you see fit."]}),"\n",(0,t.jsx)(i.h2,{id:"decoding-data",children:"Decoding Data"}),"\n",(0,t.jsx)(i.p,{children:"Always decode data that is present, if it's encoded in any way."}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["If it ends in ",(0,t.jsx)(i.code,{children:"="})," or contains ",(0,t.jsx)(i.code,{children:"/"})," (or ",(0,t.jsx)(i.code,{children:"_"}),"/",(0,t.jsx)(i.code,{children:"-"})," to get around URI encoding), it's almost definitely Base64'd."]}),"\n",(0,t.jsx)(i.li,{children:"If it's all in the range 0-9A-F and all in either upper or lower case, it's almost definitely hex encoded."}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"manipulations",children:"Manipulations"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Change individual bits of data to see the results."}),"\n",(0,t.jsx)(i.li,{children:"Swap key-value pairs, or add duplicates."}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"hashes",children:"Hashes"}),"\n",(0,t.jsxs)(i.p,{children:["if you find yourself with a cookie ending in 32-40 nibbles of hex, there's a decent change this is a hash. If it's done propery (HMAC) then this should be safe. However, if it's a bare hash, it may be possible to perform a ",(0,t.jsx)(i.em,{children:"length extension attack"}),", allowing you to append arbitrary data to the end of the cookie."]}),"\n",(0,t.jsx)(i.h2,{id:"mitigation",children:"Mitigation"}),"\n",(0,t.jsx)(i.h3,{id:"flags",children:"Flags"}),"\n",(0,t.jsxs)(i.p,{children:["Make ",(0,t.jsx)(i.em,{children:"absolutely sure"})," that you check the ",(0,t.jsx)(i.code,{children:"HTTPOnly"})," (prevents cookies from being read from javascript) and ",(0,t.jsx)(i.code,{children:"Secure"})," flags (prevents cookies being sent in plain text over http)."]})]})}function h(e={}){const{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},1151:(e,i,n)=>{n.d(i,{Z:()=>r,a:()=>a});var t=n(7294);const s={},o=t.createContext(s);function a(e){const i=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(o.Provider,{value:i},e.children)}}}]);