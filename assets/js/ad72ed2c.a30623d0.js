"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6614],{2416:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>a});var s=i(5893),t=i(1151);const l={},r="Jason Haddix: How to Shot Web",o={id:"lectures/offensive/d23-how-to-shoot-web/README",title:"Jason Haddix: How to Shot Web",description:"Tactical Fuzzing, XSS",source:"@site/docs/lectures/offensive/d23-how-to-shoot-web/README.md",sourceDirName:"lectures/offensive/d23-how-to-shoot-web",slug:"/lectures/offensive/d23-how-to-shoot-web/",permalink:"/cybersecurity-handbook/lectures/offensive/d23-how-to-shoot-web/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Introduction of Vulnerability Management",permalink:"/cybersecurity-handbook/lectures/defensive/vuln-management-fundamentals/"},next:{title:"JavaScript Deobfuscation",permalink:"/cybersecurity-handbook/offensive-security/javascript_deobfuscation/"}},c={},a=[{value:"Tactical Fuzzing, XSS",id:"tactical-fuzzing-xss",level:2},{value:"Polyglot payloads",id:"polyglot-payloads",level:3},{value:"SQL specifics",id:"sql-specifics",level:3},{value:"DBMS Specific Resources",id:"dbms-specific-resources",level:4},{value:"Malicious File Upload",id:"malicious-file-upload",level:2},{value:"CSRF",id:"csrf",level:2},{value:"Privilege",id:"privilege",level:2},{value:"Insecure Direct Object References (IDOR)",id:"insecure-direct-object-references-idor",level:2},{value:"Logic",id:"logic",level:2},{value:"Data Driven Assessment",id:"data-driven-assessment",level:2},{value:"Things to take with you",id:"things-to-take-with-you",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"jason-haddix-how-to-shot-web",children:"Jason Haddix: How to Shot Web"}),"\n",(0,s.jsx)(n.h2,{id:"tactical-fuzzing-xss",children:"Tactical Fuzzing, XSS"}),"\n",(0,s.jsxs)(n.p,{children:["Many user use ",(0,s.jsx)(n.strong,{children:"Polyglot"})," payloads."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://owasp.org/www-community/xss-filter-evasion-cheatsheet",children:"OWASP, XSS Filter Evasion Cheat Sheet"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.blackhat.com/docs/eu-14/materials/eu-14-Javed-Revisiting-XSS-Sanitization.pdf",children:"Ashar Javed XSS Research"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.youtube.com/watch?v=EeZDw64YwV0",children:"Mathias Karlsson Polyglot Payloads"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://dev.to/didymus/xss-and-sqli-polyglot-payloads-4hb4",children:"XSS and SQLi Polyglot payloads"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/danielmiessler/SecLists",children:"SecLists payloads"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"polyglot-payloads",children:"Polyglot payloads"}),"\n",(0,s.jsx)(n.p,{children:"XSS polyglot payload by Rsnake"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u2018;alert(String.fromCharCode(88,83,83))//\u2018;alert(String.fromCharCode(88,83,83))//\u201c;alert(String.fromCharCode(88,83,83))//\u201c;alert(String.fromCharCode(88,83,83))//\u2014><\/SCRIPT>\u201d>\u2019><SCRIPT>alert(String.fromCharCode(88,83,83))<\/SCRIPT>\n"})}),"\n",(0,s.jsx)(n.p,{children:"Ashar Javed from his XSS PhD research"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u2018\u201c>><marquee><img src=x onerror=confirm(1)></marquee>\u201d></plaintext\\></|\\><plaintext/onmouseover=prompt(1)><script>prompt(1)<\/script>@gmail.com<isindex formaction=javascript:alert(/XSS/) type=submit>\u2019\u2014>\u201d><\/script><script>alert(1)<\/script>\u201d><img/id=\u201cconfirm&lpar;1)\u201d/alt=\u201c/\u201csrc=\u201c/\u201conerror=eval(id&%23x29;>\u2019\u201d><img src=\u201chttp://i.imgur.com/P8mL8.jpg\u201d>\n"})}),"\n",(0,s.jsx)(n.p,{children:"XSS polyglot payload by Mathias Karlsson:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u201conclick=alert(1)//<button\u2018onclick=alert(1)//>*/alert(1)//\n"})}),"\n",(0,s.jsx)(n.p,{children:"An SQLi polyglot payload by Mathias Karlsson:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"SLEEP(1) /*\u2019 or SLEEP(1) or\u2019\u201d or SLEEP(1) or \u201c*/\n"})}),"\n",(0,s.jsx)(n.h3,{id:"sql-specifics",children:"SQL specifics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Blind is predominant, error based is highly unlikely."}),"\n",(0,s.jsxs)(n.li,{children:["SQLMap is king","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:"-l"})," to parse a Burp log file."]}),"\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.strong,{children:"Tamper Scripts"})," for backlists."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SQLiPy"})," burp plugin works well to instrument SQLmap quickly."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"dbms-specific-resources",children:"DBMS Specific Resources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["MySQL","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PentestMonkey's MySQL Injection Cheatsheet"}),"\n",(0,s.jsx)(n.li,{children:"Reiners MySQL Injection Filter Evasion Cheatsheet"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["MSSQL","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"EvilSQL's Error/Union/Based MSSQL Cheatsheet"}),"\n",(0,s.jsx)(n.li,{children:"PentestMonkey's MSSQL SQLi Injection Cheatsheet"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Oracle","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PentestMonkey's Oracle SQLi Cheatsheet"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["PostgreSQL","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PentestMonkey's Postgres SQLi Cheatsheet"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Others","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Access SQLi Cheatsheet"}),"\n",(0,s.jsxs)(n.li,{children:["PentestMonkey's","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Ingres SQLi Cheatsheet"}),"\n",(0,s.jsx)(n.li,{children:"DB2 SQLi Cheatsheet"}),"\n",(0,s.jsx)(n.li,{children:"Informix SQLi Cheatsheet"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"SQLite3 Injection Cheatsheet"}),"\n",(0,s.jsx)(n.li,{children:"Ruby on Rails (Active Record) SQL Injection Guide"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"malicious-file-upload",children:"Malicious File Upload"}),"\n",(0,s.jsx)(n.p,{children:"Common attack vector in this type of testing. File upload functions need a lot of protections to be adequately secure."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Upload unexpected file format to achieve code exec (swf, html, php, php3, aspx, ++), web shells or..."}),"\n",(0,s.jsx)(n.li,{children:"Execute XSS via same type of files. Images as well!"}),"\n",(0,s.jsx)(n.li,{children:"Attack the parser to DoS the site or XSS via storing payloads in metadata or file header."}),"\n",(0,s.jsx)(n.li,{children:"Bypass security zones and store malware on target site via file polyglots."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"csrf",children:"CSRF"}),"\n",(0,s.jsxs)(n.p,{children:["Many sites will have CSRF protection, focus on CSRF ",(0,s.jsx)(n.strong,{children:"bypass"}),"!"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Remove CSRF token from request"}),"\n",(0,s.jsx)(n.li,{children:"Remove CSRF token parameter value"}),"\n",(0,s.jsx)(n.li,{children:"Add bad control chars to CSRF parameter value"}),"\n",(0,s.jsx)(n.li,{children:"Use a second identical CSRF param"}),"\n",(0,s.jsx)(n.li,{children:"Change POST to GET"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"privilege",children:"Privilege"}),"\n",(0,s.jsxs)(n.p,{children:["Often logic, priv, auth bugs are blurred. ",(0,s.jsx)(n.strong,{children:"Autorize"})," Burp plugin is pretty neat."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Find site functionality that is restricted to certain user types."}),"\n",(0,s.jsx)(n.li,{children:"Try accessing those functions with lesser/other user roles."}),"\n",(0,s.jsx)(n.li,{children:"Try to directly browse to views with sensitive information as a lesser privileged used."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Ex: Testing user priv:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"admin has power"}),"\n",(0,s.jsx)(n.li,{children:"peon has none"}),"\n",(0,s.jsx)(n.li,{children:"peon can use function only meant for admin"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"insecure-direct-object-references-idor",children:"Insecure Direct Object References (IDOR)"}),"\n",(0,s.jsx)(n.p,{children:"IDORs are common place in bounties, and hard to catch with scanners."}),"\n",(0,s.jsxs)(n.p,{children:["Find ",(0,s.jsx)(n.strong,{children:"any and all"})," UIDs:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"increment"}),"\n",(0,s.jsx)(n.li,{children:"decrement"}),"\n",(0,s.jsx)(n.li,{children:"negative values"}),"\n",(0,s.jsxs)(n.li,{children:["Attempt to perform sensitive functions substituting another UID","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Change password"}),"\n",(0,s.jsx)(n.li,{children:"Forgot password"}),"\n",(0,s.jsx)(n.li,{children:"Admin only functions"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"logic",children:"Logic"}),"\n",(0,s.jsx)(n.p,{children:"Logic flaws that are tricky, mostly manual:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"substituting hashed parameters"}),"\n",(0,s.jsx)(n.li,{children:"step manipulation"}),"\n",(0,s.jsx)(n.li,{children:"use negative in quantities"}),"\n",(0,s.jsx)(n.li,{children:"authentication bypass"}),"\n",(0,s.jsx)(n.li,{children:"application level DoS"}),"\n",(0,s.jsx)(n.li,{children:"timing attacks"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"data-driven-assessment",children:"Data Driven Assessment"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Visit search, registration, contact, password reset, and comment forms, and hit them with your polyglot strings."}),"\n",(0,s.jsx)(n.li,{children:"Scan those specific functions with Burp's built-in scanner."}),"\n",(0,s.jsx)(n.li,{children:"Check your cookie, log out, check cookie, log in, check cookie. Submit old cookie, see if access."}),"\n",(0,s.jsx)(n.li,{children:"Perform user enumeration checks on login, registration, and password reset."}),"\n",(0,s.jsx)(n.li,{children:"Do a reset and see if, password comes plaintext, uses a URL based token, is predictable, can be used multiple times, or logs you in automatically."}),"\n",(0,s.jsx)(n.li,{children:"Find numeric account identifiers anywhere in URLs and rotate them for context change."}),"\n",(0,s.jsx)(n.li,{children:"Find security-sensitive function(s) of files and see if vulnerable to non-auth browsing (IDORs), lower-auth browsing, CSRF, CSRF protection bypass, and see if they can be done over HTTP."}),"\n",(0,s.jsx)(n.li,{children:"Directory brute for top short lists on SecLists."}),"\n",(0,s.jsx)(n.li,{children:"Check upload functions for alternate file types that can execute code (xss, php, etc...)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"things-to-take-with-you",children:"Things to take with you"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Crowdsourced testing is different enough to pay attention to."}),"\n",(0,s.jsx)(n.li,{children:"Crowdsourcing focuses on the 20% because 80% goes quick."}),"\n",(0,s.jsx)(n.li,{children:"Data analysis can yield the most successfully attacked areas."}),"\n",(0,s.jsx)(n.li,{children:"15 minute web test, done right, could yield a majority of your criticial vulns."}),"\n",(0,s.jsx)(n.li,{children:"Add polyglots to your toolbet."}),"\n",(0,s.jsx)(n.li,{children:"Use SecLists to power your scanners."}),"\n",(0,s.jsx)(n.li,{children:"Remember to periodically referesh your game with the wisdom of other techniques and other approaches."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>o,a:()=>r});var s=i(7294);const t={},l=s.createContext(t);function r(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);