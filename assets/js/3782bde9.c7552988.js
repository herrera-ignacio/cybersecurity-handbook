"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8139],{3062:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var r=n(5893),i=n(1151);const o={},c="ECB block reordering",a={id:"cryptography/attacks/ecb-block-reordering/README",title:"ECB block reordering",description:"Since we know that blocks encrypted with ECB are independent, there's nothing stopping us from arbitrarily reordering them. They'll still decrypt properly.",source:"@site/docs/cryptography/attacks/ecb-block-reordering/README.md",sourceDirName:"cryptography/attacks/ecb-block-reordering",slug:"/cryptography/attacks/ecb-block-reordering/",permalink:"/cybersecurity-handbook/cryptography/attacks/ecb-block-reordering/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Symmetric cryptography",permalink:"/cybersecurity-handbook/cryptography/schemes/symmetric/"},next:{title:"Hash extension / Length extension",permalink:"/cybersecurity-handbook/cryptography/attacks/hash-extension/"}},s={},d=[{value:"ECB Decrpytion",id:"ecb-decrpytion",level:2},{value:"Mitigation",id:"mitigation",level:2},{value:"Never MAC-then-Encrypt",id:"never-mac-then-encrypt",level:3}];function l(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"ecb-block-reordering",children:"ECB block reordering"}),"\n",(0,r.jsx)(t.p,{children:"Since we know that blocks encrypted with ECB are independent, there's nothing stopping us from arbitrarily reordering them. They'll still decrypt properly."}),"\n",(0,r.jsx)(t.p,{children:"Consider a DES-ECB-encrpyted cookie containing the following data:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-txt",children:"admin=0;username=daeken\n"})}),"\n",(0,r.jsx)(t.p,{children:"Because DES uses 8-byte blocks, this means we'd encrypt the following blocks (with @ as padding):"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-txt",children:"admin=0;\nusername\n=daeken@\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Suppouse we control our username. If we set our username to ",(0,r.jsx)(t.code,{children:"paddingadmin=1"})," we get these blocks:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-txt",children:"admin=0;\nusername\n=padding\nadmin=1;\n"})}),"\n",(0,r.jsx)(t.p,{children:"Once we have the encrypted form of this new cookie, we simply take the last block and put it in place of the first. This decrypts to a valid admin cookie!"}),"\n",(0,r.jsx)(t.h2,{id:"ecb-decrpytion",children:"ECB Decrpytion"}),"\n",(0,r.jsx)(t.p,{children:"Likewise, if we have some ability to decrypt ECB ciphertext, we can use the same block concept to decrypt other pieces of data."}),"\n",(0,r.jsx)(t.p,{children:"Simply take the ciphertext block in question and put it into the middle of data that you're able to decrypt. So long as they use the same key, this data will decrypt cleanly, and you're able to compromise the ciphertext in question."}),"\n",(0,r.jsx)(t.h2,{id:"mitigation",children:"Mitigation"}),"\n",(0,r.jsxs)(t.p,{children:["Encrypt your data and then append a ",(0,r.jsx)(t.strong,{children:"MAC"})," of the encrypted data, so attackers cannot tamper with the ciphertext."]}),"\n",(0,r.jsx)(t.h3,{id:"never-mac-then-encrypt",children:"Never MAC-then-Encrypt"}),"\n",(0,r.jsx)(t.p,{children:"When you MAC then encrypt, you have to decrypt the data and then validate the MAC. This introduces a multitude of problems, such as padding oracles."})]})}function h(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>c});var r=n(7294);const i={},o=r.createContext(i);function c(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);