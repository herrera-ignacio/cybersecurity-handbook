<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-networking/attacks/traffic-analysis/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Network traffic analysis | Cybersecurity Handbook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://herrera-ignacio.github.io/cybersecurity-handbook/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://herrera-ignacio.github.io/cybersecurity-handbook/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://herrera-ignacio.github.io/cybersecurity-handbook/networking/attacks/traffic-analysis/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Network traffic analysis | Cybersecurity Handbook"><meta data-rh="true" name="description" content="- Network traffic analysis"><meta data-rh="true" property="og:description" content="- Network traffic analysis"><link data-rh="true" rel="icon" href="/cybersecurity-handbook/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://herrera-ignacio.github.io/cybersecurity-handbook/networking/attacks/traffic-analysis/"><link data-rh="true" rel="alternate" href="https://herrera-ignacio.github.io/cybersecurity-handbook/networking/attacks/traffic-analysis/" hreflang="en"><link data-rh="true" rel="alternate" href="https://herrera-ignacio.github.io/cybersecurity-handbook/networking/attacks/traffic-analysis/" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/cybersecurity-handbook/assets/css/styles.ebb2964c.css">
<script src="/cybersecurity-handbook/assets/js/runtime~main.479a4c56.js" defer="defer"></script>
<script src="/cybersecurity-handbook/assets/js/main.a0365283.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cybersecurity-handbook/"><b class="navbar__title text--truncate">Cybersecurity Handbook</b></a></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/ignacioromanherrera/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/herrera-ignacio/cybersecurity-handbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cybersecurity-handbook/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/fundamentals/bug-bounty/">Fundamentals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cybersecurity-handbook/networking/concepts/devices/">Networking</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cybersecurity-handbook/networking/concepts/devices/">Concepts and practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cybersecurity-handbook/networking/attacks/traffic-analysis/">Attacks</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/cybersecurity-handbook/networking/attacks/traffic-analysis/">Traffic analysis</a><button aria-label="Collapse sidebar category &#x27;Traffic analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cybersecurity-handbook/networking/attacks/traffic-analysis/TCPDump/">TCPDump</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cybersecurity-handbook/networking/attacks/traffic-analysis/Wireshark/">Wireshark</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cybersecurity-handbook/networking/specs/cookies/">Specs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cybersecurity-handbook/networking/standards/ieee802/">Standards</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/cryptography/concepts/hashing/">Cryptography</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/books/hackerplaybook/">Books</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/cert_notes/ccna/">Certifications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/lectures/compliance/hipaa-training/">Lectures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/offensive-security/web-proxies/">Offensive security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/os/linux/file_management/">Operating systems</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/vulnerabilities/server/shellshock/">Vulnerabilities</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cybersecurity-handbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Networking</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Attacks</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Traffic analysis</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Network traffic analysis</h1>
<ul>
<li><a href="#network-traffic-analysis">Network traffic analysis</a>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#useful-knowledge">Useful knowledge</a>
<ul>
<li><a href="#tcpip-stack--osi-model">TCP/IP stack &amp; OSI model</a></li>
<li><a href="#common-ports--protocols">Common ports &amp; protocols</a></li>
<li><a href="#concepts-of-ip-packats-and-sublayers">Concepts of IP packats and sublayers</a></li>
<li><a href="#protocol-transport-encapsulation">Protocol transport encapsulation</a></li>
</ul>
</li>
<li><a href="#environment-and-equipment">Environment and equipment</a></li>
<li><a href="#bpf-syntax">BPF syntax</a></li>
<li><a href="#nta-workflow">NTA workflow</a></li>
</ul>
</li>
<li><a href="#networking-primer">Networking primer</a>
<ul>
<li><a href="#osi-layers-1-4">OSI Layers 1-4</a>
<ul>
<li><a href="#osi-vs-tcpip-models">OSI vs TCP/IP models</a></li>
<li><a href="#pdu-example">PDU example</a></li>
<li><a href="#addressing-mechanisms">Addressing mechanisms</a></li>
</ul>
</li>
<li><a href="#tcp">TCP</a>
<ul>
<li><a href="#tcp-vs-udp">TCP vs UDP</a></li>
<li><a href="#three-way-handshake">Three-way handshake</a></li>
</ul>
</li>
<li><a href="#osi-lasyers-5-7">OSI Lasyers 5-7</a>
<ul>
<li><a href="#http-hypertext-transfer-protocol-80">HTTP: Hypertext Transfer Protocol (80)</a></li>
<li><a href="#https-http-secure-443">HTTPS: HTTP Secure (443)</a></li>
<li><a href="#ftp-file-transfer-protocol-2021">FTP: File Transfer Protocol (20/21)</a></li>
<li><a href="#smb-server-message-block-445">SMB: Server Message Block (445)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#analysis">Analysis</a>
<ul>
<li><a href="#the-analysis-process">The analysis process</a>
<ul>
<li><a href="#analysis-dependencies">Analysis dependencies</a></li>
</ul>
</li>
<li><a href="#analysis-in-practice">Analysis in practice</a>
<ul>
<li><a href="#descriptive-analysis">Descriptive analysis</a></li>
<li><a href="#diagnostic-analysis">Diagnostic analysis</a></li>
<li><a href="#predictive-analysis">Predictive analysis</a></li>
<li><a href="#prescriptive-analysis">Prescriptive analysis</a></li>
</ul>
</li>
<li><a href="#key-components-of-an-effective-analysis">Key components of an effective analysis</a></li>
<li><a href="#analysis-approach">Analysis approach</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p><em>Network traffic analysis (NTA)</em> can be described as the act of examining network traffic to characterize common ports and protocol utilized, establish a baseline for our environment, monitor and repond to threats, and ensure the hreatest possible insight into the network.</p>
<p>This process helps determine anomalies, including security threats in the network, early and effectively pinpoint threats.</p>
<p>Everyday use cases of NTA include:</p>
<ul>
<li><em>Collecting</em> real-time traffic within the network to analyze threats.</li>
<li><em>Setting</em> a baseline for day-to-day network communications.</li>
<li><em>Identifying</em> and <em>analyzing</em> traffic from non-standard ports, suspicious hosts, and issues with networking protocols (HTTP, TCP, etc).</li>
<li><em>Detecting</em> malware on the wire, such as ransomware, exploits, and non-standard interactions.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="useful-knowledge">Useful knowledge<a href="#useful-knowledge" class="hash-link" aria-label="Direct link to Useful knowledge" title="Direct link to Useful knowledge">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tcpip-stack--osi-model">TCP/IP stack &amp; OSI model<a href="#tcpip-stack--osi-model" class="hash-link" aria-label="Direct link to TCP/IP stack &amp; OSI model" title="Direct link to TCP/IP stack &amp; OSI model">​</a></h4>
<p>Understanding what types of traffic we&#x27;ll see at each level includes understanding of the individual layers that make up the TCP/IP and OSI model and the concepts of switching anr routing</p>
<p>We&#x27;ll grasp how networking traffic and the host applications interact.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="common-ports--protocols">Common ports &amp; protocols<a href="#common-ports--protocols" class="hash-link" aria-label="Direct link to Common ports &amp; protocols" title="Direct link to Common ports &amp; protocols">​</a></h4>
<p>Standard ports and protocols facilitate identifying potentially malicious or malformed network traffic.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="concepts-of-ip-packats-and-sublayers">Concepts of IP packats and sublayers<a href="#concepts-of-ip-packats-and-sublayers" class="hash-link" aria-label="Direct link to Concepts of IP packats and sublayers" title="Direct link to Concepts of IP packats and sublayers">​</a></h4>
<p>Foundtional knowledge of how TCP and UDP communicate will, at a minimum, ensure we understand what we see or are searching for.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="protocol-transport-encapsulation">Protocol transport encapsulation<a href="#protocol-transport-encapsulation" class="hash-link" aria-label="Direct link to Protocol transport encapsulation" title="Direct link to Protocol transport encapsulation">​</a></h4>
<p>Each layer will encapsulate the previous. Being able to read or dissect when this encapsulation changes will help us move through data quicker.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="environment-and-equipment">Environment and equipment<a href="#environment-and-equipment" class="hash-link" aria-label="Direct link to Environment and equipment" title="Direct link to Environment and equipment">​</a></h3>
<p>Different tools provide a different way to capture or dissect the traffic. Some offers ways to copy and capture, while others read and ingest.</p>
<table><thead><tr><th>Tool</th><th>Description</th></tr></thead><tbody><tr><td>tcpdump</td><td>tcpdump is a command-line utility that, with the aid of LibPcap, captures and interprets network traffic from a network interface or capture file.</td></tr><tr><td>Tshark</td><td>TShark is a network packet analyzer much like TCPDump. It will capture packets from a live network or read and decode from a file. It is the command-line variant of Wireshark.</td></tr><tr><td>Wireshark</td><td>Wireshark is a graphical network traffic analyzer. It captures and decodes frames off the wire and allows for an in-depth look into the environment. It can run many different dissectors against the traffic to characterize the protocols and applications and provide insight into what is happening.</td></tr><tr><td>NGrep</td><td>NGrep is a pattern-matching tool built to serve a similar function as grep for Linux distributions. The big difference is that it works with network traffic packets. NGrep understands how to read live traffic or traffic from a PCAP file and utilize regex expressions and BPF syntax. This tool shines best when used to debug traffic from protocols like HTTP and FTP.</td></tr><tr><td>tcpick</td><td>tcpick is a command-line packet sniffer that specializes in tracking and reassembling TCP streams. The functionality to read a stream and reassemble it back to a file with tcpick is excellent.</td></tr><tr><td>Network Taps</td><td>Taps (Gigamon, Niagra-taps) are devices capable of taking copies of network traffic and sending them to another place for analysis. These can be in-line or out of band. They can actively capture and analyze the traffic directly or passively by putting the original packet back on the wire as if nothing had changed.</td></tr><tr><td>Networking Span Ports</td><td>Span Ports are a way to copy frames from layer two or three networking devices during egress or ingress processing and send them to a collection point. Often a port is mirrored to send those copies to a log server.</td></tr><tr><td>Elastic Stack</td><td>The Elastic Stack is a culmination of tools that can take data from many sources, ingest the data, and visualize it, to enable searching and analysis of it.</td></tr><tr><td>SIEMS</td><td>SIEMS (such as Splunk) are a central point in which data is analyzed and visualized. Alerting, forensic analysis, and day-to-day checks against the traffic are all use cases for a SIEM.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bpf-syntax">BPF syntax<a href="#bpf-syntax" class="hash-link" aria-label="Direct link to BPF syntax" title="Direct link to BPF syntax">​</a></h3>
<p><a href="https://en.wikipedia.org/wiki/Berkeley_Packet_Filter" target="_blank" rel="noopener noreferrer">Berkpley Packet Filter (BPF)</a> is a syntax/technology shared among tools that enables a raw interface to read and write from the Data-llink layer, providing filtering and decoding abilities.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nta-workflow">NTA workflow<a href="#nta-workflow" class="hash-link" aria-label="Direct link to NTA workflow" title="Direct link to NTA workflow">​</a></h3>
<p>NTA can be a very dynamic process and it&#x27;s greatly influenced by what we are looking for (errors vs malicious actions) and where we have visibility into our network. Nevertheless, traffic analysis can distill down to a few basic tenants.</p>
<p><img loading="lazy" alt="NTA workflow" src="/cybersecurity-handbook/assets/images/image-0284fe73c4a26e5e030808c8dab11348.png" width="980" height="640" class="img_ev3q"></p>
<ol>
<li>Ingest traffic.</li>
<li>Reduce noise by filtering (e.g., broadcast vs multicast traffic).</li>
<li>Analyze and explore (e.g., attempting unauthorized access, uncommon communications?).</li>
<li>Detect and root issue (e.g., IDS/IPS to run heuristics and signatures against the traffic).</li>
<li>(Extra) fix and monitor.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="networking-primer">Networking primer<a href="#networking-primer" class="hash-link" aria-label="Direct link to Networking primer" title="Direct link to Networking primer">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="osi-layers-1-4">OSI Layers 1-4<a href="#osi-layers-1-4" class="hash-link" aria-label="Direct link to OSI Layers 1-4" title="Direct link to OSI Layers 1-4">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="osi-vs-tcpip-models">OSI vs TCP/IP models<a href="#osi-vs-tcpip-models" class="hash-link" aria-label="Direct link to OSI vs TCP/IP models" title="Direct link to OSI vs TCP/IP models">​</a></h4>
<p><img loading="lazy" alt="models" src="/cybersecurity-handbook/assets/images/image-1-47a6c09691c7719c8c43f170f8fb1d11.png" width="2576" height="1533" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Think of the OSI model as the theory behind how everything works, whereas the TCP/IP model is more closely aligned with the actual functionaloty of networking.</p></div></div>
<p>Layers 1-4 of the OSI model are focused on controlling the transportation of data between hosts. This includes everything from the physical medium used for transmission to the protocol utilized to maange the conversation or lack thereof when transporting data.</p>
<p>Layers 5-7 handle the interpretation, management, and presentation of the encapsulated data presented to the end-user.</p>
<p>On the other hand, TCP/IP comprises four layers. Layers 5-7 of OSI align with layer 4 of TCP/IP. Layer 3 deals with transportation (layer 4 in OSI), layer 2 with the internet layer (layer 3 in OSI) and layer 1 is the link-layer (layer 1-2 OSI).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pdu-example">PDU example<a href="#pdu-example" class="hash-link" aria-label="Direct link to PDU example" title="Direct link to PDU example">​</a></h4>
<p>A <em>Protocol Data Unit</em> (PDU) is a data packet made up of control information and data encapsulated from each layer of the OSI model.</p>
<p><img loading="lazy" alt="PDU" src="/cybersecurity-handbook/assets/images/image-2-a08af65a39fe171d024bf2024f23f279.png" width="2576" height="1533" class="img_ev3q"></p>
<p>As our data moves down the protocol stack, each layer will wrap the previous layers&#x27; data in a new bubble we call encapsulation. This adds the necessary information of that layer into the header of the PDU.</p>
<p>The information can vary by level, but it includes what is held by the previous layer, operational flags, any options required to negotiate communications, source and destination IP, ports, tranport and application layer protocols, etc.</p>
<p><img loading="lazy" alt="PDU packet brakedown" src="/cybersecurity-handbook/assets/images/image-3-a18808d98842bfb053861417162b149d.png" width="2064" height="1096" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The image above shows us the makeup of a PDU side by side with a packet breakout from Wireshark&#x27;s Packet Details pane. Note that when we see the breakout in Wireshak, it&#x27;s in reverse order because it&#x27;s in the order that it was <em>unencapsulated</em>.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="addressing-mechanisms">Addressing mechanisms<a href="#addressing-mechanisms" class="hash-link" aria-label="Direct link to Addressing mechanisms" title="Direct link to Addressing mechanisms">​</a></h4>
<p>There are different addressing mechanisms that enable the delivery of our packets to  the correct hosts.</p>
<ul>
<li><em>MAC-Addressing</em>: Each logical/physical interface attached to a host has a <em>Media Access Control</em> address. It&#x27;s utilized in OSI layer 2.</li>
<li><em>IP addressign</em>: IP is responsible for routing packets, the encapsulation of data, and fragmentation and reassembly of datagrams when they reach the destination host. By nature, IP is a connectionless protocol that provides no assurances that data will reach its intended recipient. For the reliability and validation of data delivery, IP relies on upper-layer protocols such as TCP</li>
</ul>
<p>IPv6 es four main types of addresses within its schema:</p>
<ul>
<li><em>Unicast</em>: Addresses for a single interface.</li>
<li><em>Anycast</em>: Addresses for multiple interfaces, where only one of them receives the packet.</li>
<li><em>Multicast</em>: Addresses for multiple interfaces, where all of them receive the same packet.</li>
<li><em>Broadcast</em>: Does not exist and is realized with multicast addresses.</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Along with a much larger address space, IPv6 provides better support for <em>multicasting</em> (traffic from one to many), global addressing per device, security within the protocol in the form of <em>IPSec</em>, simplified packet headers to allow easier processing and move from connection to connetion without being re-assigned an address.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tcp">TCP<a href="#tcp" class="hash-link" aria-label="Direct link to TCP" title="Direct link to TCP">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tcp-vs-udp">TCP vs UDP<a href="#tcp-vs-udp" class="hash-link" aria-label="Direct link to TCP vs UDP" title="Direct link to TCP vs UDP">​</a></h4>
<table><thead><tr><th>Characteristic</th><th>TCP</th><th>UDP</th></tr></thead><tbody><tr><td>Transmission</td><td>Connection-oriented</td><td>Connectionless. Fire and forget.</td></tr><tr><td>Connection Establishment</td><td>TCP uses a three-way handshake to ensure that a connection is established.</td><td>UDP does not ensure the destination is listening.</td></tr><tr><td>Data Delivery</td><td>Stream-based conversations</td><td>Packet by packet, the source does not care if the destination is active</td></tr><tr><td>Receipt of data</td><td>Sequence and Acknowledgement numbers are utilized to account for data.</td><td>UDP does not care.</td></tr><tr><td>Speed</td><td>TCP has more overhead and is slower because of its built-in functions.</td><td>UDP is fast but unreliable.</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="three-way-handshake">Three-way handshake<a href="#three-way-handshake" class="hash-link" aria-label="Direct link to Three-way handshake" title="Direct link to Three-way handshake">​</a></h4>
<p>To ensure the delivery of data from server to client, TCP uses sessions, which are established through a three-way handshake. For this, TCP uses an option in the TCP header called <em>flags</em>.</p>
<p>The common flags we&#x27;ll see in a 3-way handshake are <em>Synchronization (<code>SYN</code>)</em> and <em>Acknowledgment (<code>ACK</code>)</em>.</p>
<p>When a host requests to have a conversation with a server over TCP:</p>
<ol>
<li>The <code>client</code> sends a packet with the <code>SYN</code> flag set to on along with other negotiable options in the TCP header.</li>
<li>The <code>server</code> will respond with a TCP packet that inlcudes a <code>SYN</code> flag set for the sequence number negotiation and an <code>ACK</code> flag set to acknowledge the previous <code>SYN</code> packet sent by the host.</li>
<li>The <code>client</code> will respond with a TCP packet with an `ACK`` flag set agreeing to the negotation.</li>
</ol>
<p><img loading="lazy" alt="3way handshake example" src="/cybersecurity-handbook/assets/images/image-4-602dcd67bb95aaf551c90cdfc942b4cc.png" width="2416" height="888" class="img_ev3q"></p>
<p>We can also see how a session TCP gracefully shuts connections:</p>
<p><img loading="lazy" alt="session concluded example" src="/cybersecurity-handbook/assets/images/image-5-f638beb911ab0a754cf48e6a928ad3da.png" width="1972" height="886" class="img_ev3q"></p>
<p>This set of packets is similar to the 3-way handshake. The <code>FIN</code> flag is used for signaling that the data transfer is finished and the sender is requesting termination of the connection. The client acknowledges the receipt of the data and then sends a <code>FIN</code> and <code>ACK</code> to begin session termination. The server responds with an acnknowledgement of the <code>FIN</code> and sends back its own <code>FIN</code>. Finally, the client acknowledges the session is complete and closes the connection.</p>
<p>We should see the pattern: <code>FIN, ACK</code> -&gt; <code>FIN, ACK</code> -&gt; <code>ACK</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="osi-lasyers-5-7">OSI Lasyers 5-7<a href="#osi-lasyers-5-7" class="hash-link" aria-label="Direct link to OSI Lasyers 5-7" title="Direct link to OSI Lasyers 5-7">​</a></h3>
<p>Here we look at the upper layer protocols that handle our applications.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="http-hypertext-transfer-protocol-80">HTTP: Hypertext Transfer Protocol (80)<a href="#http-hypertext-transfer-protocol-80" class="hash-link" aria-label="Direct link to HTTP: Hypertext Transfer Protocol (80)" title="Direct link to HTTP: Hypertext Transfer Protocol (80)">​</a></h4>
<p>HTTP is a <em>stateless</em> Application Layer protocol that has been in use since 1990. It enables transfer of data in clear text between a client and server over TCP.</p>
<p>A client sends an HTTP request to the server, asking for a resource. A session is established, and the server responds with the requested media.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="https-http-secure-443">HTTPS: HTTP Secure (443)<a href="#https-http-secure-443" class="hash-link" aria-label="Direct link to HTTPS: HTTP Secure (443)" title="Direct link to HTTPS: HTTP Secure (443)">​</a></h4>
<p>HTTPS is designed to utilize <em>Transport Layer Security (TLS)</em> or <em>Secure Sockets Layer (SSL)</em> with older applications for data security. TLS is utilized as an encryption mechanism to secure the communications between a client and a server.</p>
<p>Before the TLS mechanism was in place, we were vulnerable to MiTM attacks and other types of resconnaissance or hijaking.</p>
<p><img loading="lazy" alt="HTTPS example" src="/cybersecurity-handbook/assets/images/image-7-780bcf4cbc03686f48f88660d20e7059.png" width="2416" height="886" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ftp-file-transfer-protocol-2021">FTP: File Transfer Protocol (20/21)<a href="#ftp-file-transfer-protocol-2021" class="hash-link" aria-label="Direct link to FTP: File Transfer Protocol (20/21)" title="Direct link to FTP: File Transfer Protocol (20/21)">​</a></h4>
<p>FTP enables quick data transfer. It&#x27;s established as an insecure protocol, and most users have moved to utilize tools such as SFTP.</p>
<p><img loading="lazy" alt="FTP example" src="/cybersecurity-handbook/assets/images/image-6-6229143bfb5a3f414a875a3d49421692.png" width="1247" height="494" class="img_ev3q"></p>
<p>FTP uses port 20 for data transfer and port 21 for issuing commands.</p>
<p>Here are some commands.</p>
<table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>USER</td><td>specifies the user to log in as.</td></tr><tr><td>PASS</td><td>sends the password for the user attempting to log in.</td></tr><tr><td>PORT</td><td>when in active mode, this will change the data port used.</td></tr><tr><td>PASV</td><td>switches the connection to the server from active mode to passive.</td></tr><tr><td>LIST</td><td>displays a list of the files in the current directory.</td></tr><tr><td>CWD</td><td>will change the current working directory to one specified.</td></tr><tr><td>PWD</td><td>prints out the directory you are currently working in.</td></tr><tr><td>SIZE</td><td>will return the size of a file specified.</td></tr><tr><td>RETR</td><td>retrieves the file from the FTP server.</td></tr><tr><td>QUIT</td><td>ends the session.</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="smb-server-message-block-445">SMB: Server Message Block (445)<a href="#smb-server-message-block-445" class="hash-link" aria-label="Direct link to SMB: Server Message Block (445)" title="Direct link to SMB: Server Message Block (445)">​</a></h4>
<p>SMB is most widely seen in Windows enterprise environments that enables sharing resources between hosts over common networking architectures. It&#x27;s connection-oriented and requires user authentcation from the host to the resource to ensure the user has correct permissions.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>In the past, SMB utilized NetBIOS as its transport mechanism over UDP ports 137 and 138. Since modern changes, SMB now supports direct TCP transport over port 445, NetBIOS over TCP port 139, and even the QUIC protocol.</p></div></div>
<p><img loading="lazy" alt="SMB on the wire" src="/cybersecurity-handbook/assets/images/image-8-72b5c61a72e671fb9fbe8fdc84c78704.png" width="1207" height="604" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="analysis">Analysis<a href="#analysis" class="hash-link" aria-label="Direct link to Analysis" title="Direct link to Analysis">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-analysis-process">The analysis process<a href="#the-analysis-process" class="hash-link" aria-label="Direct link to The analysis process" title="Direct link to The analysis process">​</a></h3>
<p>NTA is a <strong>detailed examination of an event or process</strong>, determining its origin and impact. This means breaking down the data into understandble chunks, examining it for anything that deviates from regular network traffic. Also, we are looking to see what the trends look like within the traffic and determine if it matches a baseline of typical traffic.</p>
<p>On daily basis, NTA live can make it easy to troubleshoot a connection issue or determine if our infrastructure and the corresponding protocols are functioning correctly.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="analysis-dependencies">Analysis dependencies<a href="#analysis-dependencies" class="hash-link" aria-label="Direct link to Analysis dependencies" title="Direct link to Analysis dependencies">​</a></h4>
<p>Traffic capturing can be performed in two ways: <code>active</code> or <code>passive</code>.</p>
<p>With passive, we are just copying data that we can see without directly interacting with the packets.</p>
<p>With active (also referred to as <code>inline</code>), we have a more hands-on approach.</p>
<table><thead><tr><th>Dependencies</th><th>Passive</th><th>Active</th><th>Description</th></tr></thead><tbody><tr><td>Permission</td><td>☑</td><td>☑</td><td>Depending on the organization we are working in, capturing data can be against policy or even against the law in some sensitive areas like healthcare or banking. Be sure always to obtain permission in writing from someone with the proper authority to grant it to you. We may style ourselves as hackers, but we want to stay in the light legally and ethically.</td></tr><tr><td>Mirrored Port</td><td>☑</td><td>☐</td><td>A switch or router network interface configured to copy data from other sources to that specific interface, along with the capability to place your NIC into promiscuous mode. Having packets copied to our port allows us to inspect any traffic destined to the other links we could normally not have visibility over. Since VLANs and switch ports will not forward traffic outside of their broadcast domain, we have to be connected to the segment or have that traffic copied to our specific port. When dealing with wireless, passive can be a bit more complicated. We must be connected to the SSID we wish to capture traffic off of. Just passively listening to the airwaves around us will present us with many SSID broadcast advertisements, but not much else.</td></tr><tr><td>Capture Tool</td><td>☑</td><td>☑</td><td>A way to ingest the traffic. A computer with access to tools like TCPDump, Wireshark, Netminer, or others is sufficient. Keep in mind that when dealing with PCAP data, these files can get pretty large quickly. Each time we apply a filter to it in tools like Wireshark, it causes the application to parse that data again. This can be a resource-intensive process, so make sure the host has abundant resources.</td></tr><tr><td>In-line Placement</td><td>☐</td><td>☑</td><td>Placing a Tap in-line requires a topology change for the network you are working in. The source and destination hosts will not notice a difference in the traffic, but for the sake of routing and switching, it will be an invisible next hop the traffic passes through on its way to the destination.</td></tr><tr><td>Network Tap or Host With Multiple NIC&#x27;s</td><td>☐</td><td>☑</td><td>A computer with two NIC&#x27;s, or a device such as a Network Tap is required to allow the data we are inspecting to flow still. Think of it as adding another router in the middle of a link. To actively capture the traffic, we will be duplicating data directly from the sources. The best placement for a tap is in a layer three link between switched segments. It allows for the capture of any traffic routing outside of the local network. A switched port or VLAN segmentation does not filter our view here.</td></tr><tr><td>Storage and Processing Power</td><td>☑</td><td>☑</td><td>You will need plenty of storage space and processing power for traffic capture off a tap. Much more traffic is traversing a layer three link than just inside a switched LAN. Think of it like this; When we passively capture traffic inside a LAN, it&#x27;s like pouring water into a cup from a water fountain. It&#x27;s a steady stream but manageable. Actively grabbing traffic from a routed link is more like using a water hose to fill up a teacup. There is a lot more pressure behind the flow, and it can be a lot for the host to process and store.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="analysis-in-practice">Analysis in practice<a href="#analysis-in-practice" class="hash-link" aria-label="Direct link to Analysis in practice" title="Direct link to Analysis in practice">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="descriptive-analysis">Descriptive analysis<a href="#descriptive-analysis" class="hash-link" aria-label="Direct link to Descriptive analysis" title="Direct link to Descriptive analysis">​</a></h4>
<p>It serves to describe a data set based on individual characterics and detect possible errors in data collection and/or outliers in the data set.</p>
<ul>
<li>What is the issue?</li>
<li>Define scope and goal (what are we looking for? which time period?).</li>
<li>Define our target(s) (net/host(s)/protocol).</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="diagnostic-analysis">Diagnostic analysis<a href="#diagnostic-analysis" class="hash-link" aria-label="Direct link to Diagnostic analysis" title="Direct link to Diagnostic analysis">​</a></h4>
<p>It clarifies the causes, effects, and interactions of conditions. It provides insights that are obtained through correlations and interpretation. It tries to <strong>find reasons for events</strong>.</p>
<ul>
<li>Capture network traffic.</li>
<li>Identification of required network traffic components (filtering).</li>
<li>Understanding of captured network traffic.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="predictive-analysis">Predictive analysis<a href="#predictive-analysis" class="hash-link" aria-label="Direct link to Predictive analysis" title="Direct link to Predictive analysis">​</a></h4>
<p>By evaluating historical and current data, predictive analysis creates a predictive model for future probabilities. It makes it possible to identify trends, detect deviations from expected values at an early stage, and predict future occurrences as accurately as possible.</p>
<ul>
<li>Note-taking and mind mapping of the found results.</li>
<li>Summary of the analysis (what did we find?).</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="prescriptive-analysis">Prescriptive analysis<a href="#prescriptive-analysis" class="hash-link" aria-label="Direct link to Prescriptive analysis" title="Direct link to Prescriptive analysis">​</a></h4>
<p>It aims to narrow down what actions to take to eliminate or prevente a future problem or trigger a specific activity or process. We can make sound decisions as to what actions are required. <strong>To prescrive a solution is the culmination of this workflow</strong>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-components-of-an-effective-analysis">Key components of an effective analysis<a href="#key-components-of-an-effective-analysis" class="hash-link" aria-label="Direct link to Key components of an effective analysis" title="Direct link to Key components of an effective analysis">​</a></h3>
<ol>
<li>Know your environment.</li>
<li>Placement is key.</li>
<li>Persistence.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="analysis-approach">Analysis approach<a href="#analysis-approach" class="hash-link" aria-label="Direct link to Analysis approach" title="Direct link to Analysis approach">​</a></h3>
<p>Some easy wins when looking at traffic and finding problems:</p>
<ol>
<li>Start with standard protocols and work your way into the austere and specific only to the organization.</li>
<li>Look for paterns in our traffic data.</li>
<li>Check anything <em>host to host</em> as they will rarely talk to each other.</li>
<li>Look for <em>unique</em> events.</li>
<li>Don&#x27;t be afraid to ask for help.</li>
</ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cybersecurity-handbook/networking/concepts/whatwg/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">WHATWG</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cybersecurity-handbook/networking/attacks/traffic-analysis/TCPDump/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">TCPDump</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a><ul><li><a href="#useful-knowledge" class="table-of-contents__link toc-highlight">Useful knowledge</a></li><li><a href="#environment-and-equipment" class="table-of-contents__link toc-highlight">Environment and equipment</a></li><li><a href="#bpf-syntax" class="table-of-contents__link toc-highlight">BPF syntax</a></li><li><a href="#nta-workflow" class="table-of-contents__link toc-highlight">NTA workflow</a></li></ul></li><li><a href="#networking-primer" class="table-of-contents__link toc-highlight">Networking primer</a><ul><li><a href="#osi-layers-1-4" class="table-of-contents__link toc-highlight">OSI Layers 1-4</a></li><li><a href="#tcp" class="table-of-contents__link toc-highlight">TCP</a></li><li><a href="#osi-lasyers-5-7" class="table-of-contents__link toc-highlight">OSI Lasyers 5-7</a></li></ul></li><li><a href="#analysis" class="table-of-contents__link toc-highlight">Analysis</a><ul><li><a href="#the-analysis-process" class="table-of-contents__link toc-highlight">The analysis process</a></li><li><a href="#analysis-in-practice" class="table-of-contents__link toc-highlight">Analysis in practice</a></li><li><a href="#key-components-of-an-effective-analysis" class="table-of-contents__link toc-highlight">Key components of an effective analysis</a></li><li><a href="#analysis-approach" class="table-of-contents__link toc-highlight">Analysis approach</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>