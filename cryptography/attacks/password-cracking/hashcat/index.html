<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cryptography/attacks/password-cracking/hashcat/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Hashcat | Cybersecurity Handbook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://herrera-ignacio.github.io/cybersecurity-handbook/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://herrera-ignacio.github.io/cybersecurity-handbook/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://herrera-ignacio.github.io/cybersecurity-handbook/cryptography/attacks/password-cracking/hashcat/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Hashcat | Cybersecurity Handbook"><meta data-rh="true" name="description" content="- Hashcat"><meta data-rh="true" property="og:description" content="- Hashcat"><link data-rh="true" rel="icon" href="/cybersecurity-handbook/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://herrera-ignacio.github.io/cybersecurity-handbook/cryptography/attacks/password-cracking/hashcat/"><link data-rh="true" rel="alternate" href="https://herrera-ignacio.github.io/cybersecurity-handbook/cryptography/attacks/password-cracking/hashcat/" hreflang="en"><link data-rh="true" rel="alternate" href="https://herrera-ignacio.github.io/cybersecurity-handbook/cryptography/attacks/password-cracking/hashcat/" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/cybersecurity-handbook/assets/css/styles.ebb2964c.css">
<script src="/cybersecurity-handbook/assets/js/runtime~main.6c5d224e.js" defer="defer"></script>
<script src="/cybersecurity-handbook/assets/js/main.f10f54bc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cybersecurity-handbook/"><b class="navbar__title text--truncate">Cybersecurity Handbook</b></a></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/ignacioromanherrera/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/herrera-ignacio/cybersecurity-handbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cybersecurity-handbook/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/fundamentals/cid/">Fundamentals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/networking/concepts/devices/">Networking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cybersecurity-handbook/cryptography/concepts/hashing/">Cryptography</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cybersecurity-handbook/cryptography/concepts/hashing/">Concepts and practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cybersecurity-handbook/cryptography/schemes/asymmetric/">Schemes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cybersecurity-handbook/cryptography/attacks/ecb-block-reordering/">Attacks</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cybersecurity-handbook/cryptography/attacks/ecb-block-reordering/">ECB block reordering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cybersecurity-handbook/cryptography/attacks/hash-extension/">Hash extension / Length extension</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cybersecurity-handbook/cryptography/attacks/padding-oracle/">Padding oracle</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/cybersecurity-handbook/cryptography/attacks/password-cracking/hashcat/">Psasword cracking</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cybersecurity-handbook/cryptography/attacks/password-cracking/hashcat/">Hashcat</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cybersecurity-handbook/cryptography/attacks/stream-cipher-reuse/">Stream cipher reuse / Reused key</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cybersecurity-handbook/cryptography/attacks/wordlists/">Wordlists</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cybersecurity-handbook/cryptography/cryptosystems/digital_signature/">Cryptosystems</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/books/hackerplaybook/">Books</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cybersecurity-handbook/bug_bounty/">Bug bounty</a><button aria-label="Expand sidebar category &#x27;Bug bounty&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/cert_notes/ccna/">Certifications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cybersecurity-handbook/information_gathering/">Information Gathering</a><button aria-label="Expand sidebar category &#x27;Information Gathering&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/lectures/compliance/hipaa-training/">Lectures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/offensive-security/javascript_deobfuscation/">Offensive security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/os/linux/file_management/">Operating systems</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cybersecurity-handbook/vulnerabilities/server/shellshock/">Other vulnerabilities</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cybersecurity-handbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cryptography</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Attacks</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Psasword cracking</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Hashcat</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Hashcat</h1>
<ul>
<li><a href="#hashcat">Hashcat</a>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#hashing">Hashing</a>
<ul>
<li><a href="#algorithms-for-password-protection">Algorithms for password protection</a></li>
<li><a href="#salting">Salting</a></li>
</ul>
</li>
<li><a href="#encryption">Encryption</a>
<ul>
<li><a href="#symmetric-encryption">Symmetric encryption</a></li>
<li><a href="#aymmetric-encryption">Aymmetric encryption</a></li>
</ul>
</li>
<li><a href="#identifing-hashes">Identifing hashes</a>
<ul>
<li><a href="#hashid">Hashid</a></li>
<li><a href="#context-is-important">Context is important</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#hashcat-specifics">Hashcat specifics</a>
<ul>
<li><a href="#hashcat-overview">Hashcat overview</a></li>
<li><a href="#dictionary-attack">Dictionary attack</a></li>
<li><a href="#combination-attack">Combination attack</a></li>
<li><a href="#mask-attack">Mask attack</a></li>
<li><a href="#hybrid-attack">Hybrid attack</a></li>
</ul>
</li>
<li><a href="#creating-custom-wordlists">Creating custom wordlists</a></li>
<li><a href="#working-with-rules">Working with rules</a>
<ul>
<li><a href="#example-rule-creation">Example rule creation</a></li>
<li><a href="#example-rule-based-attack">Example rule-based attack</a></li>
<li><a href="#built-in-defaults">Built-in defaults</a></li>
</ul>
</li>
<li><a href="#cracking">Cracking</a>
<ul>
<li><a href="#cracking-common-hashes">Cracking common hashes</a>
<ul>
<li><a href="#common-hash-types">Common hash types</a></li>
<li><a href="#example-1-database-dumps">Example 1: Database dumps</a></li>
<li><a href="#example-2-linux-shadow-file">Example 2: Linux shadow file</a></li>
<li><a href="#example-3-common-active-directory-hash-types">Example 3: Common active directory hash types</a></li>
<li><a href="#ntlm">NTLM</a></li>
<li><a href="#netntlmv2">NetNTLMv2</a></li>
</ul>
</li>
<li><a href="#cracking-miscellaneous-files--hashes">Cracking miscellaneous files &amp; hashes</a>
<ul>
<li><a href="#example-1-microsoft-office-documents">Example 1: Microsoft Office documents</a></li>
<li><a href="#example-2-zip-files">Example 2: ZIP files</a></li>
<li><a href="#example-3-keepass-files">Example 3: KeePass files</a></li>
<li><a href="#example-4-pdf-files">Example 4: PDF files</a></li>
</ul>
</li>
<li><a href="#cracking-wpawpa2-handshakes">Cracking WPA/WPA2 handshakes</a>
<ul>
<li><a href="#cracking-mic">Cracking MIC</a></li>
<li><a href="#cracking-pmkid">Cracking PMKID</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h3>
<p>Password cracking attempts to recover the original data, from either hashed or encrypted data, by performing brute force attacks against various algorithms and divulge the cleartext password.</p>
<p>Weak and reused passwords are two major factors that can determine the success of this attack. Additionally, attackers can create fine-tuned wordlists and use rules to mutate the passwords based on the target application or environment.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>We&#x27;ll start with a popular tool <code>Hashcat</code> but a variety of open-source tools exist.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hashing">Hashing<a href="#hashing" class="hash-link" aria-label="Direct link to Hashing" title="Direct link to Hashing">​</a></h3>
<p>Hashing is the process of <strong>converting some text to a string, which is unique to that particular text</strong>. Usually, a hash function returns hashes with the same length irrespective of the type, length, or size of the data.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Hashing can be used for various purposes; for example, the <em>MD5</em> and <em>SHA256</em> algorithms are usually used to verify file integrity, while algorithms such as <em>PBKDF2</em> are used to hash passwords before storage.</p></div></div>
<p>It&#x27;s a <strong>one-way process</strong>, meaning there is no way of reconstructing the original plaintext from a hash. Some hash functions can be <em>keyed</em> (i.e., an additional secret is used to create the hash) like HMAC, which acts as a <em>checksum</em> to mverify if a particular message was tampered with.</p>
<p>Because of this, the only way to attack it is to use a list containing possible passwords. Each password from the the list is hashed and compared to the original hash.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Some hash functions, such as MD5, have been vulnerable to <em>collisions</em>, where two sets of plaintext can produce the same hash.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="algorithms-for-password-protection">Algorithms for password protection<a href="#algorithms-for-password-protection" class="hash-link" aria-label="Direct link to Algorithms for password protection" title="Direct link to Algorithms for password protection">​</a></h4>
<p>Mainly four algorithms are used to protect passwords on Unix systems:</p>
<ul>
<li><em>SHA-512</em>: Converts a long string of characters into a hash value fast and efficiently, but there are many <em>rainbow table attacks</em>.</li>
<li><em>Blowfish</em> is a symmetric block cipher algorithm that encrypts a password with a key. It&#x27;s more secure than SHA-512 but slower.</li>
<li><em>Bcrypt</em> uses a slow hash function to make it hard for potential attackers to perform rainbow table attacks.</li>
<li><em>Argon2</em> is a modern and secure algorithm explicitly designed for password hashing systems. It uses multiple rounds of hash functions and a large amount of memory to make it harder for attackers to guess passwords. It&#x27;s considered <strong>one of the most secure</strong> algorithms because of this.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="salting">Salting<a href="#salting" class="hash-link" aria-label="Direct link to Salting" title="Direct link to Salting">​</a></h4>
<p>Salting is a protection employed against the brute-forcing of hashes. A <em>salt</em> is a random piece of data added to the plaintext before hashing it. An attacker trying to crack this hash will have to sacrifice extra time to append the salt before calculating the hash.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="encryption">Encryption<a href="#encryption" class="hash-link" aria-label="Direct link to Encryption" title="Direct link to Encryption">​</a></h3>
<p>Encryption is the process of converting data into a format in which the original content is not accessible. Unlike hashing, <strong>encryption is reversible</strong>, it&#x27;s possible to decrypt the ciphertext (encrypted data) and obtain the original content.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Some classic examples of encryption ciphers are the Caesar cipher, Bacon&#x27;s cipher and Substitution cipher.</p></div></div>
<p>There are two types of encryption algorithms: <em>Symmetric</em> and <em>Asymmetric</em>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="symmetric-encryption">Symmetric encryption<a href="#symmetric-encryption" class="hash-link" aria-label="Direct link to Symmetric encryption" title="Direct link to Symmetric encryption">​</a></h4>
<p>Symmetric algorithms use a key or secret to encrypt the data and use the same key to decrypt it (e.g., XOR algorithm).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aymmetric-encryption">Aymmetric encryption<a href="#aymmetric-encryption" class="hash-link" aria-label="Direct link to Aymmetric encryption" title="Direct link to Aymmetric encryption">​</a></h4>
<p>Asymmetric algortihms divide the key into two parts (i.e., public and private). The public key can be given to anyone who wishes tn encrypt information and pass it securely to the owner. The owner then uses their private key to decrypt the content.</p>
<p>Some examples are RSA, ECDSA, and Diffie-Hellman.</p>
<p>One of the prominent uses of asymmetric encryption is <em>HTTPS (Hypertext Transfer Protocol Secure)</em> protocol in the form of <em>SSL (Secure Socketys Layer)</em>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>When a client connects to a server using <em>HTTPS</em>, a public key exchange occurs. The client&#x27;s browser uses this public key to encrypt any kind of data sent to the server. The server decrypts the incoming traffic before passing it on to the processing service.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="identifing-hashes">Identifing hashes<a href="#identifing-hashes" class="hash-link" aria-label="Direct link to Identifing hashes" title="Direct link to Identifing hashes">​</a></h3>
<p>Most hashing algorithms produce hashes of a constant length. Te length can be used to map it to the algorithm it was hashed with. For example, a hash of 32 characters in length can be an MD5 or NTLM hash.</p>
<p>Sometimes, hashes are stored in certain formats. For example, <code>hash:salt</code> or <code>$id$salt$hash</code>.</p>
<p>The hash <code>$6$vb1tLY1qiY$M.1ZCqKtJBxBtZm1gRi8Bbkn39KU0YJW1cuMFzTRANcNKFKR4RmAQVk4rqQQCkaJT6wXqjUkFcA/qNxLyqW.U/</code> contains three fields delimited by <code>$</code>, where the first field is the <code>id</code> (i.e., 6). This is used to identify the type of algorithm used for hashing.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$1$  : MD5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$2a$ : Blowfish</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$2y$ : Blowfish, with correct handling of 8 bit characters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$5$  : SHA256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$6$  : SHA512</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Open and closed source software use many different kinds of hash formats. For exapmle, Apache web server stores its hashes in the format <code>$apr1$71850310$gh9m4xcAn3MGxogwX/ztb.</code> while Wordpress stores them in the form <code>$P$984478476IagS59wHZvyQMArzfx58u.</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="hashid">Hashid<a href="#hashid" class="hash-link" aria-label="Direct link to Hashid" title="Direct link to Hashid">​</a></h4>
<p>Hashid is a Python tool used to detect various kinds of hashes. At the time of writing, <code>hashid</code> can be used to identify over 200 unique hash types, and for others, it will make a best-effort guess.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ pip install hashid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hashid &#x27;$apr1$71850310$gh9m4xcAn3MGxogwX/ztb.&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Analyzing &#x27;$apr1$71850310$gh9m4xcAn3MGxogwX/ztb.&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] MD5(APR) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Apache MD5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If known, <code>hashid</code> can also provide the corresponding <em>Hashcat</em> mode with the <code>-m</code> flag if it is able to determine the hash type.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ hashid &#x27;$DCC2$10240#tom#e4e938d12fe5974dc42a90120bd9c90f&#x27; -m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Analyzing &#x27;$DCC2$10240#tom#e4e938d12fe5974dc42a90120bd9c90f&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Domain Cached Credentials 2 [Hashcat Mode: 2100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="context-is-important">Context is important<a href="#context-is-important" class="hash-link" aria-label="Direct link to Context is important" title="Direct link to Context is important">​</a></h4>
<p>It is not always possible to identify the algorithm based on the obtained hash. Depending on the software, the plaintext might undergo multiple encryption rounds and salting transformations.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Knowing where the hash came from will greatly help us narrow down the hash type and therefore, the Hashcat hash mode necessary to attmept to crack it.</p></div></div>
<p>We usually have some context around tye type of hash we are looking to identify. Was it obtained via an Active Directory attack or from a Windows host? Was it obtained through the successful exploitation of a SQLi vunlerability?</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hashcat-specifics">Hashcat specifics<a href="#hashcat-specifics" class="hash-link" aria-label="Direct link to Hashcat specifics" title="Direct link to Hashcat specifics">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hashcat-overview">Hashcat overview<a href="#hashcat-overview" class="hash-link" aria-label="Direct link to Hashcat overview" title="Direct link to Hashcat overview">​</a></h3>
<p>Hashcat can be downloaded from its <a href="https://hashcat.net/hashcat/" target="_blank" rel="noopener noreferrer">website</a> or the official <a href="https://github.com/hashcat/hashcat" target="_blank" rel="noopener noreferrer">repo</a>. Any other repos (i.e., installing from <code>apt</code>), are left up to the 3rd party to keep up-to-date.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install hashcat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>-a</code> and <code>-m</code> arguments are used to specify the type of attack mode and hash type.</p>
<p>Hashcat supports the following attack modes:</p>
<ul>
<li>0: Straight</li>
<li>1: Combination</li>
<li>3: Brute-force</li>
<li>6: Hybrid Wordlist + Mask</li>
<li>7: Hybrid Mask + Wordlist</li>
</ul>
<p>You can see the list of hash types and examples with <code>hashcat --example-hashes | less</code> or <a href="https://github.com/BrashEndeavours/brashendeavours.gitbook.io/blob/master/pentesting-cheatsheets/hashcat-hash-modes.md" target="_blank" rel="noopener noreferrer">here</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dictionary-attack">Dictionary attack<a href="#dictionary-attack" class="hash-link" aria-label="Direct link to Dictionary attack" title="Direct link to Dictionary attack">​</a></h3>
<p>Hashcat&#x27;s most straightforward but extremley effective attack. The attack reads from a wordlist and tries to crack the supplied hashes.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m &lt;hash type&gt; &lt;hash file&gt; &lt;wordlist&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>You can get password lists from different sources like <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords" target="_blank" rel="noopener noreferrer">SecLists (rockyou.txt)</a> or <a href="https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm" target="_blank" rel="noopener noreferrer">CrackStation&#x27;s Password Cracking Dictionary</a>.</p></div></div>
<p>For example, the following commands will crack a SHA256 hash:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ echo -n &#x27;!academy&#x27; | sha256sum | cut -f1 -d&#x27; &#x27; &gt; sha256_hash_example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hashcat -a 0 -m 1400 sha256_hash_example /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hashcat (v6.1.1) starting...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;SNIP&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dictionary cache built:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Filename..: /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Passwords.: 14344392</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Bytes.....: 139921507</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Keyspace..: 14344385</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Runtime...: 2 secs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Approaching final keyspace - workload adjusted.  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">006fc3a9613f3edd9f97f8e8a8eff3b899a2d89e1aabf33d7cc04fe0728b0fe6:!academy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Session..........: hashcat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status...........: Cracked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash.Name........: SHA2-256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash.Target......: 006fc3a9613f3edd9f97f8e8a8eff3b899a2d89e1aabf33d7cc...8b0fe6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Time.Started.....: Fri Aug 28 21:58:44 2020 (4 secs)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Time.Estimated...: Fri Aug 28 21:58:48 2020 (0 secs)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Guess.Base.......: File (/opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Guess.Queue......: 1/1 (100.00%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Speed.#1.........:  3383.5 kH/s (0.46ms) @ Accel:1024 Loops:1 Thr:1 Vec:8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Recovered........: 1/1 (100.00%) Digests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Progress.........: 14344385/14344385 (100.00%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rejected.........: 0/14344385 (0.00%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Restore.Point....: 14340096/14344385 (99.97%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidates.#1....: $HEX[216361726f6c796e] -&gt; $HEX[042a0337c2a156616d6f732103]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Started: Fri Aug 28 21:58:05 2020</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopped: Fri Aug 28 21:58:49 2020</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Consider a more complex hash such as <em>Bcrypt</em> (based on the <em>Blowfish cipher</em>). It utilizes a salt to protect it from rainbow table attacks and can have many rounds of the algorithm applied.</p>
<p>At any time during the cracking process, you can hit the &quot;s&quot; key to get a status on the cracking job, which shows that to attempt every password in the rockyou.txt wordlist will take over 1.5 hours. Applying more rounds of the algorithm will increase cracking time exponentially.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[s]tatus [p]ause [b]ypass [c]heckpoint [q]uit =&gt; s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Session..........: hashcat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status...........: Running</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash.Name........: bcrypt $2*$, Blowfish (Unix)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hash.Target......: $2a$05$ZdEkj8cup/JycBRn2CX.B.nIceCYR8GbPbCCg6RlD7uv...exEbVy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Time.Started.....: Mon Jun 22 19:43:40 2020 (3 mins, 10 secs)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Time.Estimated...: Mon Jun 22 21:20:28 2020 (1 hour, 33 mins)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Guess.Queue......: 1/1 (100.00%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Speed.#1.........:     2470 H/s (8.98ms) @ Accel:8 Loops:16 Thr:1 Vec:8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Recovered........: 0/1 (0.00%) Digests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Progress.........: 468576/14344385 (3.27%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rejected.........: 0/468576 (0.00%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Restore.Point....: 468576/14344385 (3.27%)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:16-32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Candidates.#1....: septiembre29 -&gt; sep1101</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>In the case of hashes such as bcrypt, it is often better to use smaller, more targeted, wordlists.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="combination-attack">Combination attack<a href="#combination-attack" class="hash-link" aria-label="Direct link to Combination attack" title="Direct link to Combination attack">​</a></h3>
<p>The combination attack modes take in two wordlists as input and create combinations from them. This attack is useful because it is not uncommon for users to join two or more words together.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 1 -m &lt;hash type&gt; &lt;hash file&gt; &lt;wordlist1&gt; &lt;wordlist2&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mask-attack">Mask attack<a href="#mask-attack" class="hash-link" aria-label="Direct link to Mask attack" title="Direct link to Mask attack">​</a></h3>
<p>Mask attacks are used to generate words matching a specific pattern. It&#x27;s particularly useful when the password length or format is known. A mask can be created using static characters, range of characters (e.g., [a-z] or [A-Z0-9]), or placeholders.</p>
<table><thead><tr><th>Placeholder</th><th>Meaning</th></tr></thead><tbody><tr><td>?l</td><td>lower-case ASCII letters (a-z)</td></tr><tr><td>?u</td><td>upper-case ASCII letters (A-Z)</td></tr><tr><td>?d</td><td>digits (0-9)</td></tr><tr><td>?h</td><td>0123456789abcdef</td></tr><tr><td>?H</td><td>0123456789ABCDEF</td></tr><tr><td>?s</td><td>special characters <code>«space»!&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[]^_{</code></td></tr><tr><td>?a</td><td>?l?u?d?s</td></tr><tr><td>?b</td><td>0x00 - 0xff</td></tr></tbody></table>
<p>Consider the company Inlane Freight, with password with the scheme <code>ILFREIGHT&lt;userid&gt;&lt;year&gt;</code>, where userid is 5 characters long. The mask <code>ILFREIGHT?l?l?l?l?l20[0-1]?d</code> can be used to crack password with the specified pattern, where <code>?l</code> is a letter and <code>20[0-1]?d</code> will include all years from 2000 to 2019.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Placeholders can be combined with options <code>-1</code> to <code>-4</code> which can be used for custom placeholders. For example providing the option <code>-1 01</code> enables you to use <code>?1</code> as a placeholder to specify just 0 and 1.</p></div></div>
<p>For example, create a hash:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo -n &#x27;ILFREIGHTabcxy2015&#x27; | md5sum | tr -d &quot; -&quot; &gt; md5_mask_example_hash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And then, try to crack it:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 3 -m 0 md5_mask_example_hash -1 01 &#x27;ILFREIGHT?l?l?l?l?l20?1?d&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>The <code>--increment</code> flag can be used to increment the mask length automatically, with a length limit that can be supplied using the <code>--increment-max</code>.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hybrid-attack">Hybrid attack<a href="#hybrid-attack" class="hash-link" aria-label="Direct link to Hybrid attack" title="Direct link to Hybrid attack">​</a></h3>
<p>Hybrid mode is a variation of the combinator attack, wherein multiple modes can be used together for a fine-tuned wordlist creation. It&#x27;s particularly useful when you know or have a general idea of the organization&#x27;s password policy.</p>
<p>For example, consider a password such as <code>football1$</code>.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo -n &#x27;football1$&#x27; | md5sum | tr -d &quot; -&quot; &gt; hybrid_hash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Attack mode <code>6</code> reads words from the wordlist and appends a unique string based on the mask supplied. In this case, the mask <code>?d?s</code> tells hashcat to append a digit and a special character at the end of each word in the <code>rockyou.txt</code> wordlist.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 6 -m 0 hybrid_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt &#x27;?d?s&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As another example, consider the password <code>2015football</code>.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo -n &#x27;2015football&#x27; | md5sum | tr -d &quot; -&quot; &gt; hybrid_hash_prefix </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Attack mode <code>7</code> can be used to prepend characters to words using a given mask. In this case, the mask <code>20?1?d</code> with custom character set <code>-1 01</code> will prepend various years to each word in the wordlist (i.e., 2010, 2011, 2012...).</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> hashcat -a 7 -m 0 hybrid_hash_prefix -1 01 &#x27;20?1?d&#x27; /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-custom-wordlists">Creating custom wordlists<a href="#creating-custom-wordlists" class="hash-link" aria-label="Direct link to Creating custom wordlists" title="Direct link to Creating custom wordlists">​</a></h2>
<p>There are many open-source tools that help creating wordlists (<a href="/cybersecurity-handbook/cryptography/attacks/wordlists">see wordlists section</a>).</p>
<p>By default, hashcate stores stores all cracked passwords in the <code>hashcat.potfile</code> file, in the format <code>hash:password</code>. You can display cracked passwords with the <code>--show</code> command. This can be used to create new wordlists of previously cracked passwords.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cut -d: -f 2- ~/hashcat.potfile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Also, the <a href="https://github.com/hashcat/hashcat-utils" target="_blank" rel="noopener noreferrer">hashcat-utils repo</a> contains many utilities that can be useful for more advanced password cracking. The tool <a href="https://github.com/hashcat/maskprocessor" target="_blank" rel="noopener noreferrer">maskprocessor</a>, for example, can be used to create wordlists using a given mask (e.g., append special characters to the end of a word):</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ /mp64.bin Welcome?s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;SNIP&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-rules">Working with rules<a href="#working-with-rules" class="hash-link" aria-label="Direct link to Working with rules" title="Direct link to Working with rules">​</a></h2>
<p>The <em>rule-based attack</em> is the most advanced and complex password cracking mode. Rules help perform various operations on the input wordlist, such as prefixing, suffixing, toggling case, cutting, reversing, and much more. Rules take <em>mask-based attacks</em> to another level and provide increased cracking rates. Additionally, the usage of rules saves disk space and processing time incurred as a result of larger wordlists.</p>
<p>A rule can be created using functions, which takes a word as an input and output its modified version. The following table describes some functions which are compatible with JtR as well as Hashcat (<a href="https://hashcat.net/wiki/doku.php?id=rule_based_attack#implemented_compatible_functions" target="_blank" rel="noopener noreferrer">here&#x27;s the complete list</a>)</p>
<table><thead><tr><th>Function</th><th>Description</th><th>Input</th><th>Output</th></tr></thead><tbody><tr><td>l</td><td>Convert all letters to lowercase</td><td>InlaneFreight2020</td><td>inlanefreight2020</td></tr><tr><td>u</td><td>Convert all letters to uppercase</td><td>InlaneFreight2020</td><td>INLANEFREIGHT2020</td></tr><tr><td>c / C</td><td>capitalize / lowercase first letter and invert the rest</td><td>inlaneFreight2020 / Inlanefreight2020</td><td>Inlanefreight2020 / iNLANEFREIGHT2020</td></tr><tr><td>t / TN</td><td>Toggle case : whole word / at position N</td><td>InlaneFreight2020</td><td>iNLANEfREIGHT2020</td></tr><tr><td>d / q / zN / ZN</td><td>Duplicate word / all characters / first character / last character</td><td>InlaneFreight2020</td><td>InlaneFreight2020InlaneFreight2020 / IInnllaanneeFFrreeiigghhtt22002200 / IInlaneFreight2020 / InlaneFreight20200</td></tr><tr><td><code>{ / }</code></td><td>Rotate word left / right</td><td>InlaneFreight2020</td><td>nlaneFreight2020I / 0InlaneFreight202</td></tr><tr><td>^X / $X</td><td>Prepend / Append character X</td><td>InlaneFreight2020 (^! / $! )</td><td>!InlaneFreight2020 / InlaneFreight2020!</td></tr><tr><td>r</td><td>Reverse</td><td>InlaneFreight2020</td><td>0202thgierFenalnI</td></tr></tbody></table>
<p>Also, words with length less than N can be rejected with <code>&gt;N</code>, while words greater than N can be rejected with <code>&lt;N</code> <a href="https://hashcat.net/wiki/doku.php?id=rule_based_attack#rules_used_to_reject_plains" target="_blank" rel="noopener noreferrer">here&#x27;s the list of rejection rules</a>.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>There are a variety of publicly available rules such as the <a href="https://github.com/NSAKEY/nsa-rules" target="_blank" rel="noopener noreferrer">nsa-rules</a>, <a href="https://github.com/praetorian-code/Hob0Rules" target="_blank" rel="noopener noreferrer">Hob0Rules</a> and <a href="https://github.com/sparcflow/HackLikeALegend/blob/master/old/chap3/corporate.rule" target="_blank" rel="noopener noreferrer">corporate.rule</a></p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-rule-creation">Example rule creation<a href="#example-rule-creation" class="hash-link" aria-label="Direct link to Example rule creation" title="Direct link to Example rule creation">​</a></h3>
<p><code>L33tspeak</code> is a common but efficient technique of replacing letters with similar numbers, like <code>o</code> can be replaced with <code>0</code> or <code>i</code> can be replaced with <code>1</code>.</p>
<p>Consider the following rules:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">c so0 si1 se3 ss5 sa@ $2 $0 $1 $9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol>
<li>The first letter word is capitalized with the <code>c</code> function.</li>
<li>The substitute function <code>s</code> is sued to replace <code>o</code> with <code>0</code>, <code>i</code> with <code>1</code>, <code>e</code> with <code>3</code>, and <code>a</code> with <code>@</code>. At the end.</li>
<li>At the end, the year <code>2019</code> is appended to it.</li>
</ol>
<p>You can test this with a single word:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ hashcat -r rule.txt &#x27;password_ilfreight&#x27; --stdout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P@55w0rd_1lfr31ght2019</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-rule-based-attack">Example rule-based attack<a href="#example-rule-based-attack" class="hash-link" aria-label="Direct link to Example rule-based attack" title="Direct link to Example rule-based attack">​</a></h3>
<p>Consider the password <code>St@r5h1p2019</code> hashed with <code>SHA1</code>:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo -n &#x27;St@r5h1p2019&#x27; | sha1sum | awk &#x27;{print $1}&#x27; | tee hash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We can the use the rule <code>c so0 si1 se3 ss5 sa@ $2 $0 $1 $9</code> and the <code>rockyou.txt</code> dictionary file to crack the hash using Hashcat.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;c so0 si1 se3 ss5 sa@ $2 $0 $1 $9&#x27; &gt; rule.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 100 hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt -r rule.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="built-in-defaults">Built-in defaults<a href="#built-in-defaults" class="hash-link" aria-label="Direct link to Built-in defaults" title="Direct link to Built-in defaults">​</a></h3>
<p>Hashcat installs with a variety of rules by default:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">]$ ls -l /usr/share/hashcat/rules/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total 2576</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root    933 Jun 19 06:20 best64.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root    633 Jun 19 06:20 combinator.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 200188 Jun 19 06:20 d3ad0ne.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 788063 Jun 19 06:20 dive.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 483425 Jun 19 06:20 generated2.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root  78068 Jun 19 06:20 generated.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 1 root root   2804 Jul  9 21:01 hybrid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 309439 Jun 19 06:20 Incisive-leetspeak.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root  35280 Jun 19 06:20 InsidePro-HashManager.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root  19478 Jun 19 06:20 InsidePro-PasswordsPro.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root    298 Jun 19 06:20 leetspeak.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root   1280 Jun 19 06:20 oscommerce.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 301161 Jun 19 06:20 rockyou-30000.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root   1563 Jun 19 06:20 specific.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root  64068 Jun 19 06:20 T0XlC-insert_00-99_1950-2050_toprules_0_F.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root   2027 Jun 19 06:20 T0XlC-insert_space_and_special_0_F.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root  34437 Jun 19 06:20 T0XlC-insert_top_100_passwords_1_G.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root  34813 Jun 19 06:20 T0XlC.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root 104203 Jun 19 06:20 T0XlCv1.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root     45 Jun 19 06:20 toggles1.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root    570 Jun 19 06:20 toggles2.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root   3755 Jun 19 06:20 toggles3.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root  16040 Jun 19 06:20 toggles4.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root  49073 Jun 19 06:20 toggles5.rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r-- 1 root root  55346 Jun 19 06:20 unix-ninja-leetspeak.rule</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Also, Hashcat provides an option to generate random rules on the fly and apply them to the input wordlists. The following command will generate 1000 random rules and apply them to each word from <code>rockyou.txt</code> by specifying the <code>-g</code> flag. There&#x27;s no certainty to the success rate of this attack:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 100 -g 1000 hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cracking">Cracking<a href="#cracking" class="hash-link" aria-label="Direct link to Cracking" title="Direct link to Cracking">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cracking-common-hashes">Cracking common hashes<a href="#cracking-common-hashes" class="hash-link" aria-label="Direct link to Cracking common hashes" title="Direct link to Cracking common hashes">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="common-hash-types">Common hash types<a href="#common-hash-types" class="hash-link" aria-label="Direct link to Common hash types" title="Direct link to Common hash types">​</a></h4>
<p>Some hash types are extremely common to find. Hashcat team maintains a list of <a href="https://hashcat.net/wiki/doku.php?id=example_hashes" target="_blank" rel="noopener noreferrer">example hashes</a>. Here are the most commonly seen hash types:</p>
<table><thead><tr><th>Hashmode</th><th>Hash Name</th><th>Example Hash</th><th>Output</th></tr></thead><tbody><tr><td>0</td><td>MD5</td><td>8743b52063cd84097a65d1633f5c74f5</td><td>inlanefreight2020</td></tr><tr><td>100</td><td>SHA1</td><td>b89eaac7e61417341b710b727768294d0e6a277b</td><td>INLANEFREIGHT2020</td></tr><tr><td>1000</td><td>NTLM</td><td>b4b9b02e6f09a9bd760f388b67351e2b</td><td>Inlanefreight2020 / iNLANEFREIGHT2020</td></tr><tr><td>1800</td><td>sha512crypt <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">6</span></span></span></span>, SHA512 (Unix)</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">6</span></span></span></span>52450745$k5ka2p8bFuSmoVT1tzOyyuaREkkKBcCNqoDKzYiJL9RaE8yMnPgh2XzzF0NDrUhgrcLwg78xs1w5pJiypEdFX/</td><td>iNLANEfREIGHT2020</td></tr><tr><td>3200</td><td>bcrypt <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>∗</mo></mrow><annotation encoding="application/x-tex">2*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span><span class="mord">∗</span></span></span></span>, Blowfish (Unix)</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>a</mi></mrow><annotation encoding="application/x-tex">2a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">2</span><span class="mord mathnormal">a</span></span></span></span>05$LhayLxezLhK1LhWvKxCyLOj0j1u.Kj0jZ0pEmm134uzrQlFvQJLF6</td><td>InlaneFreight2020InlaneFreight2020 / IInnllaanneeFFrreeiigghhtt22002200 / IInlaneFreight2020 / InlaneFreight20200</td></tr><tr><td>5500</td><td>NetNTLMv1 / NetNTLMv1+ESS</td><td>u4-netntlm::kNS:338d08f8e26de93300000000000000000000000000000000:9526fb8c23a90751cdd619b6cea564742e1e4bf33006ba41<!-- -->:cb8086049ec4736c</td><td>nlaneFreight2020I / 0InlaneFreight202</td></tr><tr><td>5600</td><td>NetNTLMv2</td><td>admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030</td><td>!InlaneFreight2020 / InlaneFreight2020!</td></tr><tr><td>13100</td><td>Kerberos 5 TGS-REP etype 23</td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>r</mi><mi>b</mi><mn>5</mn><mi>t</mi><mi>g</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">krb5tgs</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">b</span><span class="mord">5</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">s</span></span></span></span>23<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>s</mi><mi>e</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">user</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.02778em">ser</span></span></span></span>realm<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi mathvariant="normal">/</mi><mi>s</mi><mi>p</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">test/spn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">es</span><span class="mord mathnormal">t</span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">n</span></span></span></span>63386d22d359fe42230300d56852c9eb$ &lt; SNIP &gt;</td><td>0202thgierFenalnI</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-database-dumps">Example 1: Database dumps<a href="#example-1-database-dumps" class="hash-link" aria-label="Direct link to Example 1: Database dumps" title="Direct link to Example 1: Database dumps">​</a></h4>
<p>MD5, SHA1, and bcrypt hashes are often seen in database dumps. These hashes may be retrieved following a successful SQLi attack or found in publicly available password data from breach database dumps.</p>
<p>Consider the following SHA1 hahes list:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">winter!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baseball1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">waterslide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">summertime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baconandeggs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">beach1234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sunshine1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">welcome1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password123</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Create the SHA1 hash of each word:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ for i in $(cat words); do echo -n $i | sha1sum | tr -d &#x27; -&#x27;;done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fa3c9ecfc251824df74026b4f40e4b373fd4fc46</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e6852777c0260493de41fb43918ab07bbb3a659c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0c3feaa16f73493f998970e22b2a02cb9b546768</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b863c49eada14e3a8816220a7ab7054c28693664</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b0feedd70a346f7f75086026169825996d7196f9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f47f832cba913ec305b07958b41babe2e0ad0437</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">08b314f0e1e2c41ec92c3735910658e5a82c6ba7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e35bece6c5e6e0e86ca51d0440e92282a9d6ac8a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cbfdac6008f9cab4083784cbd1874f76618d2a97</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then run a Hashcat dictionary attack using the <code>rockyou.txt</code> wordlist:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -m 100 SHA1_hashes /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Variations on the abovel ist, such as <code>Bas3b@ll1</code> or <code>Wat3rSl1de</code> would likely take longer to crack and may require additional techniques such as mask and hybrid attacks.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-linux-shadow-file">Example 2: Linux shadow file<a href="#example-2-linux-shadow-file" class="hash-link" aria-label="Direct link to Example 2: Linux shadow file" title="Direct link to Example 2: Linux shadow file">​</a></h4>
<p><em>Sha512crypt</em> hashes are commonly found in the <code>/etc/shadow</code> file on Linux systems, which contains the password hashes for all accounts with a login shell assigned to them.</p>
<p>Let&#x27;s look at a hash from a standard Ubuntu installation corresponding to <code>password123</code>.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root:$6$tOA0cyybhb/Hr7DN$htr2vffCWiPGnyFOicJiXJVMbk1muPORR.eRGYfBYUnNPUjWABGPFiphjIjJC5xPfFUASIbVKDAHS3vTW1qU.1:18285:0:99999:7:::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The hash contains <strong>nine fields separated by colons</strong>. The first two fields contain the username and its encrypted hash. The rest fields contain various attributes such as password creation time, last change time, and expiry.</p>
<p>Coming to the hash, we know it contains three fields delimited by <code>$</code>. The value <code>6</code> stands for the <code>SHA-512</code> hashing algorithm, the next 16 characters represent the salt, while the rest of it is the actual hash.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -m 1800 nix_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-common-active-directory-hash-types">Example 3: Common active directory hash types<a href="#example-3-common-active-directory-hash-types" class="hash-link" aria-label="Direct link to Example 3: Common active directory hash types" title="Direct link to Example 3: Common active directory hash types">​</a></h4>
<p>In organizations using Active Directory, it&#x27;s often possible to obtain credentials in cleartext or re-use password hashes to further access via <em>Pass-the-Hash</em> or <em>SMB Relay attacks</em>. Still, some techniques will reslt in a password hash that must be creacked offline to further our access.</p>
<p>Some examples include a NetNTLMv1 or NetNTLMv2 ovtained through a MITM attack, a Kerberos 5 TGS-REP hash obtained through a Kerberoasting attack, or an NTLM hash obtained either by dumping credentials from memory using <em>Mimikatz</em> tool or obtained from a Windows machine&#x27;s local SAM database.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ntlm">NTLM<a href="#ntlm" class="hash-link" aria-label="Direct link to NTLM" title="Direct link to NTLM">​</a></h4>
<p>Retrieve an NTLM password hash from a user that has <em>Remote Desktop</em> (<em>RDP</em>) access to a server but is not a local administrator, so the NTLM hash cannot be used for a pass-the-hash attack. In this case, the cleartext password is necessary to further our access by connecting to the server via RDP and performing further enumeration within the network or looking for local privilege escalation vectors.</p>
<p>For example, quickly generate an NTLM hash of <code>Password01</code>:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ python3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Python 3.8.3 (default, May 14 2020, 11:03:12) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[GCC 9.3.0] on linux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; import hashlib,binascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; hash = hashlib.new(&#x27;md4&#x27;, &quot;Password01&quot;.encode(&#x27;utf-16le&#x27;)).digest()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; print (binascii.hexlify(hash))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b&#x27;7100a909c7ff05b266af3c42ec058c33&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then run the resultant NTLM password through Hashcat using the standard <code>rockyou.txt</code> wordlist:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 1000 ntlm_example /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="netntlmv2">NetNTLMv2<a href="#netntlmv2" class="hash-link" aria-label="Direct link to NetNTLMv2" title="Direct link to NetNTLMv2">​</a></h4>
<p>In busy corporate networks it is common to retrieve many NetNTLMv2 password hashes using MITM attacks with tools like <em>Responder</em>. These can often be cracked and leveraged to establish a foothold in the AD environment. Consider the following password hash: <code>sqladmin::INLANEFREIGHT:f54d6f198a7a47d4:7FECABAE13101DAAA20F1B09F7F7A4EA:0101000000000000C0653150DE09D20126F3F71DF13C1FD8000000000200080053004D004200330001001E00570049004E002D00500052004800340039003200520051004100460056000400140053004D00420033002E006C006F00630061006C0003003400570049004E002D00500052004800340039003200520051004100460056002E0053004D00420033002E006C006F00630061006C000500140053004D00420033002E006C006F00630061006C0007000800C0653150DE09D201060004000200000008003000300000000000000000000000003000001A67637962F2B7BF297745E6074934196D5F4371B6BA3E796F2997306FD4C1C00A001000000000000000000000000000000000000900280063006900660073002F003100390032002E003100360038002E003100390035002E00310037003000000000000000000000000000</code>.</p>
<p>Some tools, such as <em>Responder</em>, will inform you what type of hash was received. A NetNTLMv2 hash relates to the mode <code>5600</code> in Hashcat.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 5600 inlanefreight_ntlmv2 /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cracking-miscellaneous-files--hashes">Cracking miscellaneous files &amp; hashes<a href="#cracking-miscellaneous-files--hashes" class="hash-link" aria-label="Direct link to Cracking miscellaneous files &amp; hashes" title="Direct link to Cracking miscellaneous files &amp; hashes">​</a></h3>
<p>It&#x27;s common to encounter password-protected documents such as Microsoft Word and Excel documents, OneNote notebooks, KeePass database files, SSH private key passphrases, PDF files, zip files, and more.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Various tools exist to help us extract the password hashes from these files in a format that Hashcat can understand. For example, <code>JohnTheRipper</code> comes with <a href="https://github.com/openwall/john/tree/bleeding-jumbo/src" target="_blank" rel="noopener noreferrer">many of these tools</a>. One additional tool ported to Python is <a href="https://gist.github.com/HarmJ0y/116fa1b559372804877e604d7d367bbc#file-keepass2john-py" target="_blank" rel="noopener noreferrer">keeypass2jhon.py</a> for extracting a crackable hash from KeePass 1.x/2.x databases.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-microsoft-office-documents">Example 1: Microsoft Office documents<a href="#example-1-microsoft-office-documents" class="hash-link" aria-label="Direct link to Example 1: Microsoft Office documents" title="Direct link to Example 1: Microsoft Office documents">​</a></h4>
<p>Using the <a href="https://raw.githubusercontent.com/magnumripper/JohnTheRipper/bleeding-jumbo/run/office2john.py" target="_blank" rel="noopener noreferrer">office2john.py</a> tool, you can extract password hashes from some Microsoft Office documents.</p>
<p>Hashcat supports the following hash modes for Microsoft Office documents:</p>
<ul>
<li>9400: MS Office 2007</li>
<li>9500: MS Office 2010</li>
<li>9600: MS Office 2013</li>
</ul>
<p>There are also several <code>$oldoffice$</code> hash modes for MS Office documents older than 2003.</p>
<p>Let&#x27;s take a Word document protected with the password <code>pa55word</code>. We can first extrack the hash:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ python office2john.py hashcat_Word_example.docx </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hashcat_Word_example.docx:$office$*2013*100000*256*16*6e059661c3ed733f5730eaabb41da13a*aa38e007ee01c07e4fe95495934cf68f*2f1e2e9bf1f0b320172cd667e02ad6be1718585b6594691907b58191a6</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then, run the hash through Hashcat using mode <code>9600</code> and make short work of it with the <code>rockyou.txt</code> wordlist.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>This is a rather slow hash to crack and will take over 12 hours on a single CPU.</p></div></div>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -m 9600 office_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-zip-files">Example 2: ZIP files<a href="#example-2-zip-files" class="hash-link" aria-label="Direct link to Example 2: ZIP files" title="Direct link to Example 2: ZIP files">​</a></h4>
<p>We can extract the password hashes using <a href="https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/src/zip2john.c" target="_blank" rel="noopener noreferrer">zip2john</a>.</p>
<p>Hashcat supports a variety of compressed file formats such as:</p>
<ul>
<li>11600: 7-Zip</li>
<li>13600: WinZip</li>
<li>17200: PKZIP (Compressed)</li>
<li>17210: PKZIP (Uncompressed)</li>
<li>17220: PKZIP (Compressed Multi-File)</li>
<li>17225: PKZIP (Mixed Multi-File)</li>
<li>17230: PKZIP (Compressed Multi-File Checksum-Only)</li>
<li>23001: SecureZIP AES-128</li>
<li>23002: SecureZIP AES-192</li>
<li>23003: SecureZIP AES-256</li>
</ul>
<p>For our example, take any documment and add it to a password protected file:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ zip --password zippyzippy blueprints.zip dummy.pdf </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adding: dummy.pdf (deflated 7%)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then extract the hash:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">zip2john ~/Desktop/HTB/Academy/Cracking\ with\ Hashcat/blueprints.zip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To run this through Hashcat, we need the entire hash starting from <code>$pkzip2$1</code> and ending with <code>/pkzip2$</code>. Then, crack it:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 17200 pdf_hash_to_crack /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-keepass-files">Example 3: KeePass files<a href="#example-3-keepass-files" class="hash-link" aria-label="Direct link to Example 3: KeePass files" title="Direct link to Example 3: KeePass files">​</a></h4>
<p>We can extract the password hashes using <a href="https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/src/keepass2john.c" target="_blank" rel="noopener noreferrer">keepass2john</a>.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python keepass2john.py Master.kdbx </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Hashcat supportsthe following hash types for KeePass databases, all designated by the same hash mode:</p>
<ul>
<li>13400: KeePass 1 AES / without keyfile</li>
<li>13400: KeePass 2 AES / without keyfile</li>
<li>13400: KeePass 1 Twofish / with keyfile</li>
<li>13400: Keepass 2 AES / with keyfile</li>
</ul>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 13400 keepass_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-4-pdf-files">Example 4: PDF files<a href="#example-4-pdf-files" class="hash-link" aria-label="Direct link to Example 4: PDF files" title="Direct link to Example 4: PDF files">​</a></h4>
<p>We can extract the password hashes using <a href="https://raw.githubusercontent.com/truongkma/ctf-tools/master/John/run/pdf2john.py" target="_blank" rel="noopener noreferrer">pdf2john</a>.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python pdf2john.py inventory.pdf | awk -F&quot;:&quot; &#x27;{ print $2}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Hashcat supports a variety of PDF file formats:</p>
<ul>
<li>10400: PDF 1.1 - 1.3 (Acrobat 2 - 4)</li>
<li>10410: PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #1</li>
<li>10420: PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #2</li>
<li>10500: PDF 1.4 - 1.6 (Acrobat 5 - 8)</li>
<li>10600: PDF 1.7 Level 3 (Acrobat 9)</li>
<li>10700: PDF 1.7 Level 8 (Acrobat 10 - 11)</li>
</ul>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 10500 pdf_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cracking-wpawpa2-handshakes">Cracking WPA/WPA2 handshakes<a href="#cracking-wpawpa2-handshakes" class="hash-link" aria-label="Direct link to Cracking WPA/WPA2 handshakes" title="Direct link to Cracking WPA/WPA2 handshakes">​</a></h3>
<p>Wireless networks are often not properly segmented from a company&#x27;s corporate network, and successful authentication to it may grant full access to the internal corporate network.</p>
<p>Hashcat can be used to successfully crack both the <code>MIC</code> (4-way handshake) and <code>PMKID</code> (1st packet/handshake).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cracking-mic">Cracking MIC<a href="#cracking-mic" class="hash-link" aria-label="Direct link to Cracking MIC" title="Direct link to Cracking MIC">​</a></h4>
<p>When a client connecting to the wireless network and the wireless access point (AP) communicate, the must ensure that they both have/know the wireless network key but are not transmitting the key across the network (it&#x27;s encrypted and verified by the AP).</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The handshake is a collection of keys exchanged during the authenticaton process between the client and the associated AP. These keys are used to generate a common key called the <em>Message Integrity Check (MIC)</em> used by an AP to verify that each packet has not been compromised and received in its original state.</p></div></div>
<p>To perform this type of offline cracking attack, we need to capture a valid 4-way handshake by sending de-authentication frames to force a client (user) to disconnect from an AP. When the client reauthenticates (usually automatically), the attacker can attempt to sniff out the WPA 4-way handshake without their knowledge.</p>
<p><img loading="lazy" alt="4-way handshake" src="/cybersecurity-handbook/assets/images/image-37ea889043a78c6f676ce5d50aee8953.png" width="2576" height="2076" class="img_ev3q"></p>
<p>Once we captured a 4-way handshake (with a tool such as <code>airodump-ng</code>), convert it to a format that can be supplied to Hashcat for cracking (i.e., <code>.cap</code> to <code>.hccapx</code>). Hashcat hosts an online service: <a href="https://hashcat.net/cap2hashcat" target="_blank" rel="noopener noreferrer">cap2hashcat online</a> or you can use <code>hashcat-utils</code> repo offline.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./cap2hccapx.bin corp_capture1-01.cap mic_to_crack.hccapx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, we can perform a straight dictionary attack to crack the WPA handshake with mode <code>22000</code>:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 22000 mic_to_crack.hccapx /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Armed with the cracked hey, we can now attempt to authenticate to the wireless network.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cracking-pmkid">Cracking PMKID<a href="#cracking-pmkid" class="hash-link" aria-label="Direct link to Cracking PMKID" title="Direct link to Cracking PMKID">​</a></h4>
<p>This attack can be performed against wireless networks that use WPA/WPA2-PSK (pre-shared key) and allows us to obtain the PSK being used by the targeted wireless network by attacking the AP directly (i.e., it doesn&#x27;t require deauthentication of any users).</p>
<p>The PMK is the same as in the MIC (4-way handshake) attack but can generally be obtained faster and without interrupting any users.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The <em>Pairwise Master Key Identifier (PMKID)</em> is the AP&#x27;s unique identifier to keep track of the <em>Pairwise Master Key (PMK)</em> used by the client. The PMKID is located in the 1st pakcet of the 4-way handshake and can be easier to obtain since it does not require capturing the entire 4-way handshake. PMKID is calculated with <strong>HMAC-SHA1</strong> with the PMK (Wirless network password) used as a key, the string &quot;PMK Name&quot;, MAC address of the AP, and the MAC address of the station.</p></div></div>
<p><img loading="lazy" alt="PMKID calculation" src="/cybersecurity-handbook/assets/images/image-1-148879b9417f3c6c7bf667a69b70edfa.png" width="2576" height="1886" class="img_ev3q"></p>
<p>To perform PMKID dracking, we need to obtain the PMKID hash. The first step is extracting it from the capture file (<code>.cap</code>) using a tool such as <code>hcxpcaptool</code> from <code>hcxtools</code>. You can install it using apt <code>sudo apt install hcxtools</code>.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This tool has since been replaced by <code>hcxpcapngtool</code> which we can compile and install from <a href="https://github.com/ZerBea/hcxtools" target="_blank" rel="noopener noreferrer">hcxtools repo</a>.</p></div></div>
<p>For example, extract PMKID using hcxpcaptool:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ hcxpcaptool -z pmkidhash_corp cracking_pmkid.cap </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;SNIP...&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 PMKID(s) written to pmkidhash_corp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Alternatively, use <code>hcxpcapngtool</code>:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ hcxpcapngtool cracking_pmkid.cap -o pmkidhash_corp2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;SNIP...&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PMKID written to combi hash file.........: 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now, we can try a straight dictionary attack with mode <code>22000</code>:</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -a 0 -m 22000 pmkidhash_corp /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cybersecurity-handbook/cryptography/attacks/padding-oracle/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Padding oracle</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cybersecurity-handbook/cryptography/attacks/stream-cipher-reuse/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Stream cipher reuse / Reused key</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a><ul><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#hashing" class="table-of-contents__link toc-highlight">Hashing</a></li><li><a href="#encryption" class="table-of-contents__link toc-highlight">Encryption</a></li><li><a href="#identifing-hashes" class="table-of-contents__link toc-highlight">Identifing hashes</a></li></ul></li><li><a href="#hashcat-specifics" class="table-of-contents__link toc-highlight">Hashcat specifics</a><ul><li><a href="#hashcat-overview" class="table-of-contents__link toc-highlight">Hashcat overview</a></li><li><a href="#dictionary-attack" class="table-of-contents__link toc-highlight">Dictionary attack</a></li><li><a href="#combination-attack" class="table-of-contents__link toc-highlight">Combination attack</a></li><li><a href="#mask-attack" class="table-of-contents__link toc-highlight">Mask attack</a></li><li><a href="#hybrid-attack" class="table-of-contents__link toc-highlight">Hybrid attack</a></li></ul></li><li><a href="#creating-custom-wordlists" class="table-of-contents__link toc-highlight">Creating custom wordlists</a></li><li><a href="#working-with-rules" class="table-of-contents__link toc-highlight">Working with rules</a><ul><li><a href="#example-rule-creation" class="table-of-contents__link toc-highlight">Example rule creation</a></li><li><a href="#example-rule-based-attack" class="table-of-contents__link toc-highlight">Example rule-based attack</a></li><li><a href="#built-in-defaults" class="table-of-contents__link toc-highlight">Built-in defaults</a></li></ul></li><li><a href="#cracking" class="table-of-contents__link toc-highlight">Cracking</a><ul><li><a href="#cracking-common-hashes" class="table-of-contents__link toc-highlight">Cracking common hashes</a></li><li><a href="#cracking-miscellaneous-files--hashes" class="table-of-contents__link toc-highlight">Cracking miscellaneous files &amp; hashes</a></li><li><a href="#cracking-wpawpa2-handshakes" class="table-of-contents__link toc-highlight">Cracking WPA/WPA2 handshakes</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>